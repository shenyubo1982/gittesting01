_.Module.define({path:"ppb/widget/pic_act_poster",requires:["pcommon/component/force_login","pcommon/widget/PostService","pcommon/widget/image_uploader_manager"],sub:{ORIGINAL_PIC_URL_PREFIX:"http://imgsrc.baidu.com/forum/pic/item/",THUMBNAIL_PIC_URL_PREFIX:"http://imgsrc.baidu.com/forum/abpic/item/",initial:function(t){this.option=t,this.actDesc=t.act_desc,this.activityId=t.activity_id,this.threadId=t.thread_id,this.threadTitle=t.thread_title,this._showPostDialog()},_showPostDialog:function(){var t=this,e=['<div class="pic_join_dialog">','<p class="pic_act_rule">\u89C4\u5219\uFF1A',"<span>"+t.actDesc+"</span>","</p>",'<p class="img_bad_tip">\u6CE8\uFF1A\u4E3A\u4FDD\u8BC1\u6548\u679C\uFF0C\u8BF7\u4E0A\u4F20\u5927\u4E8E200&times;200\u7684\u56FE\u7247</p>','<div class="pic_act_photo">','<div class="pic_prev_wrapper">','<div class="pic_act_upload_btn act_red_btn">\u4E0A\u4F20\u56FE\u7247','<div class="photo_up_container"></div>',"</div>",'<img src="/tb/static-common/editor_img/layer/i.gif" class="pic_previewer ele_hidden" />',"</div>",'<textarea cols="30" rows="10" class="ui_textfield pic_act_img_desc" maxlength="140" placeholder="\u8BF7\u8F93\u5165\u56FE\u7247\u63CF\u8FF0\uFF08\u9009\u586B\uFF09,140\u5B57\u4EE5\u5185"></textarea>',"</div>",'<div class="post_btn_group">','<a href="#" id="pic_act_post_btn" class="ui_btn_disable ui_btn_m_disable"><span><em>\u786E\u8BA4</em></span></a>','<a href="#" id="pic_act_cancel_btn" class="ui_btn ui_btn_sub_m"><span><em>\u53D6\u6D88</em></span></a>',"</div>","</div>"].join("");if(t.dialog=new $.dialog({html:e,title:"\u6652\u56FE\u53C2\u52A0\u6D3B\u52A8",width:428,draggable:!0,closeable:!0,show:!1}),$.browser.msie&&_.Module.use("pcommon/component/Placeholder",[t.dialog.element.find(".pic_act_img_desc"),"\u8BF7\u8F93\u5165\u56FE\u7247\u63CF\u8FF0\uFF08\u9009\u586B\uFF09,140\u5B57\u4EE5\u5185"]),!PageData.user.is_login){var i=$.tb.unescapeHTML($.tb.location.getHref());return t.use("pcommon/component/force_login",i,"userbar","dialog","pic_act_poster"),!1}PageData.user.is_like?(t.dialog.show(),t._uploadImg(t.dialog.element.find(".pic_prev_wrapper")),t.dialog.element.on("click","#pic_act_post_btn",function(e){return e.preventDefault(),$(this).hasClass("ui_btn_disable")?!1:void t._postPhoto()}).on("click","#pic_act_cancel_btn",function(e){e.preventDefault(),t.dialog.close()})):t._doLike()},_doLike:function(){var t=new $.dialog({html:'<p>\u53C2\u4E0E\u6652\u56FE\u9700\u8981\u5148\u5173\u6CE8\u672C\u5427\u54E6~</p><br><a href="#" class="ui_btn ui_btn_m j_like"><span><em>\u5173\u6CE8\u672C\u5427</em></span></a>',width:420,holderClassName:"dialog_tip_holder"});t.element.on("click",".j_like",function(e){e.preventDefault(),_.Module.use("puser/widget/myTieba",[{}],function(t){t.dolike()}),$.stats.track("spic","plat_like","pb","click",{obj_id:self.activityId}),t.close()})},_uploadImg:function(t){var e=this,i=$(new Image),a=t.find(".photo_up_container"),o=t.find(".pic_previewer"),c=t.find(".pic_act_upload_btn"),n=$("#pic_act_post_btn"),s=e.use("pcommon/widget/image_uploader_manager",{container:a,width:a.width(),height:a.height(),isFlash:!1,isAutoUp:!1});s.bind("onFileSelected",function(){s.startUpload()}),s.bind("onStartUpload",function(){c.css("top","-9999px"),o.show(),o.tbattr("src","http://tb2.bdstatic.com/tb/static-ppb/img/pic_act/pic_loading_996b0ab.gif")}),s.bind("onComplete",function(t,a){var s=a.imageList[a.imageList.length-1].response;if(null!=s&&0==s.error_code){var _=s.info,l=_.pic_id_encode,d=_.fullpic_width,p=_.fullpic_height,r=e.THUMBNAIL_PIC_URL_PREFIX+l+".jpg",u=e.ORIGINAL_PIC_URL_PREFIX+l+".jpg";if(200>d||200>p)$(".img_bad_tip").css("color","red"),c.css("top","38px"),o.hide();else{var m=new Image;m.src=r,m.onload=function(){o.tbattr("src","http://tb1.bdstatic.com/tb/static-common/editor_img/layer/i.gif"),o.css("background-image","url("+r+")"),(m.width<110||m.height<100)&&o.css("background-size","auto")},$(".img_bad_tip").css("color","#666"),c.css("top","-9999px"),o.show(),n.removeClass("ui_btn_disable ui_btn_m_disable").addClass("ui_btn ui_btn_m"),i.addClass("BDE_Image"),i.tbattr({width:d>560?560:d,height:d>560?parseInt(560*p/d):p,src:u,unselectable:"on",pic_type:0}),e.orgImg=i.get(0).outerHTML,e.pic_encode=l}}else c.css("top","38px"),o.hide(),e._uploadErrorHandler()})},_uploadErrorHandler:function(){$.dialog.alert("\u54E6\uFF0C\u7C97\u4E86\u70B9\u95EE\u9898\uFF0C\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\u4E86",{title:"\u5931\u8D25\u63D0\u793A",acceptValue:"\u518D\u8BD5\u4E00\u6B21",holderClassName:"alert_holder",onaccept:function(){return!0}})},_postPhoto:function(){var t=this,e="",i=PosterContext.getContext(),a=t.use("pcommon/widget/PostService");return $(this).hasClass("ui_btn_disable")?!1:(a.success(function(e,i){var a={activity_id:t.activityId,post_id:i.data.post_id,thread_id:t.threadId,user_name:PageData.user.user_name,pic_encode:t.pic_encode,thread_title:t.threadTitle,canva_from:"poster"};t.dialog.close(),t._showCanvaDialog(a)}),e=t.dialog.element.find(".pic_act_img_desc").val(),void a.post("reply",{tid:t.threadId,content:$.tb.escapeHTML(UE.utils.html2ubb(e,!0))+UE.utils.html2ubb("<br>"+t.orgImg),ptype:4},i))},_showCanvaDialog:function(t){var e=this,i=['<div id="poster_canva_dialog" class="canva_dlg_wrap">','<h3 class="canva_msg_title">\u53D1\u8868\u6210\u529F</h3>','<p class="canva_msg_cnt">\u8F6C\u53D1\u5230\u4F60\u5E38\u53BB\u7684\u5427\u62C9\u7968\uFF0C\u8BA9\u5C0F\u4F19\u4F34\u4EEC\u52A9\u4F60\u83B7\u5956\u5427~</p>','<div class="canva_btn_group">','<a href="#" id="canva_repost_btn" '+$.tb.dataField(t)+' class="ui_btn ui_btn_m j_pic_act_repost"><span><em>\u8F6C\u53D1\u62C9\u7968</em></span></a>','<a href="#" id="canva_cancel_btn" class="ui_btn ui_btn_sub_m"><span><em>\u4E0B\u6B21\u518D\u8BF4</em></span></a>',"</div>","</div>"].join(""),a=new $.dialog({html:i,width:380,draggable:!0,closeable:!0,noTitle:!0});a.bind("onclose",function(){"pb"==PageData.product?setTimeout(function(){var t=$.tb.location.getHash(),i=$.tb.location.getPathname();i=="/p/"+e.threadId?"#pic_sort_new"!=t?($.tb.location.setHref("/p/"+e.threadId+"#pic_sort_new"),$.tb.location.reload()):$.tb.location.reload():$.tb.location.setHref("/p/"+e.threadId+"#pic_sort_new")},500):setTimeout(function(){$.tb.location.reload()},500)}),a.element.on("click","#canva_repost_btn",function(t){t.preventDefault(),a.hide()}).on("click","#canva_cancel_btn",function(t){t.preventDefault(),a.close()})}}});_.Module.define({path:"ppb/widget/Favthread",sub:{initial:function(){this.jdom=$("#j_favthread"),this.data=this.jdom.getData(),this.status=null,this.is_anonym=null,this.bub=null,this.tip_tid=null,this.is_menu_onshow=!1,this.init()},init:function(){this.status=this.data.status,this.is_anonym=this.data.is_anonym,0!=this.status?this.excute_cancel():this.excute_open()},_showMessageDilog:function(t,i,s){var e=this;e.message?e.message.showMessage(t,i,s):this.requireInstanceAsync("ppb/widget/Message",[],function(n){n.showMessage(t,i,s),e.message=n})},show_anonym_button:function(){var t=[],i="\u6536\u85CF";i=0==this.status?"\u6536\u85CF":"\u53D6\u6D88\u6536\u85CF",t.push("<div class='p_favthr_tip'></div>"),t.push("<div class='p_favthr_main_anonym'><p>"+i+"</p></div>"),this.jdom.html(t.join("")),this.bind_btn_event()},show_not_anonym_menu:function(){var t=[],i="\u5DF2\u6536\u85CF";0==this.status&&(i="\u6536\u85CF"),t.push("<div class='p_favthr_tip'></div>"),t.push("<div class='p_favthr_main'><p>"+i+"</p></div>"),t.push("<div class='p_favthr_listshadow'>&nbsp;</div>"),this.jdom.html(t.join("")),this.bind_menu_event()},showbystauts:function(){_html=this.is_anonym?this.show_anonym_button():this.show_not_anonym_menu()},cookie_draw:function(){$.cookie("favthread","1",{expires:30})},bind_btn_event:function(){var t=this;t.jdom.find("div.p_favthr_main_anonym").click(function(){$(this).addClass("p_favthr_main_active"),0==t.status?t.excute_open_kept():t.excute_cancel_kept(1)}),t.jdom.find("div.p_favthr_main_anonym").hover(function(){$(this).addClass("p_favthr_main_hover")},function(){$(this).removeClass("p_favthr_main_hover p_favthr_main_active")})},bind_menu_event:function(){var t=this;t.jdom.find("div.p_favthr_main").click(function(){return 0===PageData.user.is_login?void TbCom.process("User","buildLoginFrame",null,null,null,null):void(0==t.status?t.excute_open():t.excute_cancel())})},show_tip:function(t,i,s){var e=i?5400:2400;this.bub&&(this.bub.hide(),this.cookie_draw()),this.close_tip(s);var n=s||this.jdom.find("div.p_favthr_tip");n.width(i?410:270),s&&n.width(240),n.html(t),n.css("opacity","0").animate({opacity:1,height:"toggle"},600),this.tip_tid=setTimeout(function(){n.animate({opacity:0,height:"toggle"},600)},e)},close_tip:function(t){var i=this.tip_tid;i&&(clearTimeout(i),t?t.hide():$("div.p_favthr_tip").hide())},excute_open:function(t){var i=this,s={tbs:PageData.follow_sign,tid:PageData.thread.thread_id,type:0,datatype:"json",ie:"utf-8"};$.post("/i/submit/open_storethread",s,function(s){if(t instanceof Function&&t(s),s)if(0==s.error_no&&0==s.ret.type)i.status=1,i.showbystauts(),t||i.show_tip("<span>\u6536\u85CF\u6210\u529F\uFF0C\u8BF7\u4F7F\u7528\u201C</span><a target='_blank' href='http://c.tieba.baidu.com/c/s/download/pc?src=shoucang'>\u8D34\u5427\u624B\u673A\u5BA2\u6237\u7AEF</a><span>\u201D\u6216\u8005\u5230\u4E2A\u4EBA\u4E2D\u5FC3\u201C</span><a href='/home/collect?id="+PageData.user.portrait+"' target='_blank'>\u6211\u7684\u6536\u85CF</a><span>\u201D\u67E5\u770B</span>",!0);else{if(4==s.error_no)return void TbCom.process("User","buildLoginFrame",null,null,null,null);if(40==s.error_no)i._showMessageDilog('<div style="padding-bottom:10px;">\u4F60\u4ECA\u5929\u6536\u85CF\u7684\u8D34\u5B50\u592A\u591A\u4E86,\u8BF7\u54C1\u8BFB\u4E4B\u540E\u660E\u5929\u518D\u6765\u5427:)~ </div>',"\u64CD\u4F5C\u5931\u8D25",!1);else{if(9e3==s.error_no)return void TbCom.process("User","buildUnameFrame","\u6709\u7528\u6237\u540D\u624D\u80FD\u201C\u6536\u85CF\u201D\u8D34\u5B50\uFF0C\u8D76\u5FEB\u7ED9\u81EA\u5DF1\u8D77\u4E00\u4E2A\u5427~");if(1211057==s.error_no)return void i._showMessageDilog('<div style="width:180px;">\u6536\u85CF\u5931\u8D25,\u8BE6\u89C1<a href="/helpcenter/index#/index">\u4E2A\u4EBA\u4E2D\u5FC3</a>~</div>',"\u64CD\u4F5C\u5931\u8D25",!1)}}else console.log("error",s),i._showMessageDilog('<div style="width:180px;">\u670D\u52A1\u5668\u73B0\u5728\u5F88\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5 *_*</div>',"\u64CD\u4F5C\u5931\u8D25",!1)},"json")},excute_cancel:function(t){var i=this,s={tbs:PageData.follow_sign,tid:PageData.thread.thread_id,type:0,datatype:"json",ie:"utf-8"};$.post("/i/submit/cancel_storethread",s,function(s){if(t instanceof Function&&t(s),s)if(0==s.error_no&&0==s.ret.type)i.status=0,i.showbystauts(),t||i.show_tip("<span>\u53D6\u6D88\u6536\u85CF\u6210\u529F</span>",!1);else{if(4==s.error_no)return void TbCom.process("User","buildLoginFrame",null,null,null,null);40==s.error_no&&i._showMessageDilog('<div style="padding-bottom:10px;">\u4F60\u4ECA\u5929\u6536\u85CF\u7684\u8D34\u5B50\u592A\u591A\u4E86,\u8BF7\u54C1\u8BFB\u4E4B\u540E\u660E\u5929\u518D\u6765\u5427:)~ </div>',"\u64CD\u4F5C\u5931\u8D25",!1)}else i._showMessageDilog('<div style="width:180px;">\u670D\u52A1\u5668\u73B0\u5728\u5F88\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5 *_*</div>',"\u64CD\u4F5C\u5931\u8D25",!1)},"json")}}});_.Module.define({requires:["puser/widget/userApi"],path:"pcommon/widget/MemberApi",sub:{initial:function(){},getMemberNameClass:function(e,r){var i="";if(Env.server_time>13962816e5&&Env.server_time<1396368e6&&4!=r)return i=" vip_red ";var t=this.requireInstance("puser/widget/userApi",[]),n=$.getPageData("forum.forum_id",0),s={mParr_props:e};return t.checkSingleForumMembershipOf(s,n)&&(i=" vip_red "),e&&e.level&&e.level.end_time>Env.server_time/1e3&&(i=" vip_red "),i}}});function showattip(e){var t=$(e),r="@"==t.text()[0]?t.text().substring(1):t.text().substring(),n="/home/main?un="+encodeURIComponent(r)+"&fr=pb&ie=utf-8",a=t.tbattr("portrait")||"";a&&(n+="&id="+a),t.addClass("j_user_card").bindData({un:r,id:a}).tbattr("href",n).trigger("mouseenter"),e.onmouseover=null}function hideattip(e){e.onmouseout=null}_.Module.define({path:"puser/widget/pbUserBase",requires:["pcommon/widget/Card","pcommon/widget/UserHead","pcommon/widget/MemberApi","puser/widget/icons"],sub:{initial:function(){this._userHead=this.getInstance("pcommon/widget/UserHead"),this._memberApi=this.getInstance("pcommon/widget/MemberApi"),this._icons=this.getInstance("puser/widget/icons")},face_link:function(e){var t="",r="/home/main?un="+encodeURIComponent(e.user_name)+"&id="+(e.portrait||"")+"&ie=utf-8&fr=pb",n='src="'+this._userHead.getHeadUrl(e)+'"',a="<img "+n+"/>";return t="<a data-field=\"{'un':'"+e.user_name+"', 'id':'"+e.portrait+'\'}" target="_blank" class="j_user_card lzl_p_p" href="'+r+'" username="'+e.user_name+'">'+a+"</a>"},name_link:function(e){var t=$.tb.transforEmoji(e.user_name,e.nickname,!0);return'<a class="at j_user_card '+this._memberApi.getMemberNameClass(e.mParr_props)+"\" data-field=\"{'un':'"+e.user_name+"', 'id':'"+e.portrait+'\'}" alog-group="p_author" target="_blank" href="/home/main?un='+encodeURIComponent(e.user_name)+"&id="+(e.portrait||"")+'&ie=utf-8&fr=pb" username="'+e.user_name+'">'+t+"</a>"}}});_.Module.define({path:"ppb/widget/picActToolbar",requires:[],sub:{initial:function(){this.bindEvents()},bindEvents:function(){}}});_.Module.define({path:"ppb/widget/ForumTitle",requires:["ppb/widget/pic_act_poster","ppb/widget/Favthread"],sub:{initial:function(t){this.dataObj=t,this._favLoaded=!1,this.bindEvents()},bindEvents:function(){var t=this;if(!Page.checkLoadedModules("ForumTitle")){var e=$("#j_core_title_wrap");e.delegate("#lzonly_cntn","click",function(){if(!PageData.user.is_login){var t="http://tieba.baidu.com"+$.tb.unescapeHTML($(this).tbattr("href"));return _.Module.use("pcommon/widget/LoginDialog",[t,"userbar"]),!1}}).delegate(".p_favthread","click",function(){this._favLoaded||t.requireInstanceAsync("ppb/widget/Favthread",[],function(){this._favLoaded=!0})}),this.j_core_title_wrap=e,this.j_p_postlist=$("#j_p_postlist"),this.j_thread_pager=$("#thread_theme_5"),this.addScrollListener(),t.dataObj.is_pic_act_underway&&t.j_core_title_wrap.delegate(".pic_act_join_btn","click",function(e){e.preventDefault(),t.use("ppb/widget/pic_act_poster",$(this).getData())})}},updateLimitTop:function(){var t=this,e=$(".left_section"),i=$(".right_section"),o=e.height()>i.height()?e.height():i.height(),_=$("#pb_content"),a=(t.j_core_title_wrap.offset().top+10,_.offset().top+o-t.j_core_title_wrap.height());this.follwer.maxTop=a},addScrollListener:function(){var t=this,e=$(".left_section"),i=$("#pb_content"),o=$(".right_section"),a=(t.j_core_title_wrap.height(),t.j_core_title_wrap.offset().top+10,i.offset().top,e.height()>o.height()?e.height():o.height()),r=i.find(".interviewZero"),s=0!==r.length,n=s?r.offset().top:0;_.Module.use("pcommon/component/Follower",{ctn:t.j_core_title_wrap,getLimitTop:{minTop:n+t.j_core_title_wrap.parent().offset().top+10,maxTop:i.offset().top+a-t.j_core_title_wrap.height()},timer:30},function(e){t.follwer=e,e.bind("normal",function(){t.j_core_title_wrap.removeClass("core_title_absolute_bright").css({top:0}),t.j_thread_pager.removeClass("thread_theme_bright_absolute"),t.j_core_title_wrap.find(".pic_act_toolbar").removeClass("toolbar_fixed").hide()}),e.bind("fixed",function(){var e=$(".app_forum_top_nav"),i=0;e.length>0&&(i=47),t.j_core_title_wrap.addClass("core_title_absolute_bright").css({top:i}),t.j_thread_pager.addClass("thread_theme_bright_absolute"),t.j_core_title_wrap.find(".pic_act_toolbar").addClass("toolbar_fixed").show()})})}}});_.Module.define({path:"ppb/widget/saveFace",requires:[],sub:{url:"/tbmall/post/useSavefaceProps",opt:{tbs:0,props_id:"",thread_id:"",forum_id:"",target_user_id:"",target_user_name:""},curPost:null,ajaxing:!1,tmp:['<div class="save_face_dialog">','<div class="save_face_detail clearfix">#{save_cards}</div>','<div class="save_face_use">','<div class="save_face_split"></div>','<p class="save_face_tip"><span>\u8981\u4F7F\u7528\u8FD9\u5F20\u633D\u5C0A\u5361\u5417\uFF1F</span>','<a class="j_save_face_buy" target="_blank" href="/tbmall/propslist?category=117">>>\u7ACB\u5373\u8D2D\u4E70</a>',"</p>","<p>",'<a href="#" onclick="return false;" class="j_save_face ui_btn ui_btn_m">',"<span><em>\u786E\u5B9A</em></span>","</a>",'<a href="#" onclick="return false;" class="j_save_face_cancel ui_btn ui_btn_sub_m">',"<span><em>\u53D6\u6D88</em></span>","</a>","</p>","</div>","</div>"].join(""),initial:function(a){window.Page&&Page.checkLoadedModules("saveface")||(this.props=a.props,this.isLogin=a.isLogin,this.dialog=null,this.opt.forum_id=a.forumId,this.opt.thread_id=a.threadId,this.opt.tbs=PageData.tbs,this.bindEvents())},bindEvents:function(){var a=this;$(".save_face_card").live("click",function(){if(!a.isLogin)return _.Module.use("pcommon/widget/LoginDialog",[],function(){}),!1;var e=$(this).closest(".l_post").getData();a.opt.target_user_id=e.author.user_id,a.opt.target_user_name=e.author.user_name,a.curPost=$(this).closest(".save_face_bg"),a.initDialog()}),$("body").on("mouseenter",".save_card",function(){return $(this).closest(".save_face_detail").find(".save_card").removeClass("hover"),$(this).hasClass("sel")?!1:void $(this).addClass("hover")}).on("mouseleave",".save_face_detail",function(){$(this).find(".save_card").removeClass("hover")}).on("click",".save_card",function(){var e=!!$(this).getData("data-num"),s=$(".j_save_face_buy").removeClass("emph");return $(this).closest(".save_face_detail").find(".save_card").removeClass("sel").removeClass("unsel"),e?($(this).addClass("sel"),s.hide(),a.opt.props_id=$(this).getData("data-id")):($(this).addClass("unsel"),s.show(),a.opt.props_id=0),!1}).on("click",".j_save_face_cancel",function(){return a.dialog.close(),a.dialog=null,a.opt.props_id="",!1}).on("click",".j_save_face",function(){a.postHandle()}).on("click",".j_save_face_buy",function(){a.showBuyDialog(this.href)}).on("click",".j_save_face_buy_1",function(){a.showBuyDialog(this.href)})},initSaveCards:function(){for(var a=0,e={},s="",t=(this.props,['<div class="save_card" title="#{card_desc}" data-id="#{card_id}" data-num="#{card_num}">','<img src="#{card_img}"/>',"<p>x#{card_num}</p>","</div>"].join("")),i={},n=[{key:"1170001",img:"http://tb1.bdstatic.com/tb/cms/save_face/level_1.png",desc:"\u7834\u65E7\u7684\u633D\u5C0A\u5361(\u589E\u52A0\u7ECF\u9A8C\u503C-1~2)"},{key:"1170002",img:"http://tb1.bdstatic.com/tb/cms/save_face/level_2.png",desc:"\u666E\u901A\u7684\u633D\u5C0A\u5361(\u589E\u52A0\u7ECF\u9A8C\u503C0~3)"},{key:"1170003",img:"http://tb1.bdstatic.com/tb/cms/save_face/level_3.png",desc:"\u95EA\u5149\u7684\u633D\u5C0A\u5361(\u589E\u52A0\u7ECF\u9A8C\u503C2~5)"},{key:"1170004",img:"http://tb1.bdstatic.com/tb/cms/save_face/level_4.png",desc:"\u8000\u773C\u7684\u633D\u5C0A\u5361(\u589E\u52A0\u7ECF\u9A8C\u503C5~8)"},{key:"1170005",img:"http://tb1.bdstatic.com/tb/cms/save_face/level_5.png",desc:"\u795E\u5723\u7684\u633D\u5C0A\u5361(\u589E\u52A0\u7ECF\u9A8C\u503C10~15)"}];a<n.length;a++)e=n[a],i={card_id:e.key,card_img:e.img,card_desc:e.desc,card_num:this.getPropNum(e.key)},s+=$.tb.format(t,i);return s},getPropNum:function(a){var e=this.props;return e&&e[117]&&e[117][a]?e[117][a].left_num:0},initDialog:function(){var a=$.tb.format(this.tmp,{save_cards:this.initSaveCards()});this.dialog=new $.dialog({title:"\u4F7F\u7528\u633D\u5C0A\u5361",html:a,draggable:!1,width:640}),this.dialog.show()},postHandle:function(){var a=this;if(!a.ajaxing){if(0==a.opt.props_id)return void $(".j_save_face_buy").show().addClass("emph");a.ajaxing=!0,$.post(a.url,a.opt,function(e){a.ajaxing=!1,a.resHandle(e)})}},resHandle:function(a){var e=this;if(0==a.no){this.dialog.close();var s=setTimeout(function(){e.addScoreAni(a.data.exp),clearTimeout(s),s=null},200)}else{var t={210009:"\u4E0D\u80FD\u5BF9\u81EA\u5DF1\u4F7F\u7528\u633D\u5C0A\u5361\u54E6",2270026:"\u633D\u5C0A\u5361\u53EA\u80FD\u5BF9\u52CB\u7AE0\u7528\u6237\u4F7F\u7528",2190008:"4\u5C0F\u65F6\u5185\u53EA\u80FD\u5BF9\u540C\u4E00\u4E2A\u7528\u6237\u4F7F\u7528\u4E00\u6B21\u633D\u5C0A\u5361",2270019:'\u60A8\u7684\u633D\u5C0A\u5361\u4E0D\u591F\u4E86<a class="j_save_face_buy_1" target="_blank" href="/tbmall/propslist?category=117">>>\u7ACB\u5373\u8D2D\u4E70</a>',"else":"\u670D\u52A1\u5668\u6253\u4E86\u4E2A\u76F9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"},i=['<p class="save_face_alert">',a&&a.no in t?t[a.no]:t["else"],"</p>",'<p class="save_face_alert">','<a href="" onclick="return false;" class="j_save_face_cancel ui_btn ui_btn_m">',"<span><em>\u786E\u5B9A</em></span>","</a>","</p>"].join("");this.dialog.close(),this.dialog=new $.dialog({title:"\u63D0\u793A",html:i,draggable:!1}),this.dialog.show()}},addScoreAni:function(a){var e=['<div class="save_face_ani">','<span class="ani_1">@'+$.tb.subByte(this.opt.target_user_name,10)+"</span>",'<span class="ani_2">+'+parseInt(a)+"\u7ECF\u9A8C\u503C</span>","</div>"].join("");$(e).css({top:130,left:350}).insertAfter(this.curPost).animate({top:"-=70",left:"-=200",opacity:.2},1500,function(){$(this).remove(),$.tb.location.reload()})},showBuyDialog:function(a){var e='<p class="buy_txt">\u9053\u5177\u8D2D\u4E70\u6210\u529F\u540E\u5373\u53EF\u4F7F\u7528\uFF01</p><div class="buy_dialog_btns"><a href="#" class="ui_btn ui_btn_m btn_success"><span><em>\u8D2D\u4E70\u6210\u529F</em></span></a><a href="#{href}" target="_blank"  class="ui_btn ui_btn_sub_m btn_failure"><span><em>\u8D2D\u4E70\u5931\u8D25\uFF0C\u91CD\u65B0\u8D2D\u4E70</em></span></a></div>',s=new $.dialog({title:"\u63D0\u793A",html:$.tb.format(e,{href:$.tb.unescapeHTML(a)}),width:400,height:80});s.bind("onclose",function(){$.tb.location.reload()}),s.element.find(".btn_success").on("click",function(a){a.preventDefault(),$.tb.location.reload()})}}});_.Module.define({path:"padsense/widget/loader",requires:["pcommon/widget/messenger"],sub:{adStatus:{},initial:function(){this._initMessenger()},_getAdLocName:function(e){return[e.client_type,e.page_name,e.pos_name].join("_")},adDomMap:function(){var e={},t=function(t,a){e[t]=a},a=function(t){return e[t]||$("")};return{add:t,get:a}}(),loadAD:function(e,t,a){var n=e.adData||{},o=e.className||"",i=e.asyncHTML||"",r=(e.isProxy||!1,e.isAsync||!1),d=e.isIframe||!1,s=e.needStats||!1;$.extend(n,{className:o}),this._logger("media_send",n),"function"==typeof t&&(a=t,t={});var c=null;if(this._logger("draw_begin",n),r?(c=$(i),this._renderDOM(n,c)):c=$("."+o),d){var _=$.getPageData("goods_info.0.iframe_url","",n),u=this._getIframeParams(n,t);this._loadIframe(c,_,u),this.adDomMap.add(n.id,c)}else r&&c.show();"function"==typeof a&&a(c),s&&this._clickStats(c,n),this._logger("draw_done",n),this._viewStats(c,n)},_logger:function(e,t){var a=this,n=this._getStatsParams(t);a._track($.extend({},n,{locate:t.pos_name,da_locate:t.pos_name,type:e,da_type:e}))},_renderDOM:function(e,t){$(e.locator).length>0?$(e.locator)[e.load_type](t):this._track(e.id+"\uFF1A\u65E0\u5B9A\u4F4D\u5143\u7D20","\u5E7F\u544A\u52A0\u8F7D\u5931\u8D25")},_getStatsParams:function(e){var t="",a=$.getPageData,n={client_type:"pc_web",task:"tbda",page:a("product",t).toLowerCase(),fid:a("forum.forum_id",t),tid:a("thread.thread_id",t),uid:a("user.user_id",t),da_task:"tbda",da_fid:a("forum.forum_id",t),da_tid:a("thread.thread_id",t),da_uid:a("user.user_id",t),da_page:a("product",t),da_page_num:e.page_number,da_type_id:e.typeid,da_obj_id:e.id,da_good_id:e.goods_info[0].id,da_obj_name:e.name,da_first_name:e.first_name,da_second_name:e.second_name,da_cpid:e.cpid,da_abtest:e.abtest,da_price:e.price,da_verify:e.verify,da_plan_id:e.plan_id,da_ext_info:e.ext_info,da_client_type:e.client_type,da_throw_type:e.throw_type,da_loc_param:a("goods_info.0.loc_param",t,e),da_loc_index:e.loc_index};return n},_getIframeParams:function(e,t){var a,n,o,i="",r=$.getPageData,d={dapage:r("product",i).toUpperCase(),dafid:r("forum.forum_id",i),datid:r("thread.thread_id",i),dauid:r("user.user_id",i),datypeid:e.typeid,daid:e.id,dacssclass:e.className,dagoodid:e.goods_info[0].id,token:e.zhixin_token,daname:encodeURIComponent(e.name),dafirstname:encodeURIComponent(e.first_name),dasecondname:encodeURIComponent(e.second_name),dacpid:e.cpid,daabtest:e.abtest,daprice:e.price,daverify:e.verify,daplanid:e.plan_id,daserid:e.user_id,dathrowtype:e.throw_type},s={},c={},_=e.goods_info[0].url_query;try{c=$.json.decode($.tb.unescapeHTML(_));for(a in c)if(c.hasOwnProperty(a))if("custom"===a){for(n in c[a])if(c[a].hasOwnProperty(n))switch(n){case"zhixintoken":o=c[a][n],s[o]=e.zhixintoken;break;case"forumNameGBK":o=c[a][n],s[o]=e.forumNameGBK}}else if("throw_thread"===a)for(n in c[a])c[a].hasOwnProperty(n)&&(o=c[a][n],s[o]=e[n]);else for(n in c[a])c[a].hasOwnProperty(n)&&(o=c[a][n],s[o]=encodeURIComponent(r(a+"."+n)))}catch(u){}return $.extend(!0,d,s||{},t||{}),d.length>900&&(d=d.substring(0,900)),d},_loadIframe:function(e,t,a){var n=this._addParam(t,a),o=e.find(".iframe_wrapper"),i='<iframe src="'+n+'" scrolling="no" frameborder="0"></iframe>';o.append(i)},_initMessenger:function(){var e=$.getPageData("adsense.messenger",null,window);e||(e=this.requireInstance("pcommon/widget/messenger",["parent","checkStatus"]),e.registerOrigin(this._getMessengerWhitelist()),e.registerCommand({comforum_adsense:$.proxy(this._handleMessengerData,this)}),window.adsense={messenger:e,iframeApiUrl:"http://tb1.bdstatic.com/tb/_/iframe_api_4838100.js"})},_getMessengerWhitelist:function(){var e=0,t=[],a=PageUnit.load("dasense_messenger_whitelist"),n=a.length;for(e;n>e;e++)t.push(a[e][0]);return t},_handleMessengerData:function(e){var t=this.adDomMap.get(e.id),a=t.find(".iframe_wrapper");"success"===e.status?(e.height<a.height()&&a.height(e.height),t.removeClass("hide_style").show()):t.slideUp()},_addParam:function(e,t){var a="",n=[],o=-1===e.indexOf("?")?"?":"&";for(var i in t)t.hasOwnProperty(i)&&n.push(i+"="+t[i]);return a=n.join("&"),e+o+a},_clickStats:function(e,t){var a=this,n=this._getStatsParams(t);t.imTimeSign&&Number(t.imTimeSign)&&a.ck(e.find(".j_click_stats"),t.imTimeSign),e.on("click",".j_click_stats",function(){var e=$(this).data("locate")?"_"+$(this).data("locate"):"",o=t.pos_name+e;a._track($.extend({},n,{locate:o,da_locate:o,type:"click",da_type:"click"})),a._track($.extend({},n,{locate:o,da_locate:o,type:"click",da_type:"click"}),"/billboard/pushlog/?"),a._track($.extend({},n,{locate:o,da_locate:o,type:"click",da_type:"click",baiduid:$.cookie("BAIDUID")||""}),"//als.baidu.com/dalog/logForW?")})},_viewStats:function(e,t){var a=this,n=!1,o=null,i=this._getStatsParams(t),r=(this._getAdLocName(t),$.extend({},i,{locate:t.pos_name,da_locate:t.pos_name,type:"show",da_type:"show"}),function(){n||(a._track($.extend({},i,{locate:t.pos_name,da_locate:t.pos_name,type:"show",da_type:"show"})),a._track($.extend({},i,{locate:t.pos_name,da_locate:t.pos_name,type:"show",da_type:"show"}),"/billboard/pushlog/?"),a._track($.extend({},i,{locate:t.pos_name,da_locate:t.pos_name,type:"show",da_type:"show",baiduid:$.cookie("BAIDUID")||""}),"//als.baidu.com/dalog/logForW?"),n=!0)}),d=function(){var t=e.offset().top,a=e.offset().top+e.height(),n=$(window).scrollTop(),o=$(window).height()+n,i=!1;return(t>n&&o>=t||a>n&&o>=a)&&(i=!0),i},s=$.getPageData("goods_info.0.statsCommand",null,t);s?this.observe(s,function(){d()&&(clearTimeout(o),o=setTimeout(r,200))}):d()?r():($(window).on("scroll",function(){d()&&(clearTimeout(o),o=setTimeout(r,200))}),d()&&(clearTimeout(o),o=setTimeout(r,200)),$(window).on("scroll"))},adEmptyAls:function(e){var t=this;$.each(e,function(e,a){var n=a[0];if(1001===n.goods_info[0].goods_style){var o=t._getStatsParams(n);t._track($.extend({},o,{locate:n.pos_name,da_locate:n.pos_name,type:"show",da_type:"show",baiduid:$.cookie("BAIDUID")||""}),"//als.baidu.com/dalog/logForW?")}})},_track:function(e,t){if(document.images){var a=new Image;window["bd_pv_"+(new Date).getTime()]=a;var n=t||"http://static.tieba.baidu.com/tb/img/track.gif?",o=["t="+(new Date).getTime(),"r=1"+Math.random().toString().slice(2,17)];for(var i in e)e.hasOwnProperty(i)&&o.push(i+"="+encodeURIComponent(e[i]));a.onload=a.onerror=function(){a=null},a.src=n+o.join("&")}},loadCustomJS:function(e){var t=null;e.js&&(t=$.proxy(new Function("$e","PageData","window",e.js),{}),t(e.dom,void 0,void 0))},ck:function(){function e(){var e=b.href,a=b.getAttribute(x),n=t(e);return n=n||t(a)}function t(e){if(!e)return!1;var t=k.exec(e)||D.exec(e);return t?k.exec(e)?t[1].length<20?t[1]:t[1].substr(0,20):t[1]:!1}function a(t){var a=e();if(a!==!1){var o=r(a,t);n(o)}}function n(e){var t="&ck="+[e,p,y,Math.round(m),Math.round(h),Math.round(l),Math.round(f),$].join("."),a=b.href,n=b.getAttribute(x);a&&(b.href=i(a,t)+o(a)),n&&b.setAttribute(x,i(n,t)+o(n))}function o(e){var t="";if(-1===e.indexOf("&shh=")&&-1===e.indexOf("?shh=")&&(t="&shh="+location.hostname),-1===e.indexOf("&sht=")&&-1===e.indexOf("?sht=")){var a=location.href.match(P);a&&(t+="&sht="+a[1])}return t}function i(e,a){return t(e)&&(-1==e.indexOf("&ck=")?e+=a:e=e.replace(/&ck=[\d.]*/,a)),e}function r(e,t){for(var a=0,n=0;p*t%99+9>n;n++)a+=e.charCodeAt(y*n%e.length);return a}function d(e){e=e||window.event,p++,void 0===l&&(l=e.clientX),void 0===f&&(f=e.clientY),g=(new Date).getTime()}function s(e,t){for(e=e||window.event,b=e.target||e.srcElement;b&&"A"!=b.tagName;)b=b.parentNode;w=(new Date).getTime(),y=9999,m=e.clientX,h=e.clientY,$=0===g?0:w-g,a(t)}function c(e,t){v=(new Date).getTime(),y=v-w,a(t)}function _(e,t,a){var n,o,i;for(i in t)n=t[i],o=a[i],window.attachEvent?e.attachEvent("on"+n,o):e.addEventListener(n,o,!1)}function u(e){return[function(e){d(e)},function(t){s(t,e)},function(t){c(t,e)}]}var l=void 0,f=void 0,m=0,h=0,p=0,g=0,w=0,v=0,$=0,y=0,b=0,k=/link\?url\=([^\&]+)/,D=/\?url\=([^\.]+)\./,x="data-cklink",P=/[?&]tn=([^&]*)/,I=function(e,t){void 0===e.length&&(e=[e]);for(var a=e.length,n=0,o=u(t);a>n;n++)_(e[n],["mouseover","mousedown","mouseup"],o)};return I}(),allPost:function(){var e=this,t=$("#j_p_postlist .j_l_post").filter(function(){return!/[a-z0-9]{10}/.exec(this.className)});if(t.length){var a={},n=[],o=function(){var e=$.cookie("BAIDUID")||"";if(e){a={};for(var t=e.substr(0,32),n=function(e){return e=(e+"").replace(/[^a-f0-9]/gi,""),parseInt(e,16)},o=new Date,i=o.getFullYear(),r=o.getMonth(),d=o.getDate(),s=Math.round((new Date).getTime()/1e3),c=new Date(i,1,1,0,0,0,0).getTime()/1e3,_=parseInt((s-c)/86400),u="",l=0;8>l;l++){var f=parseInt(n(t.substr(4*l,4))%10)+"";u+=f}u=Number(u)+48*_;var m=parseInt(u%2e3);if(0>m||m>=48)return!1;var h=1;1==parseInt(m%2)&&(h=2);var p=parseInt(m/2),g=p+1,w=new Date(i,r,d,p,0,0,0).getTime()/1e3,v=new Date(i,r,d,g,0,0,0).getTime()/1e3;return v>(s>w)?(a={eid:h},!0):!1}},i=function(o){if(o&&"show"!=o||$.each(t,function(){if("_show"===$(this).tbattr("showed")){$(this).tbattr("showed","true");var e=t.index($(this))+1,a=PageData.thread.thread_id,o=$(this).data("field").content.post_id;n.push({locate:e,tid:a,pid:o})}}),PageData.forum)var i=PageData.forum.level_1_name,r=PageData.forum.level_2_name,d=PageData.forum.forum_id;o="click"===o?2:3;var s={productId:2,_client_type:0,cuid:$.cookie("BAIDUID")||"",da_type:o,da_page:"PB",da_menu1:i,da_menu2:r,fid:d,ext_info:$.json.encode(a),infos:$.json.encode(n)};e._track(s,"//als.baidu.com/flog/logGFeed?")},r=function(){var e=function(){n=[];var e=!1;return $.each(t,function(){var t=$(this).offset().top,a=$(this).offset().top+$(this).height(),n=$(window).scrollTop(),o=$(window).height()+n;(t>n&&o>=t||a>n&&o>=a)&&($(this).tbattr("showed")||($(this).tbattr("showed","_show"),e=!0))}),e},a=null;$(window).on("scroll",function(){o()&&e()&&(clearTimeout(a),a=setTimeout(i,200))}),o()&&e()&&(clearTimeout(a),a=setTimeout(i,200)),$(window).on("scroll")};r()}}}});_.Module.define({path:"ppb/widget/spreadadPb",sub:{initial:function(a,e,t){var i=$("#spreadad_"+a);if(!(i.size()<1)){this.$me=i;var o=i.data("good_id"),d=i.data("goods_type"),n=i.data("task_id"),r=i.data("good_id"),_=i.data("task_name"),s=i.data("barname_gbk");i.on("click","a",function(e){var t=$($.event.fix(e).currentTarget),i="pb_spreadad_floor_"+a+"_"+o;"0101"==d&&$.cookie(i,1,{expires:1,path:"/"});var s=t.data("locate");$.stats.track(s,"\u5206\u53D1\u7CFB\u7EDF\u4E00\u671F",{obj_type:"\u5206\u53D1",obj_name:n+"_"+_,obj_url:r})}),$.stats.track("pb_\u63A8\u5E7F\u4F4D","\u5206\u53D1\u7CFB\u7EDF\u4E00\u671F","pb","\u5C55\u73B0",{obj_type:"\u5206\u53D1",obj_name:n+"_"+_,obj_url:r});var p=function(){var a=i.find(".spreadad_iframe"),e=a.width(),t=a.height(),o=a.data("src");"0105"==d&&(o+="&word="+s+"&task_name="+window.encodeURIComponent(_)),"0106"==d&&(o+="&query="+window.encodeURIComponent(window.PageData.forum.forum_name)),a.append($('<iframe src="'+o+'" style="width:'+e+"px;height:"+t+'px" scrolling="no" frameborder="0"></iframe>'))};e&&(t||"0106"==d||"0105"==d?p():$(window).on("load",p)),"0106"==d&&(window.__zhixin_hide=$.proxy(this.shutZhixin,this))}},shutZhixin:function(){this.$me.hide()}}});_.Module.define({path:"pplatform/widget/InfoCollection",requires:["common/component/Placeholder"],sub:{initial:function(n){this.options=n,this.initDialogEvent()},initPlaceHolder:function(){this.requireInstanceAsync("common/component/Placeholder",[".j_info_collection_info","\u7B80\u8FF0\u60A8\u7684\u9700\u6C42..."]),this.requireInstanceAsync("common/component/Placeholder",[".j_info_collection_name","\u60A8\u7684\u59D3\u6C0F"]),this.requireInstanceAsync("common/component/Placeholder",[".j_info_collection_city","\u60A8\u7684\u57CE\u5E02"]),this.requireInstanceAsync("common/component/Placeholder",[".j_info_collection_phone","\u60A8\u7684\u624B\u673A"])},initDialogEvent:function(){var n=this;$(".info_collection_main").on("click",".j_info_collection_button, .j_info_collection_main_logo",function(){var o=baidu.template("info_collection_form",{}),i=new $.dialog({title:"",noTitle:!0,holderClassName:"info_collection_form",html:o,width:470});n.dialog=i,n.$main=$(i.getElement()),n.initCheckEvent(),n.initSubmitEvent(),n.initPlaceHolder()})},initSubmitEvent:function(){var n=this,o=n.$main;o.on("click",".j_info_collection_submit",function(i){i.preventDefault(),n.submitCheck()&&$.post("/gcf/consume/consumeCommit?ie=utf-8",{tbs:PageData.tbs,forum_name:PageData.forum.forum_name,forum_id:PageData.forum.forum_id,name:o.find(".j_info_collection_name").val(),info:o.find(".j_info_collection_info").val(),gender:o.find("input[name='gender']:checked").val(),city:o.find(".j_info_collection_city").val(),mobile_phone_number:o.find(".j_info_collection_phone").val(),start_time:n.options.start_time,end_time:n.options.end_time},function(o){if(0==o.no){var i=baidu.template("info_collection_success_dialog",{}),e=new $.dialog({title:"",noTitle:!0,holderClassName:"info_collection_success_dialog",html:i,width:410});$(e.element).on("onclose",function(){n.dialog.close()}),$(e.element).on("click",".j_success_button",function(n){n.preventDefault(),e.close()})}else 210009==o.no?n.alertInfo("\u4E0D\u662F\u5408\u6CD5\u7684\u624B\u673A\u53F7~"):2220013==o.no?n.alertInfo("\u64CD\u4F5C\u8FC7\u4E8E\u9891\u7E41\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5~"):n.alertInfo("\u64CD\u4F5C\u5F02\u5E38\uFF0C\u8BF7\u518D\u8BD5\u4E00\u4E0B~")},"json")})},submitCheck:function(){var n=this,o=n.$main.find(".j_info_collection_phone"),i=/^1\d{10}$/g,e=!0;return i.test(o.val())===!1?(o.addClass("error_hint"),o.siblings("p").css("display","block"),e=!1):(o.siblings("p").css("display","none"),o.removeClass("error_hint")),e},initCheckEvent:function(){var n=this,o=n.$main.find(".j_info_collection_phone"),i=/^1\d{10}$/g;o.on("focus",function(){$(this).removeClass("error_hint"),o.siblings("p").css("display","none")}),o.on("blur",function(){i.test(o.val())===!1&&($(this).addClass("error_hint"),o.siblings("p").css("display","block"))})},alertInfo:function(n){$.tb.alert({heading:"",message:"<h3 style='text-align:center;margin-bottom:40px'>"+n+"</h3>",noTitle:!0,buttons:[{text:"\u786E\u5B9A",callback:function(n,o){o.close()}}]})}}});_.Module.define({path:"puser/widget/Residual",requires:[],sub:{initial:function(i){this.dataObj=i,this.initOptions()},initOptions:function(){this.options={1070001:"worship",1070002:"egg"}},getResidualKey:function(i){for(var e=i.props||{},s=null,n="",t=["1070002","1070001"],a=0;a<t.length;a++)if(s=e[t[a]],s&&s.num>0&&s.end_time>Env.server_time/1e3){n=this.options[t[a]];break}return n},showUI:function(i){var e=i.wrap,s="",n=null,t=i.key||this.getResidualKey(i);t&&(s="residual_wrap residual_wrap_"+t,n=e.find(".residual_wrap"),n[0]?n.removeClass().addClass(s):(n=$('<div class="'+s+'"></div>'),e.append(n)))}}});_.Module.define({path:"common/widget/LoginDialog",sub:{_config:{apiOpt:{staticPage:$.tb.location.getProtocol()+"//"+$.tb.location.getHost()+"/tb/static-common/html/pass/v3Jump.html",product:"tb",charset:PageData.charset?PageData.charset:"UTF-8",u:$.tb.location.getHref(),memberPass:!0,safeFlag:0,qrcodeCfg:{appName:"\u624B\u673A\u8D34\u5427 - \u6211\u7684",appHref:"http://tieba.baidu.com/c/s/download/pc"}},cache:!0,onLoginSuccess:function(t){t.returnValue=!1,$.tb.location.reload(),$.stats.track("\u8D34\u5427\u767B\u5F55\u7EDF\u8BA1","\u767B\u5F55\u6210\u529F","","click")},onShow:function(){$.stats.track("\u8D34\u5427\u767B\u5F55\u7EDF\u8BA1","\u767B\u5F55\u6846\u6253\u5F00","","view")},onHide:function(){$.stats.track("\u8D34\u5427\u767B\u5F55\u7EDF\u8BA1","\u767B\u5F55\u6846\u5173\u95ED","","view")},registerLink:"https://passport.baidu.com/v2/?reg&tpl=tb&u=//tieba.baidu.com",tangram:!0,forgetLink:"https://passport.baidu.com/?getpass_index"},initial:function(){var t=this;!function(a){var o="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime(),e="https://passport";a.JsLoadManager.use([e+".baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(o/6e4)],function(){a.passPopInstance||(a.passPopInstance=passport.pop.init(t._config)),a.passPopInstance.show()},!0,"utf-8")}(window.jQuery)}}});_.Module.define({path:"comforum/widget/promoter_post_opts",requires:["common/widget/LoginDialog","common/widget/ScrollPanel"],sub:{initial:function(t){if(this.args=t||{},this.args=$.extend(this.args,{tbs:PageData.tbs,forumId:PageData.forum.forum_id,forumName:PageData.forum.forum_name,threadId:PageData.thread.thread_id,threadTitle:PageData.thread.title,threadContent:PageData.thread.thread_id,userId:PageData.user.user_id,userLevel:PageData.user.level_id,userIsLogin:PageData.user.is_login}),this.tbs=this.args.tbs,this.pn=this.args.pn,this.forumId=this.args.forumId,this.forumName=this.args.forumName,this.threadId=this.args.threadId,this.threadTitle=this.args.threadTitle,this.threadContent=this.args.threadContentthreadContent,this.threadMasterTitle=this.args.promoterMasterTitle,this.userId=this.args.userId,this.userLevel=this.args.userLevel,this.userIsLogin=this.args.userIsLogin,this.userPostPid="",this.promoterSource=this.args.promoterAttr.source||{},this.promoterSourceType=this.promoterSource.type,this.promoterSourceForumId=this.promoterSource.forum_id,this.promoterSourcePosition=this.promoterSource.position,this.promoterSourceUserId=this.promoterSource.user_id,this.promoterSourceTime=this.promoterSource.time,this.promoterSourceString=[this.promoterSourceType,this.promoterSourceForumId,this.promoterSourcePosition,this.promoterSourceUserId,this.promoterSourceTime].join(","),this.promoterVideo=this.args.promoterAttr.video||{},this.promoterVideoImageUrl=this.promoterVideo.img_url,this.promoterVideoLinkUrl=this.promoterVideo.link_url,this.promoterUserIds=this.args.promoterUserIds,this.defaultThreadContent="\u6311\u6218\u5BA3\u8A00",this.repostPostId="",this.$postList=$(".j_l_post"),this.$titleOpt=$(".j_promoter_title_opt"),"0"==this.promoterSourceType)this.getPbZan();else{if(!(this.promoterSourceType>"0"&&"1"==this.pn))return;this.getPbUserZan()}this.bindEvents()},bindEvents:function(){this.$postList.on("click",".j_opt_btn_zan",$.proxy(this.doZan,this)),this.$postList.on("click",".j_opt_btn_challenge",$.proxy(this.doChallenge,this)),this.$postList.on("click",".j_opt_btn_repost",$.proxy(this.getRepostToForumList,this)),window.Page.checkLoadedModules("forumList")||this.$titleOpt.on("click",$.proxy(this.onTitleOptClick,this))},getPromoterDialogContent:function(t){t||(t={},t.tips=["\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8FD8\u8BF7\u91CD\u8BD5\u4E0B"],t.opts=[{type:"close",color:"sub",text:"\u5173\u95ED"}]);var o=this,e=t.title?'<div class="promoter_dialog_title">'+t.title+"</div>":"",s="";t.tips&&$(t.tips).each(function(t,o){s+="<p>"+o+"</p>"});var r="";t.opts&&$(t.opts).each(function(t,e){switch(e.type){case"close":r+='<button class="btn btn-'+(e.color||"default")+' btn-middle j_toClose"'+(e.stats?' data-locate="'+e.stats.locate+'"':"")+">"+(e.text||"\u53D6\u6D88")+"</button>";break;case"my_floor":r+='<button class="btn btn-'+(e.color||"default")+' btn-middle j_toMyFloor">'+(e.text||"\u6211\u7684\u697C\u5C42")+"</button>";break;case"repost":r+='<button class="btn btn-'+(e.color||"default")+' btn-middle j_toRepost">'+(e.text||"\u8F6C\u53D1")+"</button>";break;case"redirect":r+='<a href="'+o.promoterVideoLinkUrl+'" target="_blank" class="btn btn-'+(e.color||"default")+' btn-middle j_toRedirect"'+(e.stats?' data-locate="'+e.stats.locate+'"':"")+">"+(e.text||"\u901B\u540E\u5BAB")+"</a>"}});var i=t.repost?['<div class="promoter_dialog_head">\u8F6C\u53D1\u6218\u4E66</div>','<div class="promoter_dialog_repost">',t.repost.info?'<div class="info">'+t.repost.info+"</div>":"",'<div class="post_form'+(0==o.promoterSourceType?"":" post_form_readonly")+'">','<div class="video_image"><div class="img"><img src="',o.promoterVideoImageUrl,'" alt=""></div></div>','<div class="post_form_input post_form_input_title">',0==o.promoterSourceType?'<input type="text" class="j_promoter_repost_title" placeholder="\u6311\u6218\u6807\u9898" value="">':'<span class="label">\u6807\u9898\uFF1A</span>'+o.threadTitle,"</div>",'<div class="post_form_input post_form_input_content">',0==o.promoterSourceType?'<textarea class="j_promoter_repost_content" placeholder="'+o.defaultThreadContent+'"></textarea>':'<span class="label">\u5185\u5BB9\uFF1A</span>'+o.threadContent,"</div>","</div>",'<div class="post_to">','<div class="h4">\u8F6C\u53D1\u5230\uFF1A</div>','<div class="post_forum_list clearfix j_post_forum_list">',"</div>","</div>","</div>"].join(""):"",a=['<div class="promoter_dialog_body">',e,i,'<div class="promoter_dialog_tip">',s,"</div>",'<div class="promoter_dialog_opts">',r,"</div>","</div>"].join("");return a},bindDialogEvent:function(t){var o=this;t.element.on("click",".j_toClose",function(e){var s=$(e.currentTarget),r=s.tbattr("data-locate");$.stats.track(r,"\u63A8\u5E7F\u5458\u7CFB\u7EDF","","click",{obj_type:o.promoterSourceType}),t.close()}),t.element.on("click",".j_toRedirect",function(t){var e=$(t.currentTarget),s=e.tbattr("data-locate");$.stats.track(s,"\u63A8\u5E7F\u5458\u7CFB\u7EDF","","click",{obj_type:o.promoterSourceType})}),t.element.on("click",".j_toMyFloor",function(){t.close(),o.jumpToMyFloor()}),t.element.on("click",".j_toRepost",function(){o.doRepost(t)}),t.element.on("click",".j_toRepostForum",function(t){o.setRepostToForum(t)})},doZan:function(t){if(!this.userIsLogin)return this.requireInstance("common/widget/LoginDialog"),void 0;if(!this.doingZan){var o=this,e=$(t.currentTarget).closest(".j_l_post"),s=e.get(0)&&e.getData(),r=s&&s.content&&s.content.post_id||"";this.doingZan=!0,$.ajax({url:"/minigame/caster/zan",type:"POST",dataType:"json",data:{post_id:r,tbs:o.tbs}}).done(function(e){o.doZanCallback(e),0==e.no&&o.doZanAnimate(t),o.doingZan=null})}},doZanCallback:function(t){t=t||{};var o=[];o[0]={title:"\u70B9\u8D5E\u6210\u529F\uFF01",tips:["\u60A8\u73B0\u5728\u53EF\u4EE5\u53BB\u901B"+this.threadMasterTitle+"\u5927\u5E1D\u7684\u540E\u5BAB\u5566\uFF01"],opts:[{type:"close",color:"sub",stats:{locate:"\u70B9\u8D5E\u6210\u529F-\u5173\u95ED\u6309\u94AE"}},{type:"redirect",stats:{locate:"\u70B9\u8D5E\u6210\u529F-\u901B\u540E\u5BAB\u6309\u94AE"}}]},o[65535]={tips:["\u6BCF\u5929\u53EA\u80FD\u70B9\u4E00\u6B21\u8D5E\uFF0C\u4ECA\u5929\u60A8\u7684\u8D5E\u5DF2\u7ECF\u70B9\u8FC7\u4E86\uFF0C","\u8BF7\u660E\u5929\u518D\u6765\u70B9\u8D5E\u5427\uFF01"],opts:[{type:"close",color:"sub",stats:{locate:"\u5DF2\u7ECF\u70B9\u8D5E-\u5173\u95ED\u6309\u94AE"}},{type:"redirect",stats:{locate:"\u5DF2\u7ECF\u70B9\u8D5E-\u901B\u540E\u5BAB\u6309\u94AE"}}]},o[65534]={title:"\u4ECA\u5929\u7684\u8D5E\u5DF2\u7ECF\u7528\u5B8C\u4E86",tips:["\u60A8\u53EF\u4EE5\u53BB\u9759\u6001\u5927\u5E1D\u7684\u540E\u5BAB\u901B\u901B\uFF5E"],opts:[{type:"close",color:"sub",stats:{locate:"\u8D5E\u7528\u5B8C\u4E86-\u5173\u95ED\u6309\u94AE"}},{type:"redirect",stats:{locate:"\u8D5E\u7528\u5B8C\u4E86-\u901B\u540E\u5BAB\u6309\u94AE"}}]};var e=this.getPromoterDialogContent(o[t.no]),s=new $.dialog({showShadow:!1,fixed:!1,html:e,holderClassName:"promoter_dialog",width:430});this.bindDialogEvent(s)},doZanAnimate:function(t){var o=$(t.currentTarget),e=o.find(".opt_icon"),s=$('<div class="plus">+1</div>');e.append(s),s.animate({"margin-bottom":"10px"}).animate({opacity:"0"},function(){s.remove()});var r=o.find(".j_zan_count"),i=r.find("span").text()||"0";this.setCount(r,+i+1)},setCount:function(t,o){t.html("<span>"+o+"</span>\u4EBA")},doChallenge:function(){if(!this.userIsLogin)return this.requireInstance("common/widget/LoginDialog"),void 0;if(!this.doingChallenge){$.stats.track("\u6311\u6218","\u63A8\u5E7F\u5458\u7CFB\u7EDF","","click");var t=this;if(t.userLevel<6)return t.doChallengeCallback({err_code:2540001}),void 0;if(t.userPostPid)return t.doChallengeCallback({err_code:2210002}),void 0;if(t.userId&&t.promoterSourceUserId==t.userId)return t.doChallengeCallback({err_code:"a3"}),void 0;this.doingChallenge=!0,$.ajax({url:"/f/commit/post/caster/add",type:"POST",dataType:"json",data:{caster_post_type:0,tid:t.threadId,content:" ",fid:t.forumId,fname:t.forumName,kw:t.forumName,tbs:t.tbs}}).done(function(o){t.doChallengeCallback(o),t.doingChallenge=null})}},doChallengeCallback:function(t){t=t||{};var o=[];o[0]={tips:["\u6311\u6218\u6210\u529F\uFF01\u53EF\u4EE5\u8F6C\u53D1\u5230\u8D34\u5427\u8BF7\u5C0F\u4F19\u4F34\u5E2E\u52A9\u54E6\uFF01"],opts:[{type:"my_floor",text:"\u6211\u7684\u697C\u5C42"}]},o.a3={tips:["\u4EB2\u771F\u987D\u76AE\uFF0C\u4E0D\u80FD\u81EA\u5DF1\u6311\u6218\u81EA\u5DF1\u5594~"],opts:[{type:"close",text:"\u77E5\u9053\u4E86"}]},o[2540001]={tips:["\u5F88\u62B1\u6B49\uFF0C\u53EA\u6709\u672C\u54276\u7EA7\u4EE5\u4E0A\u4F1A\u5458\u624D\u80FD\u53D1\u8D77\u6311\u6218"],opts:[{type:"close",color:"sub",text:"\u77E5\u9053\u4E86",stats:{locate:"\u975E6\u7EA7\u4EE5\u4E0A\u6311\u6218-\u5173\u95ED\u6309\u94AE"}},{type:"redirect",text:"\u6C42\u5B89\u6170",stats:{locate:"\u975E6\u7EA7\u4EE5\u4E0A\u6311\u6218-\u6C42\u5B89\u6170\u6309\u94AE"}}]},o[2270017]={tips:["\u5F88\u62B1\u6B49\uFF0C\u672C\u8D34\u5DF2\u8FC7\u671F\uFF0C\u4E0D\u652F\u6301\u6311\u6218\uFF5E"],opts:[{type:"close",text:"\u77E5\u9053\u4E86"}]},o[2210002]={tips:["\u60A8\u4ECA\u513F\u5DF2\u7ECF\u53D1\u8D77\u8FC7\u6311\u6218\u5566\uFF0C\u660E\u513F\u518D\u6765\uFF5E"],opts:[{type:"my_floor",text:"\u6211\u7684\u697C\u5C42"}]},2210002!=t.err_code||this.userPostPid||(o[2210002]={tips:["\u5F88\u62B1\u6B49\uFF0C\u53EA\u80FD\u5728\u4E00\u4E2A\u5DE5\u4F1A\u53D1\u8D77\u6311\u6218"],opts:[{type:"close",color:"sub",text:"\u77E5\u9053\u4E86"}]});var e=this.getPromoterDialogContent(o[t.err_code]),s=new $.dialog({showShadow:!1,fixed:!1,html:e,holderClassName:"promoter_dialog",width:430});0==t.err_code&&(this.userPostPid=t.data.post_id,this.updateTitleDisplay()),this.bindDialogEvent(s)},getRepostToForumList:function(t){if(!this.gettingRepostToForumList){var o=this,e=$(t.currentTarget).closest(".j_l_post"),s=e.getData(),r=s.content&&s.content.post_id||"",i=s.content&&s.content.content||"";if(this.repostPostId=r,this.threadContent=i,o.repostToForumListReceived)return o.showRepostForm(),void 0;this.gettingRepostToForumList=!0,$.ajax({url:"/minigame/caster/favorforum",type:"GET",dataType:"json"}).done(function(t){0==t.no?(o.repostToForumListReceived=!0,o.repostToForumList=t.data,o.showRepostForm()):o.doRepostCallback(),o.gettingRepostToForumList=null})}},showRepostForm:function(){if(this.repostToForumListReceived&&(!this.repostToForumList||!this.repostToForumList.length))return this.doRepostCallback({err_code:2540001}),void 0;var t={repost:{info:0==this.promoterSourceType?"\u6BCF\u5929\u53EA\u80FD\u8F6C\u53D1\u4E00\u6B21\uFF0C\u8BF7\u73CD\u60DC\u8FD9\u6B21\u673A\u4F1A\u54E6~":""},opts:[{type:"close",color:"sub"},{type:"repost",text:"\u8F6C\u53D1"}]},o=this.getPromoterDialogContent(t),e=new $.dialog({showShadow:!1,fixed:!1,html:o,holderClassName:"promoter_dialog",width:520});this.buildRepostToForumListContent(e),this.repostToForumId="",this.repostToForumName="",this.bindDialogEvent(e)},buildRepostToForumListContent:function(t){for(var o="",e=0,s=this.repostToForumList.length;s>e;e++){var r=this.repostToForumList[e];o+='<a href="javascript:" class="post_forum j_toRepostForum" data-fid="'+r.forum_id+'" data-fname="'+r.forum_name+'">'+r.forum_name+'<span class="forum_level lv'+r.level_id+'"></span></a>'}this.requireInstance("common/widget/ScrollPanel",{container:t.element.find(".j_post_forum_list"),height:135,content:o})},setRepostToForum:function(t){var o=$(t.currentTarget),e=o.tbattr("data-fid"),s=o.tbattr("data-fname");this.repostToForumId=e,this.repostToForumName=s,o.siblings().removeClass("post_forum_selected"),o.addClass("post_forum_selected")},doRepost:function(t){if(!this.doingRepost){var o=this;if(!o.repostToForumId)return o.doRepostCallback({err_code:"a1"}),void 0;if(!$.trim($(".j_promoter_repost_title").val())&&0==o.promoterSourceType)return o.doRepostCallback({err_code:"needTitle"}),void 0;this.doingRepost=!0,$.ajax({url:"/f/commit/thread/caster/add",type:"POST",dataType:"json",data:{caster_post_type:+o.promoterSourceType+1,caster_post_id:this.repostPostId,title:0==o.promoterSourceType?$(".j_promoter_repost_title").val()||"":o.threadTitle,content:0==o.promoterSourceType?$(".j_promoter_repost_content").val()||"":o.threadContent,fid:o.repostToForumId,fname:o.repostToForumName,kw:o.repostToForumName,tbs:o.tbs}}).done(function(e){o.doRepostCallback(e),0==e.err_code&&t.close(),o.doingRepost=null})}},doRepostCallback:function(t){t=t||{};var o=[];o[0]={tips:["\u8F6C\u53D1\u6210\u529F\uFF01"]},o.a1={tips:["\u8FD8\u6CA1\u9009\u62E9\u8F6C\u53D1\u5230\u7684\u5427"],opts:[{type:"close",color:"sub",text:"\u77E5\u9053\u4E86"}]},o.needTitle={tips:["\u6311\u6218\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A"],opts:[{type:"close",color:"sub",text:"\u77E5\u9053\u4E86"}]},o[2540001]={tips:["\u5F88\u62B1\u6B49\uFF0C\u6311\u6218\u8D34\u53EA\u80FD\u8F6C\u53D1\u52306\u7EA7\u4EE5\u4E0A\u5427\u4E2D\uFF01","\u60A8\u8FD8\u6CA1\u6709\u5230\u8FBE6\u7EA7\u7684\u5427"],opts:[{type:"close",text:"\u77E5\u9053\u4E86"}]},o[2270017]={tips:["\u5F88\u62B1\u6B49\uFF0C\u672C\u8D34\u5DF2\u8FC7\u671F\uFF0C\u4E0D\u652F\u6301\u8F6C\u53D1\uFF5E"],opts:[{type:"close",text:"\u77E5\u9053\u4E86"}]},o[65535]={tips:["\u5F88\u62B1\u6B49\uFF0C\u4ECA\u5929\u7684\u8F6C\u53D1\u673A\u4F1A\u7528\u5B8C\u4E86\uFF01","\u60A8\u53EF\u4EE5\u5728\u6211\u7684\u8D34\u5B50\u4E2D\u67E5\u770B\u5DF2\u8F6C\u53D1\u8D34\u5B50"],opts:[{type:"close",text:"\u77E5\u9053\u4E86"}]},o[65533]={tips:["\u5F88\u62B1\u6B49\uFF0C\u8BE5\u5427\u8F6C\u53D1\u6B21\u6570\u53D7\u5230\u9650\u5236\uFF01"],opts:[{type:"close",text:"\u77E5\u9053\u4E86"}]},o[65534]={tips:["\u5F88\u62B1\u6B49\uFF0C\u8F6C\u53D1\u592A\u9891\u7E41\u5566\uFF0C\u4F11\u606F\u4E0B\u5427"],opts:[{type:"close",text:"\u77E5\u9053\u4E86"}]};var e=this.getPromoterDialogContent(o[t.err_code]),s=new $.dialog({showShadow:!1,fixed:!1,html:e,holderClassName:"promoter_dialog",width:430});0==t.err_code&&setTimeout(function(){s.close()},2e3),this.bindDialogEvent(s)},jumpToMyFloor:function(){if(this.userPostPid){var t="/p/"+this.threadId+"?pid="+this.userPostPid+"#"+this.userPostPid;$.tb.location.setHref(t)}},getPbZan:function(){var t=this;$.ajax({url:"/minigame/caster/pb",type:"GET",dataType:"json",data:{caster_attr:t.promoterSourceString,thread_id:t.threadId,user_ids:t.promoterUserIds.join(",")}}).done(function(o){t.getPbZanCallback(o),t.updateTitleDisplay()})},getPbUserZan:function(){var t=this;$.ajax({url:"/minigame/caster/userzan",type:"GET",dataType:"json",data:{caster_attr:t.promoterSourceString}}).done(function(o){0==o.no&&t.setCount($(t.$postList.get(0)).find(".j_opt_btn_zan .j_zan_count"),o.data[t.promoterSourceUserId]||0)})},getPostFloor:function(t){var o;return $(this.$postList).each(function(e,s){var r=$(s).getData(),i=r&&r.author&&r.author.user_id||"";return i==t?(o=$(s),!1):void 0}),o},getPbZanCallback:function(t){var o=this;if(0===t.no){var e=t.data;o.userPostPid=e.my_post,$(e.user_zan).each(function(t,e){var s=o.getPostFloor(e.user_id);s&&s.get(0)&&o.setCount(s.find(".j_opt_btn_zan .j_zan_count"),e.score||0)}),o.setCount($(o.$postList.get(0)).find(".j_opt_btn_challenge .j_challenge_count"),e.participants||0)}},onTitleOptClick:function(){this.userPostPid?this.jumpToMyFloor():(this.doChallenge(),$.stats.track("\u6311\u6218-\u8D34\u5B50\u6807\u9898\u53F3\u4FA7","\u63A8\u5E7F\u5458\u7CFB\u7EDF","","click"))},updateTitleDisplay:function(){var t="\u6211\u8981\u6311\u6218";this.userPostPid&&(t="\u6211\u7684\u697C\u5C42"),this.$titleOpt.text(t)}}});_.Module.define({path:"comforum/widget/promoter_post_body",requires:["comforum/widget/promoterPostOpts"],sub:{TPL:['<div class="promoter_privilege_preview_box">','<div class="promoter_privilege_preview_video j_promoter_video"></div>',"</div>"].join(""),initial:function(e){this.args=e||{},this.requireInstance("comforum/widget/promoterPostOpts",[e]),this.promoterSource=this.args.promoterAttr.source,this.promoterVideo=this.args.promoterAttr.video,this.pn=this.args.pn,this.promoterVideo&&1==this.pn&&(0==this.promoterSource.type?this.preview():this.initVideo())},preview:function(){this.$previewBox=$(this.TPL);var e=$("#j_p_postlist");e.prepend(this.$previewBox),this.initPreview()},initPreview:function(){var e=this.$previewBox.find(".j_promoter_video");new $.swf("//tb2.bdstatic.com/tb/static-comforum/widget/promoter_post_body/img/video_645ce54.swf",{id:"promoter_privilege_preview_video_swf",container:e,width:520,height:320,params:{allowFullScreen:!0,swLiveConnect:!0,wMode:"transparent",quality:"high",allowScriptAccess:"always",menu:!1}});var i=this;setTimeout(function(){i.removePreview()},6e3)},removePreview:function(){this.$previewBox.remove(),this.initVideo()},initVideo:function(){var e=this.promoterVideo.flash;e&&new $.swf(e,{id:"promoter_master_video_swf",container:$(".j_l_post:first").find(".j_master_video"),width:400,height:300,params:{allowFullScreen:!0,swLiveConnect:!0,wMode:"transparent",quality:"high",allowScriptAccess:"always",menu:!1}})}}});!function(t){function a(a){if(PageData.user.is_login){t.stats.sendRequest("fr=tb0_forum&st_mod=idisk&st_type=download");var e=t(a);return t.post("/data/filepost?method=update_file_statistic",{fs_id:e.data("fsId"),thread_id:PageData.thread.thread_id,forum_id:PageData.forum.forum_id,stat_kind:0,tbs:PageData.tbs}),!0}return TbCom.process("User","buildLoginFrame"),!1}function e(a){if(PageData.user.is_login){t.stats.sendRequest("fr=tb0_forum&st_mod=idisk&st_type=forward");var e={31061:"\u6587\u4EF6\u5DF2\u5B58\u5728",31112:"\u767E\u5EA6\u4E91\u7A7A\u95F4\u4E0D\u8DB3&nbsp;<a href='http://pan.baidu.com' target='_blank'>\u6574\u7406\u7F51\u76D8</a> "},d=t(a);t.post("/data/filepost",{method:"archiveFile",src_uk:d.data("uk"),src_path:d.data("filePath"),dst_path:"/"+d.data("fileName"),tbs:PageData.tbs},function(a){var i;return a.status&&"-3"==a.status?void t.dialog.alert("<div style='padding: 20px 30px; text-align: center;'>\u64CD\u4F5C\u5931\u8D25\u4E86\uFF0C\u5237\u65B0\u4E00\u4E0B\u8BD5\u8BD5</div>",{width:300}):void(a.error_code?(i=e[a.error_code],i||(i="\u8F6C\u5B58\u5931\u8D25"),t.dialog.alert("<div style='padding: 20px 30px; text-align: center;'>"+i+"</div>",{width:300})):d.hide().after("<a class='file_link' target='_blank' href='http://pan.baidu.com'>\u5DF2\u8F6C\u5B58</a>"))},"json"),t.post("/data/filepost?method=update_file_statistic",{fs_id:d.data("fsId"),thread_id:PageData.thread.thread_id,forum_id:PageData.forum.forum_id,stat_kind:1,tbs:PageData.tbs})}else TbCom.process("User","buildLoginFrame");return!1}window.diskmanager={};var d=window.diskmanager;d.onClickDownload=a,d.onClickSaveToMine=e}(jQuery);_.Module.define({path:"pb/widget/content_recommend",requires:[],sub:{initial:function(e){var n=this;n.opts=e,n.bindEvents()},getOptionsDom:function(){var e=this,n="";return e.opts.category.forEach(function(e){n+='<label class="content-recommend-label" for="'+e.tag_id+'"><input class="content-recommend-radio" type="radio" name="tagid" id="'+e.tag_id+'" value="'+e.tag_id+'"/>'+e.name+"</label>"}),n+='<a href="javascript:;" class="btn-default btn-middle content-recommend-btn j-content-recommend-send">\u63D0\u4EA4</a>'},sendAjax:function(){var e=this,n=$("input[name='tagid']:checked").val();n?$.post("/encourage/post/reco/recommend",{source_id:e.opts.source_id,tid:e.opts.tid,tag_id:n,tbs:window.PageData.tbs},function(n){0===+n.no?(e.RecommendDialog.close(),$.dialog.assert("\u63D0\u4EA4\u6210\u529F~")):$.dialog.assert("\u63D0\u4EA4\u5931\u8D25~")}):$.dialog.assert("\u8BF7\u9009\u62E9\u7C7B\u578B")},bindEvents:function(){var e=this;$(".j-content-recommend").on("click",function(){e.RecommendDialog=new $.dialog({holderClassName:"content-recommend",html:e.getOptionsDom(),title:e.opts.name,draggable:!1})}),$("body").on("click",".j-content-recommend-send",function(){e.sendAjax()})}}});_.Module.define({path:"puser/component/PropsApi",requires:["pcommon/component/JsPager"],sub:{initial:function(t){this.dataObj=t,this.initOptions(),this.bindEvents()},initOptions:function(){this.titleMap={"1070001_0":"\u4ED6\u4EEC\u5BF9\u6211\u4F7F\u7528\u4E86\u201C\u9B54\u62DC\u201D","1070001_1":"\u4ED6\u4EEC\u5BF9\u8D34\u4F7F\u7528\u4E86\u201C\u9B54\u62DC\u201D","1070002_0":"\u4ED6\u4EEC\u5BF9\u6211\u4F7F\u7528\u4E86\u201C\u9B54\u86CB\u201D","1070002_1":"\u4ED6\u4EEC\u5BF9\u8D34\u4F7F\u7528\u4E86\u201C\u9B54\u86CB\u201D"},this.urlMap={0:"/tbmall/getUserAppraise",1:"/tbmall/getPostAppraise"}},bindEvents:function(){var t=this,i=t.dataObj;$(".props_item_tail").live("click",function(){return t.propsData={props_id:$(this).data("propsid"),props_type:i.props_type},"0"==i.props_type&&(t.propsData.user_id=$(this).data("userid"),t.propsData.user_sex=$(this).data("usersex")),"1"==i.props_type&&(t.propsData.post_id=$(this).data("postid")),t.initPager=!0,t.showDialog(),!1})},getAttrsHtml:function(t){for(var i=null,s=[],a="",p=["user_id","user_sex","post_id","props_id"],e=0;e<p.length;e++)i=p[e],t[i]&&(a="data-"+i.replace(/_/,"")+'="'+t[i]+'"',s.push(a));return s.join(" ")},showUIHtml:function(t){for(var i=[],s=t.props||{},a=null,p=0,e=["1070001","1070002"],r=0;r<e.length;r++)t.props_id=e[r],a=s[e[r]],a&&(i.push('<li class="props_item_split"><span class="userinfo_split"></span></li>'),i.push('<li class="props_item props_item_'+e[r]+'">'),i.push('<a href="#" '+this.getAttrsHtml(t)+' class="props_item_tail">'),i.push('<span class="props_item_icon"></span>'),i.push('<span class="props_item_plus">'+String.fromCharCode(215)+"</span>"),i.push('<span class="props_item_num">'+a.num+"</span></li>"),i.push("</a>"),p++);return 0>p?"":i.join("")},showUI:function(t){var i=this.showUIHtml(t);i&&t.wrap.html(i)},showDialog:function(){this.initDialogData(),this.initDialogUI(),this.showOrUpdateList()},initDialogData:function(){var t=this.propsData,i=t.props_id+"_"+t.props_type,s=this.titleMap[i];if(t.user_id!==PageData.user.id){var a=t.user_sex;s=s.replace(/\u6211/,a)}this.dialogTitle=s,this.dataurl=this.urlMap[t.props_type],this.pn=0,this.pageSize=10,this.pageCount=8},initDialogUI:function(){var t=this;this.$wrap=$('<div class="props_userlist_wrap"></div>'),this.$userlist=$('<div class="props_userlist_main"></div>'),this.$wrap.append(this.$userlist),this.dialog=new $.dialog({title:t.dialogTitle,width:554,height:340,show:!1,html:this.$wrap})},showOrUpdateList:function(){var t=this,i=t.propsData,s={props_id:i.props_id,look_user_id:i.user_id||"",post_id:i.post_id||"",pn:t.pn,c:t.pageSize};$.tb.get(t.dataurl,s,function(i){i&&0==i.no?(t.list=i.data.list,t.updateList(),t.initPager&&i.data.total>1&&(t.initPager=!1,t.total=Math.ceil(i.data.total/t.pageSize),t.buildPager()),t.dialog.show()):t.showErrorDialog()})},showErrorDialog:function(){new $.dialog({title:"\u63D0\u793A",width:300,height:50,html:'<p style="text-align:center;font-size:14px;line-height:40px;">\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u91CD\u8BD5</p>'})},buildPager:function(){var t=$('<div class="props_userlist_pager"></div>');this.$wrap.append(t);var i=this,s=this.use("pcommon/component/JsPager",{container:t,current:1,amount:i.pageCount,total:i.total});s.bind("pageChange",function(t,a){s.initial({current:a}),i.pn=a,i.showOrUpdateList()}),this.pager=s},updateList:function(){var t=this.list,i=[],s=null;i.push('<ul class="props_userlist">');for(var a=0;a<t.length;a++)s=t[a],i.push('<li class="userlist_item">'),i.push('<a class="userlist_head" href="/home/main?id='+s.portrait+'&fr=props" target="_blank"><img src="http://tb.himg.baidu.com/sys/portrait/item/'+s.portrait+'"/></a>'),i.push('<a class="userlist_name" href="/home/main?id='+s.portrait+'&fr=props" target="_blank">'+s.user_name+"</a>"),i.push('<p class="userlist_time">'+this.getShowtime(s.create_time)+"</p>"),i.push("</li>");i.push("</ul>"),this.$userlist.html(i.join(""))},getShowtime:function(t){t*=1e3;var i=new Date($.dateFormat(new Date(Env.server_time),"yyyy-MM-dd 00:00:00")).getTime();return t=t>i?$.dateFormat(new Date(t),"HH:mm"):$.dateFormat(new Date(t),"yyyy-MM-dd")}}});_.Module.define({path:"ppb/widget/sub_list/postTail",requires:["puser/component/PropsApi"],sub:{thread:{},power:{},initial:function(a){this.tailList=a.tailList,this.thread=PageData.thread,this.power=PageData.power,this.user=PageData.user,this.tailList=a.tailList,this.propsapi=this.use("puser/component/PropsApi",{props_type:"1"})},getPostTailTpl:function(a,t){var s="",i='<div class="core_reply_tail '+(a.is_saveface?"save_card_reply_tail":"")+'">';return i+=1==a.post_no?'<ul class="p_reply"><li><a href="#" class="p_reply_first">\u56DE\u590D</a></li></ul>':["<div class=\"j_lzl_r p_reply\" data-field=\"{'pid':'"+a.post_id+"','total_num':'"+a.comment_num+"'}\">",'<a href="#" class="lzl_link_unfold" style="display:'+(a.comment_num>0&&1!=a.is_fold&&2!=a.is_fold?"none":"")+';">\u56DE\u590D',a.comment_num>0?"("+a.comment_num+")":"","</a>",'<span class="lzl_link_fold" style="display:'+(a.comment_num>0&&1!=a.is_fold&&2!=a.is_fold?"":"none")+'">\u6536\u8D77\u56DE\u590D</span>',"</div>"].join(""),i+='<ul class="p_tail">'+this.showFloorNumAndDate(a)+"</ul>",s=this.isTpoint(a.pb_tpoint)&&7===+a.pb_tpoint.tp_type?this.getJubaoHtml(a,t,1):this.isTpoint(a.pb_tpoint)?this.getUninterest(a.pb_tpoint.template_id):this.getJubaoHtml(a,t,1),i+=['<ul class="p_mtail">',s,this.showTail(a),this.loadAdmin(a,t),"</ul>"].join(""),(this.power.can_op_as_4thmgr||this.power.can_op_as_operator)&&(i+='<ul class="p_print_flower"><li data-uid="'+t.user_id+'" data-pid="'+a.post_id+'" class="print_reward j_print_reward">\u5370\u82B1\u5956\u52B1 <span class="print_seperator">|</span></li></ul>'),i+='<ul class="p_props_tail props_appraise_wrap">',i+=this.propsapi.showUIHtml({props:a.props||{},post_id:a.post_id}),i+="</ul>",i+=this.showMallTail(a),i+="</div>"},showFloorNumAndDate:function(a){var t=a.post_no+"\u697C",s="";return s+="1"==this.thread.thread_type?'<li class="lzl_time">'+t+"</li>":"<li><span>"+t+"</span></li>",s+="<li><span>"+a.date+"</span></li>"},getJubaoHtml:function(a,t){var s="",i=this.thread,l=this.power,p=this.user;if(!(1==i.thread_type&&1==a.post_no||(l.can_mask_delete||l.lz_del)&&1!=a.post_no)){var e=l.can_vip_jubao?"vip\u4E3E\u62A5":"\u4E3E\u62A5";if(p.user_id!=t.user_id||a.is_anonym){{"window.open('http://tieba.baidu.com/complaint/info?type={type}&cid=0&tid="+i.thread_id+"&pid="+a.post_id+"','newwindow', 'height=900, width=800, toolbar =no, menubar=no, scrollbars=yes, resizable=yes, location=no, status=no');return false;"}s='<li class="j_jb_ele complaint"></li>'}else{var n="{'delete_mine':'1','index':'2','user_name':'"+t.user_name+"'}";e="\u5220\u9664",s='<li class="j_jb_ele"><a href="#" data-field='+n+' class="jb_in p_post_del_my post_del_href" data-checkun="un">'+e+"</a>&nbsp;|</li>"}}return s},getUninterest:function(a){var t="{'template_id': "+a+"}",s='<li><span class="j-pb-tpoint" data-field="'+t+'" style="cursor: pointer">\u4E0D\u611F\u5174\u8DA3\u5E76\u9690\u85CF</span>&nbsp;|</li>';return s},showTail:function(a){var t=a.open_id,s=a.open_type,i=this.tailList,l={1:"1",4:"1",5:"1",6:"1",youliao:"1"};"wap"!==t||l.openType||"sharexc"==s||"webipad"==s||(s="phone");var p=t+"_"+s,e=i[p]?i[p]:[],n=e[0],_=e[1],o=e[2],r="";return n&&(r="xiangce"===s?'<li><span class="p_tail_txt">\u901A\u8FC7</span><a class="p_tail_wap" data-tip="'+o+'" href="'+_+'" target="_blank">'+n+'</a><span class="p_tail_txt">\u4E0A\u4F20</span></li>':"shenqi"===s?'<li><span class="p_tail_txt">\u901A\u8FC7</span><a class="p_tail_wap" data-tip="'+o+'" href="'+_+'" target="_blank">'+n+'</a><span class="p_tail_txt">\u4E0A\u4F20</span></li>':_&&o?'<li><span class="p_tail_txt">\u6765\u81EA</span><span class="tip_bubble_con"></span><a data-tip="'+o+'" class="p_tail_wap" href="'+_+'" target="_blank">'+n+"</a></li>":_?'<li><span class="p_tail_txt">\u6765\u81EA</span><a class="p_tail_wap" data-tip="'+o+'" href="'+_+'" target="_blank">'+n+"</a></li>":o?'<li><span class="p_tail_txt"></span><span class="tip_bubble_con"></span><a data-tip="'+o+'" class="p_tail_font"  >\u672C\u697C\u542B\u6709'+n+"</a></li>":'<li><span class="p_tail_txt">\u6765\u81EA</span>'+n+"</li>"),r},loadAdmin:function(a,t){var s=this.power,i=this.user,l="",p="&nbsp;|",s=this.power,i=this.user,e=!1;for(var n in i.new_iconinfo)"net_police"===i.new_iconinfo[n].name&&(e=!0);return(s.can_type2_audit_post||s.lz_del)&&this.isTpoint(a.pb_tpoint)?"":(a.is_anonym&&s.can_filter_ip&&!e?l+='<li><a class="p_post_ban_anonym" href="#">\u5C01</a>'+p+"</li>":s.can_filter_id&&!e&&(l+='<li><a class="p_post_ban" href="#">\u5C01</a>'+p+"</li>"),1!=a.post_no&&(s.can_mask_delete||s.lz_del&&!i.forbidden.isForbid&&!i.is_black)&&(l+=e?'<li><a class="p_post_del" href="#">\u7F51\u8B66\u4E3E\u62A5</a>'+p+"</li>":'<li><a class="p_post_del" href="#">\u5220\u9664</a>'+p+"</li>"),s.can_super&&!a.is_anonym&&(l+='<li><a class="p_tieba_manage" href="/f?ct=503316480&cm=6000&tn=bdUserManager&un='+encodeURIComponent(t.user_name)+'" target="_blank">\u8D34\u5427\u7BA1\u7406</a>&nbsp;|</li>'),l)},showMallTail:function(a){var t="",s={1019001:"1",1019002:"1",1019003:"1",1049001:"1",1049002:"1",1049003:"1"};return(a.is_bub||a.ptype&&7==a.ptype.length&&!s[a.ptype])&&(t='<a href="/tbmall/home" class="p_mall_tail" target="_blank"></a>'),t},isTpoint:function(a){return a&&1===a.is_tpoint}}});
;_.Module.define({path:"ppb/widget/postList/Lzl",requires:["ppb/widget/Admin","puser/widget/Icons"],sub:{editor_entry:null,_reach_limit:!1,_new_reply_num:0,initial:function(t){Page.checkLoadedModules("lzlHasLoad")||(this.postJdom=t,this.wapperDOM=$("#j_p_postlist"),this.icons=this.use("puser/widget/Icons"),this._admin=this.use("ppb/widget/Admin"),this._init())},_init:function(){this._showJubao(),this._bindEditorEntry(),this._bindFoldClick(),this._bindClick()},_showLzlJubao:function(t){if(!PageData.power.can_mask_delete&&!PageData.power.lz_del){var i,i=(PageData.power.can_vip_jubao?"vip\u4E3E\u62A5":"\u4E3E\u62A5",t.find("li.j_lzl_s_p"));i.each(function(){var t=$(this).find("a").filter(function(){return $(this).tbattr("username")}).tbattr("username"),i="";if(PageData.user.user_name==t)var e="\u5220\u9664",i="{'delete_mine': 1, 'user_name' : '"+t+"'}",l='<a href="#" class="lzl_jb_in" data-field="'+i+'">'+e+"</a>&nbsp;|&nbsp;";else{var a=$(this).data("field");if(a)var e=PageData.power.can_vip_jubao?"vip\u4E3E\u62A5":"\u4E3E\u62A5",l='<a href="###" class="user-jubao-button">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </a>';else l=""}$(this).find(".lzl_jb").html(l)})}},_bindFoldClick:function(){var t=this;this.wapperDOM.delegate(".lzl_link_unfold","click",function(i){var e=i.srcElement||i.target;return PageData.user.is_login?(t._loadLzlContent($(e)),t._unfoldLzl($(e)),$.stats.track("showlzl","pbfold","pb_lzl","CLICK")):TbCom.process("User","buildLoginFrame",null,null,null,"lzl_reply"),!1}).delegate(".lzl_link_fold","click",function(i){var e=i.srcElement||i.target;t._foldLzl($(e)),$.stats.track("hidelzl","pbfold","pb_lzl","CLICK")})},_loadLzlContent:function(t){var i=t.parents(".l_post");LzlEditor.cur_optdom.postJdom=i;i.find(".j_lazy_lzl");LzlEditor.cur_optdom.jdom=i.find(".j_lzl_wrapper"),LzlEditor.cur_optdom.mainDom=LzlEditor.cur_optdom.jdom.find("div.j_lzl_container"),LzlEditor.cur_optdom.tailDom=LzlEditor.cur_optdom.jdom.find("div.j_lzl_r"),LzlEditor.cur_optdom.mainData=LzlEditor.cur_optdom.mainDom.getData(),LzlEditor.cur_optdom.tailData=LzlEditor.cur_optdom.tailDom.getData(),AntiAnswerLzl=new CaptchaReqCom({forumName:PageData.forum.name_url,forumId:PageData.forum.forum_id,tid:PageData.thread.thread_id,postType:"reply"})},_updateReplyNum:function(t){var i=0;if(t)i=t;else{this._new_reply_num++;var i=1*this.tailData.total_num+this._new_reply_num}this.tailDom.find("a.lzl_link_unfold").html("\u56DE\u590D("+i+")")},_foldLzl:function(t){var i=t.parents(".l_post").find(".j_lzl_container");if(LzlEditor.cur_sec){var e=LzlEditor.cur_sec;e.find("span.close").click(),LzlEditor._s_p._ie6RelativeHack()}i.slideUp("normal",function(){t.hide(),t.parent().find("a.lzl_link_unfold").show(),$(document).trigger("sub_list_reply_toggled")})},_unfoldLzl:function(t){var i=this;if(i.target=t,t.hide(),t.parent().find("span.lzl_link_fold").show(),LzlEditor._lzl&&LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid){var e="";LzlEditor._s_p._se&&(e=LzlEditor._s_p._se.getContent()),LzlEditor._lzl=null,LzlEditor._hide(),LzlEditor.cur_sec.empty(),LzlEditor.init(i),LzlEditor._s_p._se&&LzlEditor._s_p._se.ready(function(){LzlEditor._s_p._se.execCommand("inserthtml",e)}),LzlEditor._s_p._ie6RelativeHack(),CaptchaLzl&&!CaptchaLzl.needUpdate&&CaptchaLzl.reload(),LzlEditor.cur_sec.parent().show(),i.mainDom.slideDown("normal",function(){LzlEditor._s_p._ie6RelativeRecover(),$(document).trigger("sub_list_reply_toggled")})}else LzlEditor.init(i),LzlEditor._s_p._ie6RelativeHack(),LzlEditor.cur_sec.parent().show(),i.mainDom.slideDown("normal",function(){LzlEditor._s_p._ie6RelativeRecover(),$(document).trigger("sub_list_reply_toggled")});$.stats.sendRequest("fr=tb0_forum&st_type=lzl_unfold")},_showJubao:function(){this.wapperDOM.delegate(".j_lzl_s_p","mouseover",function(){$(this).find(".lzl_jb").show()}).delegate(".j_lzl_s_p","mouseout",function(){$(this).find(".lzl_jb").hide()})},asyncImage:function(t,i){var e=t.find("img."+i);return 0==e.length?!1:void $.each(e,function(t,i){i.src=i.getAttribute("data-passive")||i.getAttribute("src")})},_bindClick:function(){var t=this;this.wapperDOM.delegate(".j_lzl_m","click",function(){if(PageData.user.is_login){var i=$(this).parents(".j_lzl_m_w");return t.asyncImage($("#"+$(this).tbattr("lzlid")),"forasync"),i.find(".lzl_post_hidden").slideDown("normal",function(){$(document).trigger("sub_list_reply_toggled")}),i.find(".j_pager").show(),i.find(".lzl_more").hide(),$.stats.sendRequest("fr=tb0_forum&st_type=lzl_more"),!1}return _.Module.use("pcommon/widget/LoginDialog",["","userbar"]),!1}).delegate(".lzl_s_r","click",function(i){var e=i.target||i.srcElement;return PageData.user.is_login?(t._loadLzlContent($(e)),t._fastReply($(e))):TbCom.process("User","buildLoginFrame",null,null,null,"lzl_interact"),!1}).delegate(".j_pager","click",function(i){if("A"==i.target.tagName){window.global&&"function"==typeof window.global.shieldPost&&window.global.shieldPost();var e=$(i.target),l=$.tb.unescapeHTML(e.tbattr("index"));if(!l){var a=$.tb.unescapeHTML(e.tbattr("href")).split("#");l=parseInt(a[1])}return t.mainDom=e.parents(".j_lzl_container"),t.mainData=t.mainDom.getData(),t.postJdom=e.parents(".l_post"),t._turnPage(t,l,e.parents(".core_reply_content")),!1}})},_bindEditorEntry:function(){var t=this;t.wapperDOM.delegate(".j_lzl_p","click",function(){return t.editor_entry=$(this),PageData.user.is_login?(LzlEditor._lzl&&LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid&&"none"!=LzlEditor.cur_sec.css("display")?LzlEditor._s_p._getHtml()?LzlEditor._s_p._se.setContent(""):LzlEditor._hide():(t._loadLzlContent($(this)),LzlEditor.init(t)),!1):(TbCom.process("User","buildLoginFrame",null,null,null,"too_reply"),!1)})},_fastReply:function(t){var i,e=t.parents(".j_lzl_s_p"),l=e.getData();i=l.user_nickname?l.user_nickname:l.user_name;var a="\u56DE\u590D&nbsp;"+i+"&nbsp;:";LzlEditor._lzl&&LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid?LzlEditor._s_p._se?(LzlEditor._s_p._se.$body.html(""),LzlEditor._show(),LzlEditor._s_p._se.execCommand("inserthtml",a)):window.LzlEditor._s_p._fe&&window.LzlEditor._show():(LzlEditor.init(this),LzlEditor._s_p._se&&LzlEditor._s_p._se.execCommand("inserthtml",a)),LzlEditor._s_p._setData(l)},_turnPage:function(t,i,e){var l=new Date;l=l.getTime(),$.ajax({url:"/p/comment",data:{tid:PageData.thread.thread_id,pid:t.mainData.pid,pn:i,t:l},dataType:"html",success:function(i){t._ajaxSucc(i,e),$.tb.location.setHash("noExistHash"),$.tb.location.setHash(t.mainData.pid+"l")},error:function(i){t._ajaxErr(i)}})},_ajaxSucc:function(t,i){var e=this;if(t&&t.length>200){var l=$(t);l.find(".voice_player .time").each(function(){$(window).trigger("initvoicelength",this)}),l.find(".voice_player_desc").remove(),this.mainDom.find("ul.j_lzl_m_w").html(l),e._showLzlJubao(i),this._admin.loadLzlAdmin(i),l.find(".lzl_cnt").each(function(){var t=$(this),i=t.getData().iconArr,l=t.getData().free_flag,a=i?e.icons.getPreIconHtml(i,l):"";t.prepend(a)}),$.browser.msie&&$.browser.version<=7&&this.postJdom.tbattr("class",$.tb.unescapeHTML(this.postJdom.tbattr("class")))}else{var a='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;\u5B8B\u4F53&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;\u9ED1\u4F53&quot;;">\u670D\u52A1\u5668\u5F88\u5FD9</td></tr></tbody></table>\u8BF7\u5237\u65B0\u9875\u9762\uFF0C\u7A0D\u540E\u518D\u8BD5</div>',n=$.dialog.alert(a,{width:410,height:95,title:"\u9519\u8BEF\u63D0\u793A"});n.bind("onclose",function(){return!0})}},_ajaxErr:function(){var t='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;\u5B8B\u4F53&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;\u9ED1\u4F53&quot;;">\u670D\u52A1\u5668\u5F88\u5FD9</td></tr></tbody></table>\u8BF7\u5237\u65B0\u9875\u9762\uFF0C\u7A0D\u540E\u518D\u8BD5</div>',i=$.dialog.alert(t,{width:410,height:95,title:"\u9519\u8BEF\u63D0\u793A"});i.bind("onclose",function(){return!0})}}});
;var LzlEditor={_lzl:null,default_options:{autoFocus:!0,autoEnable:!0,height:"40px",width:"527px",maxHeight:"40",wrapperClassName:"lzl_simple_wrapper",enableRefer:!0},options:{},cur_sec:null,cur_optdom:{},_s_p:null,init:function(i,l){LzlEditor.options={},$.extend(LzlEditor.options,LzlEditor.default_options),l&&$.extend(LzlEditor.options,l),LzlEditor._buildEditor(i)},_buildEditor:function(i){if(LzlEditor._lzl){if(LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid)return LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").length>0&&1==$.tb.Storage.get("VoicePostorAdClosed")&&LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").remove(),LzlEditor.cur_sec.show(),LzlEditor._s_p._se&&LzlEditor._s_p._se.focus(),!1;var l=LzlEditor.cur_sec;l.find("span.close").click();var t=l.find(".tb-editor-editarea");t[0]&&t.html().length>0&&l.bindData({txt:t.html()}),LzlEditor._hide(),LzlEditor.cur_sec.empty(),LzlEditor._s_p=null;var o=LzlEditor._lzl.mainDom.find("li.j_lzl_s_p");0==o.length&&(LzlEditor._lzl.tailDom.find(".lzl_link_fold").hide(),LzlEditor._lzl.tailDom.find(".lzl_link_unfold").show(),LzlEditor._lzl.mainDom.hide())}LzlEditor._lzl=i,$.extend(LzlEditor._lzl,LzlEditor.cur_optdom);var l=i.jdom.find("div.j_lzl_e_c"),e=PageData.thread.topic;LzlEditor.cur_sec=l;var r=$.extend({container:l[0],uid:PageData.user.user_id},LzlEditor.options);LzlEditor._lzl._reach_limit=LzlEditor._limitCheck()||LzlEditor._lzl._reach_limit?!0:!1;var d={_can_post:PageData.power.can_post,_forum_type:PageData.forum_type,_no_un:PageData.user.no_un,_is_block:PageData.user.forbidden.isForbid?!0:!1,_reach_limit:LzlEditor._lzl._reach_limit,_login:PageData.user.is_login,_thread_topic_type:e.is_topic?"1":"0",_thread_topic_subtype:e.is_topic&&"2"==e.topic_type?"3":"0",data:LzlEditor._lzl.mainData,tpl_id:"j_simpleeditor_tpl"};_.Module.use("pcommon/widget/SimplePoster",{op:d,edOp:r},function(i){i.bind("toTop",function(){$(window).scrollTop(0)},!0),i.bind("onsuccess",function(){LzlPostor._appendNew()},!0),i.bind("onclose",function(){LzlEditor._lzl._updateReplyNum(2e4),LzlEditor._lzl._reach_limit=!0,LzlEditor.init(LzlEditor._lzl)},!0),i.bind("hide",function(){LzlEditor._hide()},!0),LzlEditor._s_p=i});var n=l.getData();if(null!=n){var t=l.find(".tb-editor-editarea");t.html(n.txt)}LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").length>0&&1==$.tb.Storage.get("VoicePostorAdClosed")&&LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").remove(),l.show(),l.parent().find("input.j_lzl_e_f_h").show().focus().hide()},_limitCheck:function(){var i=!1,l=LzlEditor._lzl.jdom.find("li.j_lzl_l_p");if(0==l.length)return i;var t=l.getData();return t.total_num>=2e4&&(i=!0),i},_hide:function(){LzlEditor.cur_sec&&(LzlEditor.cur_sec.find("span.close").click(),LzlEditor.cur_sec.hide()),LzlEditor._lzl&&LzlEditor._lzl.editor_entry&&LzlEditor._lzl.editor_entry.show()},_show:function(){LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").length>0&&1==$.tb.Storage.get("VoicePostorAdClosed")&&LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").remove(),LzlEditor.cur_sec&&LzlEditor.cur_sec.show()}};
;var LzlPostor={_appendNew:function(){var e=LzlEditor._lzl.jdom.find("ul.j_lzl_m_w");if(0==e.length){var a=LzlEditor._lzl.jdom.find("div.j_lzl_c_b_a");a.prepend($('<div class="lzl_big_splitline"></div>')),e=$('<ul class="j_lzl_m_w"></ul>'),a.prepend(e)}e.show();var t=$('<li class="lzl_single_post j_lzl_s_p"></li>');t.bindData({user_name:PageData.user.user_name,user_nickname:PageData.user.user_nickname});var r=$.tb.dataField({un:PageData.user.user_name,id:PageData.user.portrait}),i=' username="'+PageData.user.user_name+'"'+r,l="/home/main/?un="+encodeURIComponent(PageData.user.user_name)+"&fr=pb&ie=utf-8&id="+PageData.user.portrait,s="";s+='<div class="lzl_p_p">',s+='  <a class="j_user_card" href="'+l+'" '+i+'><img src="http://tb.himg.baidu.com/sys/portrait/item/'+PageData.user.portrait+'" style="visibility:hidden;" onload="Page.resizePic(this, 32, 32, true);"/></a>',s+="</div>",s+='<div class="lzl_cnt">',_.Module.use("puser/widget/Icons",null,function(e){s+=e.getPreIconHtml(window.PageData.user.mParr_props,window.PageData.user)});var n=$.tb.transforEmoji(null,LzlEditor._s_p._getHtml()),u=$.tb.transforEmoji(PageData.user.user_name,PageData.user.user_nickname,!0);s+='  <a class="at j_user_card" href="'+l+'" '+i+">"+u+"</a>",s+="1"==PageData.user.is_verify?'<img style="vertical-align: middle;margin-top: -3px;" src="http://tb2.bdstatic.com/tb/img/itieba_vip.gif" title="\u8D34\u5427\u5B98\u65B9\u8BA4\u8BC1" width="11" height="18" class="verified_icon">':"",s+='   :<span class="lzl_content_main">',s+=n,s+="    </span>",s+='  <div class="lzl_content_reply">',s+='    <span class="lzl_time">'+LzlPostor.getCurrentTime()+"</span>",s+='    <a href="#" class="lzl_s_r">\u56DE\u590D</a>',s+="  </div>",s+="</div>",t.html(s),t.insertBefore(e.find("li.j_lzl_l_p")),LzlEditor._lzl._updateReplyNum()},getCurrentTime:function(){function e(e){return 10>1*e?"0"+e:e}var a=new Date,t="";return t+=a.getFullYear()+"-",t+=a.getMonth()+1+"-",t+=a.getDate()+"&nbsp;",t+=e(a.getHours())+":",t+=e(a.getMinutes())}},AntiAnswerLzl,CaptchaLzl;
;_.Module.define({path:"ppb/widget/sub_list/subListTotal",requires:["puser/widget/pbUserBase","puser/widget/Icons","ppb/widget/sub_list/postTail","pcommon/component/JsPager"],sub:{initial:function(e){this._isAdThread=e.isAdThread,this._searchCid=e.searchCid,this._searchPid=e.searchPid,this._userList=e.userList,this._tailList=e.tailList,this._commentList=e.commentList,this._icons=this.use("puser/widget/Icons"),this._user=this.use("puser/widget/pbUserBase"),this._postTail=this.use("ppb/widget/sub_list/postTail",{tailList:e.tailList})},showLzlPost:function(e){var t=this,e=$(e),s=e.closest(".l_post").getData();e.html(t._getAnchor(s.content)+t._postTail.getPostTailTpl(s.content,s.author)+t._getSubContent(s.content)),e.removeAttr("style").find(".voice_player .time").each(function(){$(window).trigger("initvoicelength",this)})},_getAnchor:function(){var e="";return this._isAdThread&&(e+='<a href="http://yingxiao.baidu.com/zhuanti/103.html?id=13" class="d_tuiguang" target="_blank"></a>'),e},_getSubContent:function(e){var t=e.comment_num>0&&1!=e.is_fold&&2!=e.is_fold?"":"none",s=e.comment_num>0?"":"none";e.page={total_page:Math.floor((e.comment_num-1)/10)+1,cur_page:1};var i=["<div class=\"j_lzl_container core_reply_wrapper\" data-field=\"{'pid':'"+e.post_id+"','floor_num':'"+e.post_no+'\'}" style="display:'+t+'">','<div class="core_reply_border_top"></div>','<div class="j_lzl_c_b_a core_reply_content">','<ul class="j_lzl_m_w" style="display:'+s+'">',this._getSubPostList(e),"</ul>",'<div class="lzl_editor_container j_lzl_e_c lzl_editor_container_s" style="display:none;"></div>','<input type="text" class="j_lzl_e_f_h" style="display:none;" />',"</div>",'<div class="core_reply_border_bottom"></div>',"</div>"].join("");return i},_getSubPostList:function(e){for(var t,s,i="",n=this._commentList[e.post_id],a="",l="",_=0;_<n.length;_++)t=n[_],s=this._userList[t.user_id]||{},5==_&&(l="lzl_hidden_"+e.post_index,a+='<ul class="lzl_post_hidden" id="'+l+'">',i=!0),t.content=$.tb.transforEmoji(null,t.content),s.nickname=s.nickname?s.nickname:s.user_name,a+=['<li class="lzl_single_post j_lzl_s_p '+(0===_?"first_no_border":"")+"\" data-field=\"{'pid':'"+e.post_id+"','spid':'"+t.comment_id+"','user_name':'"+s.user_name+"','portrait':'"+s.portrait+"','user_nickname':'"+s.nickname+"'}\" >",this._user.face_link(s),'<div class="lzl_cnt">',this._icons.getPreIconHtml(s.mParr_props,s),this._user.name_link(s),"1"===s.is_verify||"1"===s.is_official?'<img style="vertical-align: middle;margin-top: -3px;" src="http://tb2.bdstatic.com/tb/img/itieba_vip.gif" title="\u8D34\u5427\u5B9E\u540D\u8BA4\u8BC1" width="11" height="18" class="verified_icon" />':"",':&nbsp;<span class="lzl_content_main" data-username="'+t.user_name+'">',this._searchCid==t.comment_id?"<b>"+t.content+"</b>":t.content,this._getVoiceHtml(t),"</span>",this._getReplyHtml(t,s),"</div>","</li>"].join("");return a+=i?"</ul>":"",a+=this._getLzlPager(e,l),delete this._commentList[e.post_id],a},_getLzlPager:function(e,t){var s='<li class="lzl_li_pager j_lzl_l_p lzl_li_pager_s" data-field="{total_num:'+e.comment_num+",total_page:"+e.page.total_page+'}" >';return s+='<a class="j_lzl_p btn-sub btn-small pull-right" href="##"><i class="icon-reply"></i>\u6211\u4E5F\u8BF4\u4E00\u53E5</a>',e.comment_num>5?(s+='<p class="lzl_more">',s+="<span>\u8FD8\u6709"+(e.comment_num-5)+"\u6761\u56DE\u590D\uFF0C</span>",s+='<a href="#" class="j_lzl_m" lzlid="'+(t?t:"")+'">\u70B9\u51FB\u67E5\u770B</a>',s+="</p>",s+='<p class="j_pager l_pager pager_theme_2 lzl_pager" style="display:none">',e.comment_num>10?(this._pager=this.use("pcommon/component/JsPager",{current:1,total:e.page.total_page,mode:1,url:"#",isHtml:!0,classname:{current:"tP"}}),s+=this._pager._render()):s+="&nbsp",s+="</p>"):s+="<p>&nbsp;</p>",s+="</li>"},_getForbiddenTip:function(e){var t="";return e.exist_forbidden_tip&&(t='<p class="lzl_thread_forbidden_tip j_lzl_thread_forbidden_tip" >\u672C\u697C\u5305\u542B\u90E8\u5206\u5E7F\u544A\u7B49\u8FDD\u89C4\u5185\u5BB9\u7684\u56DE\u590D\uFF0C\u5DF2\u7ECF\u88AB\u5C4F\u853D\uFF0C\u6682\u4E0D\u53EF\u89C1\u3002<span class="lzl_forbidden_tip_close j_lzl_forbidden_tip_close">x</span></p>'),t},_getVoiceHtml:function(e){var t,s,i="";return 1===+e.ptype&&(t=e.during_time?Math.floor(e.during_time/60):"0",s=e.during_time?e.during_time%60:"0",i=['<br/><div class="voice_player voice_player_mini voice_player_lzl">','<a href="#" class="voice_player_inner">','<span class="before">&nbsp;</span><span class="middle"><span class="speaker speaker_animate">&nbsp;</span>','<span class="time">',t>0?'<span class="minute">'+t+"</span>&#039;":"",s>0||t>0?'<span class="second">'+s+"</span>&quot;":"","</span>","</span>",'<span class="after">&nbsp;</span>',"</a>","</div>"].join("")),i},_getReplyHtml:function(e,t){var s="",i=PageData.power,n=PageData.user;return s+='<div class="lzl_content_reply"><span class="lzl_jb"  style="display:none">',i.can_mask_delete||i.lz_del||(s+=t.user_name==n.user_name?"<a href=\"#\" data-field=\"{'delete_mine':'1','user_name':'"+t.user_name+'\'}" class="lzl_jb_in" >\u5220\u9664</a>&nbsp;|':'<a href="###" class="user-jubao-button">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </a>'),s+='</span><span class="lzl_op_list j_lzl_o_l">',s+=this._loadLzlAdmin(t,i,n),s+='</span><span class="lzl_time">'+this._getTime(e.now_time)+'</span><a href="#" class="lzl_s_r">\u56DE\u590D</a>',s+="</div>"},_loadLzlAdmin:function(e,t,s){var i="",n="&nbsp;|&nbsp;",a=!1;for(var l in s.new_iconinfo)"net_police"===s.new_iconinfo[l].name&&(a=!0);return!t.can_filter_ip&&!t.can_filter_id||a||(i+='<a href="#" class="j_lzl_ban">\u5C01</a>'+n),(t.can_mask_delete||t.lz_del&&!s.forbidden.isForbid&&!s.is_black)&&(i+=a?'<a href="#" class="j_lzl_del">\u7F51\u8B66\u4E3E\u62A5</a>'+n:'<a href="#" class="j_lzl_del">\u5220\u9664</a>'+n),t.can_super&&(i+='<a href="/f?ct=503316480&cm=6000&tn=bdUserManager&un="'+e.user_name+' class="j_lzl_manage p_tieba_manage" target="_blank">\u8D34\u5427\u7BA1\u7406</a>'+n),i},_getTime:function(e){function t(e){return 10>1*e?"0"+e:e}var s;s=void 0==e?new Date:new Date(1e3*e);var i="";return i+=s.getFullYear()+"-",i+=s.getMonth()+1+"-",i+=s.getDate()+"&nbsp;",i+=t(s.getHours())+":",i+=t(s.getMinutes())}}});_.Module.define({path:"common/widget/Card",requires:[],sub:{_option:{},_j_card:null,_open_timer:null,_close_timer:null,_is_show:!1,_is_first_show:!0,_default_option:{content:"",arrow_dir:"down",arrow_pos:{},card_css:{width:170,"z-index":1001},arrow_req:!0,auto_positon:!1,event_target:null,offset:{x:0,y:0},card_leave_display:!1,card_hover_show:!0,card_leave_hide:!1,attr:"",clazz:"",wrap:$("body")},initial:function(t){var i=this;i._option=$.extend(!0,{},i._default_option,t),this._buildCard()},_buildCard:function(){var t=this._option,i=this._genericTpl(),e=t.wrap;this._j_card=$(i),this._j_card.find(".j_content").html(t.content),e.append(this._j_card),delete t.card_css.height,this._j_card.css(t.card_css),t.card_css.height=this._j_card.find(".j_content").outerHeight(!0),this._arrow=this._j_card.find(".j_ui_white_arrow"),void 0===t.arrow_pos.left&&(this._arrow_left=t.card_css.width/2-10,this._arrow.css({left:this._arrow_left})),this._arrow.css(t.arrow_pos),t.arrow_req||this._j_card.find(".j_ui_white_arrow").hide(),t.auto_positon&&this._autoPosition()},_autoPosition:function(){var t=this._option,i={},e=$(window).height(),_=$(window).width(),o=($(document).scrollLeft(),$(document).scrollTop()),r=(t.event_target.innerWidth(),t.event_target.innerHeight()),s="",a={x:t.event_target.offset().left-t.card_css.width/2+t.event_target.outerWidth(!0)/2,y:t.event_target.offset().top-t.card_css.height-10,width:this._j_card.innerWidth(),height:this._j_card.innerHeight()+this._arrow.innerHeight()};i.left=a.x,i.top=a.y;var n=t.arrow_pos.left||this._arrow_left,d=15,h=_;_<$(document).width()&&(h=$(document).width());var c=h-(t.card_css.width+d);i.left<d?(n+=i.left-d,i.left=d):i.left>c&&(n+=i.left-c,i.left=c),i.top<o?(s="up",i.top+=r+(a.height||0),i.top-=t.offset.y):(i.top+=i.top+r>o+e?-r-(a.height||0):0,s="down",i.top+=t.offset.y),this._arrow.removeClass("ui_white_down").removeClass("ui_white_up").addClass("ui_white_"+s).css({left:n}),this._j_card.css(i)},_genericTpl:function(){var t=this._option.attr,i=this._option.arrow_dir,e=this._option.clazz,_=['<div class="ui_card_wrap '+e+'" '+t+' style="visibility: hidden">','<div class="j_content ui_card_content ">',"</div>",'<span class="j_ui_white_arrow arrow ui_white_'+i+'"></span>',"</div>"].join("");return _},showCard:function(t){var i=this;i._close_timer&&clearTimeout(i._close_timer),t&&"delayShow"==t.type?(i._open_timer&&clearTimeout(i._open_timer),i._open_timer=setTimeout(function(){i._showCardDo()},t.time)):i._showCardDo()},closeCard:function(t){var i=this;i._open_timer&&clearTimeout(i._open_timer),t&&"delayClose"==t.type?i._close_timer=setTimeout(function(){i._closeCardDo()},t.time):i._closeCardDo()},hideCard:function(t){var i=this;i._open_timer&&clearTimeout(i._open_timer),t&&"delayHide"==t.type?i._close_timer=setTimeout(function(){i._hideCardDo()},t.time):i._hideCardDo()},_showCardDo:function(){var t=this;t._is_first_show&&(this._j_card.bind("mouseenter",function(){t._option.card_hover_show&&(t._is_show=!0)}),this._j_card.bind("mouseleave",function(){return t._option.card_leave_display?!1:(t._is_show=!1,void(t._option.card_leave_hide?t.hideCard():t.closeCard()))}),t._is_first_show=!1),this._j_card.css({visibility:"visible"})},_closeCardDo:function(){var t=this;this._j_card&&!this._is_show&&t._j_card.remove()},_hideCardDo:function(){var t=this;this._j_card&&!this._is_show&&t._j_card.css({visibility:"hidden"})},setContent:function(t){var i=this._option;if(null!==this._j_card){var e=this._j_card.find(".j_content");e.html(t),i.card_css.height=e.outerHeight(!0),this._j_card.css({height:i.card_css.height}),i.auto_positon&&this._autoPosition()}}}});_.Module.define({path:"puser/widget/icon_tip",requires:["common/widget/Card"],sub:{_icon_tip:null,_icon_tip_ajax:null,_dialog:null,_iconData:{},_option:{width:300},initial:function(t){this.pageType=t.pageType,this.myIcons=t.myIcons,this.bindEvents()},bindEvents:function(){var t=this,i=$("body");i.find(".j_icon_slot").on("mouseenter",function(){t._icon_tip&&t._icon_tip.closeCard(),t.buildCard($(this))}).on("mouseleave",function(){t._icon_tip&&t._icon_tip.closeCard({type:"delayClose",time:200}),t._icon_tip=null}),i.on("click",".j_buy_icon_btn",function(i){i.preventDefault(),t.getOneIcon(t._iconData)}).on("click",".j_manage_icon_btn",function(){})},buildCard:function(t){var i=this;i._icon_tip&&(i._icon_tip.closeCard(),i._icon_tip=null);var n=t.getData();this._iconData=n;var a,e,o,r,c,l,_=_||1,s=50,p="http://tb1.bdstatic.com/tb/cms/com/icon/";if(n.sprite){if(a=n.sprite[n.value],!a)for(var u in n.sprite)if(n.sprite[u]&&(0!=n.value||"meizhi_level"==n.name)){a=n.sprite[u];break}e=a.split(","),o=e[0],r=e[1],l=p+n.category_id+"_36.png?stamp="+o,c='style="background: url('+l+") no-repeat -"+r*s+"px  -"+(_-1)*s+'px;"'}else c=t.css("background");var d=this.getIconTipHtml(n);if(!d)return!1;null==n.title&&(n.title=t.tbattr("title"));var b=['<div class="icon_tip_wrapper">','<div class="icon_tip_img" '+c+" />",'<div class="icon_tip_info">','<div class="icon_tip_title">'+n.title+(d.expired?d.expired:"")+"</div>",'<div class="icon_tip_intro">'+d.intro+"</div>",'<div class="icon_tip_btns">',d.btn,"</div>","</div>","</div>"].join(""),f={content:b,card_css:{width:i._option.width,zIndex:$.getcurzIndex()},auto_positon:!0,event_target:t,attr:"id='icon_tip'",wrap:$("body")};i._icon_tip=i.requireInstance("common/widget/Card",f),i._icon_tip.showCard({type:"delayShow",time:200})},getOneIcon:function(t){var i=this,n=t.name;if(n){var a=$.dialog.confirm("\u786E\u5B9A\u8D2D\u4E70\u3010"+t.title+"\u3011\u5370\u8BB0\u561B\uFF1F\u5C06\u6D88\u8017\u60A8"+t.price+"T\u8C46",{title:"\u8D2D\u4E70\u5370\u8BB0\u63D0\u793A",acceptValue:"\u786E\u5B9A",cancelValue:"\u53D6\u6D88"});a.bind("onaccept",function(t){t.stopImmediatePropagation();var a={ie:"utf-8"};a.tbs=PageData.tbs,a.icon_name=n,a.level=1,i._icon_tip_ajax&&i._icon_tip_ajax.abort(),i._icon_tip_ajax=$.ajax({type:"post",url:"/icon/buyIcon",data:a,dataType:"json"}).success(function(t){if(t&&0===t.no){var n=t.data;return n.icon_info?(i.showDialog("\u8D2D\u4E70\u6210\u529F"),void $.tb.location.reload()):void i.showDialog("\u8D2D\u4E70\u51FA\u9519\uFF0C\u8BF7\u67E5\u770B\u8D2D\u4E70\u8BB0\u5F55\u786E\u8BA4\u662F\u5426\u8D2D\u4E70\u6210\u529F")}i.showDialog(t&&2270028===t.no?"T\u8C46\u4E0D\u8DB3":"\u8D2D\u4E70\u51FA\u9519\uFF0C\u6CA1\u6709\u8D2D\u4E70\u6210\u529F")})}).bind("oncancel",function(){})}},getIconTipHtml:function(t){if(null==t.intro||null==t.intro_url)return!1;if(this.whetherIHaveTheIcon(t,this.myIcons))return{intro:"<p>"+t.intro+' <a target="_blank" href="'+t.intro_url+'">\u8BE6\u60C5\u300B</a></p>',btn:'<a class="btn_default btn_small " href="/home/main?id='+PageData.user.portrait+'" target="_blank" >\u7BA1\u7406\u5370\u8BB0</a>'};if(null!=t.price&&0!=t.price){var i='<p>\u4EF7\u683C:<i class="icon_tbean" style="vertical-align:middle;"></i><span class="orange_text " >'+t.price+'</span> <a target="_blank" href="'+t.intro_url+'">\u8BE6\u60C5\u300B</a></p>';return{intro:i,btn:'<a class="btn_default btn_small j_buy_icon_btn"  >\u8D2D\u4E70\u5370\u8BB0</a>'}}return{intro:"<p>"+t.intro+' <a target="_blank" href="'+t.intro_url+'">\u8BE6\u60C5\u300B</a></p>',btn:'<a class="btn_default btn_small" target="_blank" href="'+t.intro_url+'" >\u83B7\u53D6\u5370\u8BB0</a>'}},whetherIHaveTheIcon:function(t,i){var n,a;for(a in i)if(n=i[a],t.name==n)return!0;return!1},showDialog:function(t){this._dialog&&this._dialog.close(),this._dialog=null,this._dialog=new $.dialog({title:"\u5370\u8BB0\u63D0\u793A",html:t})},formateDate:function(t){var i=new Date(1e3*parseInt(t));return i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()}}});var bdShareTb=bdShareTb||{};bdShareTb._LogPool=bdShareTb._LogPool||[],bdShareTb.ApiPVLogger||!function(e){function n(e,n){var t=[];for(var o in n){var i=typeof n[o];"function"!=i&&"object"!=i&&n.hasOwnProperty(o)&&t.push(e+"_"+o+"="+n[o])}return t.join("&")}function t(){for(var e=bdShareTb._LogPool||[],n={},t=e.length-1;t>=0;t--){var o=e[t],i=n[o.key];i?(i.linkid=i.linkid||o.api.linkid,i.loadTime=o.api.loadTime||i.loadTime,i.type=(i.type||0)|(o.api.type||0)):n[o.key]=o.api}e=[];for(var d in n)n.hasOwnProperty(d)&&e.push({key:d,api:n[d]});return bdShareTb._LogPool=e,e}function o(){var e=bdShareTb._LogPool||[],o=e.length;if(o>0){e=t(),o=e.length;for(var i=[],d="",a=null,u=[0,0,0,0,0,0,0,0],l=0;o>l;l++)a=e[l],u[r[a.key]]=1,a.api.linkid&&(d=a.api.linkid,delete a.api.linkid),i.push(n(a.key,a.api));i.unshift("linkid="+d),i.unshift("apitype="+parseInt(u.reverse().join(""),2)),c(i.join("&"))}}function i(){l=!0,d.dom.ready(o)}var d,a=d={version:"1.5.2.2"};a.guid="$BAIDU$",a.$$=window[a.guid]=window[a.guid]||{global:{}},a.browser=a.browser||{},function(){var e=navigator.userAgent;a.browser.safari=/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)?+(RegExp.$1||RegExp.$2):void 0}(),a.browser.ie=a.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0,a.browser.opera=/opera(\/| )(\d+(\.\d+)?)(.+?(version\/(\d+(\.\d+)?)))?/i.test(navigator.userAgent)?+(RegExp.$6||RegExp.$2):void 0,a.dom=a.dom||{},function(){var e=a.dom.ready=function(){function e(){if(!e.isReady){e.isReady=!0;for(var n=0,t=d.length;t>n;n++)d[n]()}}function n(){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(n,1)}e()}function t(){if(!i)if(i=!0,"complete"===document.readyState)e.isReady=!0;else if(document.addEventListener)document.addEventListener("DOMContentLoaded",o,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",o),window.attachEvent("onload",e);var t=!1;try{t=null==window.frameElement}catch(d){}document.documentElement.doScroll&&t&&n()}}var o,i=!1,d=[];return document.addEventListener?o=function(){document.removeEventListener("DOMContentLoaded",o,!1),e()}:document.attachEvent&&(o=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",o),e())}),t(),function(n){e.isReady?n():d.push(n)}}();e.isReady=!1}(),d.undope=!0;var r={cite:0,img:1,addto:2,video:3},u=function(){var e=[];return function(n){var t="bdsharelog__"+(new Date).getTime(),o=e[t]=new Image;o.onload=o.onerror=function(){e[t]=null},o.src=n,o=null}}(),c=function(e){var n=/(\d+\-[a-zA-Z\d]+\-\d+\-\d+\-[a-f\d]+)/gi,t=(location.href.match(n)||"").toString(),o="http://nsclick.baidu.com/v.gif?pid=307&type=3071&sign="+t+"&desturl="+encodeURIComponent(document.referrer)+"&";u(o+e)},l=!1;e.ApiPVLogger={add:function(e,n){bdShareTb._LogPool.push({key:e,api:n})}},l||i()}(bdShareTb);
;var bdShareTb=bdShareTb||{};bdShareTb.ready=bdShareTb.ready||function(e,t){if(t=t||document,/complete/.test(t.readyState))e();else if(t.addEventListener)"interactive"==t.readyState?e():t.addEventListener("DOMContentLoaded",e,!1);else{var a=function(){a=new Function,e()};void function(){try{t.body.doScroll("left")}catch(e){return setTimeout(arguments.callee,10)}a()}(),t.attachEvent("onreadystatechange",function(){"complete"==t.readyState&&a()})}},bdShareTb.loadScript=bdShareTb.loadScript||function(e){var t=document.createElement("script");t.src=e,bdShareTb.ready(function(){document.getElementsByTagName("script")[0].parentNode.appendChild(t)})},bdShareTb.loadTime=+new Date;
;var bdShareTb=bdShareTb||{};!function(){var e=(new Date).getTime(),t=(new Date).getTime(),n=(new Date).getTime();if(document.getElementById("bdshare_tb")){var o=window,i=document,s=i.body,a=i.documentElement,r={},d="",l=i.title,c=[],p="",f={},h=i.getElementById("bdshare_tb").attributes.data,u=/MSIE 6.0/.test(navigator.userAgent),m="CSS1Compat"!=i.compatMode,h=h.nodeValue.replace(/&amp;/g,"&").split("&")||"";try{var b=o.location||i.location;r.href=b.href,r.search=b.search,r.hash=b.hash,r.protocol=b.protocol,r.hostname=b.hostname,r.pathname=b.pathname,d=encodeURIComponent(r.href)}catch(g){setTimeout(function(){var e=o.location||i.location;r.href=e.href,r.search=e.search,r.hash=e.hash,r.protocol=e.protocol,r.hostname=e.hostname,r.pathname=e.pathname,d=encodeURIComponent(r.href)},0)}for(var v=h.length;v--;){var y=h[v].split("=");c[y[0]]=y[1]}var w={bdPref:"bds_",bdBtns:c.btnArray?c.btnArray.split(","):[],bdEntranceLog:c.entrance||"",bdNums:c.mini?7:15,bdMini:c.mini||!1,bdType:c.type||"",bdLeft:c.pos||"right",bdTitle:"\u5206\u4EAB\u5230",bdText:c.text||l,weiboText:"",bdMore:"\u66F4\u591A...",bdPopTitle:"\u5206\u4EAB\u5230",bdImg:c.img||0,bdImgW:24,bdTop:0,bdIds:"bdshare",bdIdsl:c.mini&&"0"==c.mini?"bdshare_tb_l":"bdshare_tb_m",bdUid:c.uid||"",bdPic:c.bdPic||"",searchPic:c.searchPic||0,is_post_visible:c.is_post_visible||0,bdComment:"",bdDesc:"",wbUid:"",tongji:"on",review:"on",render:!0,snsKey:{},bdHost:"http://bdimg.share.baidu.com/static/",bdJump:"http://share.baidu.com/",bdApi:"http://api.share.baidu.com/",bdStatistics:"http://share.baidu.com/commit",bdCommit:"http://s.share.baidu.com/",bdMshare:"http://s.share.baidu.com/mshare",bdCout:"http://nsclick.baidu.com/v.gif?pid=307",bdWList:"([http|https]://[a-zA-Z0-9_.]+.baidu.com)",bdList:["mshare,\u4E00\u952E\u5206\u4EAB,mshare","qzone,QQ\u7A7A\u95F4,qqkj","tsina,\u65B0\u6D6A\u5FAE\u535A,xlwb","baidu,\u767E\u5EA6\u641C\u85CF,bdsc","renren,\u4EBA\u4EBA\u7F51,rrw","tqq,\u817E\u8BAF\u5FAE\u535A,txwb","bdxc,\u767E\u5EA6\u76F8\u518C,bdxc","kaixin001,\u5F00\u5FC3\u7F51,kxw","tqf,\u817E\u8BAF\u670B\u53CB,txpy","tieba,\u767E\u5EA6\u8D34\u5427,bdtb","douban,\u8C46\u74E3\u7F51,db","tsohu,\u641C\u72D0\u5FAE\u535A,shwb","bdhome,\u767E\u5EA6\u65B0\u9996\u9875,bdhome","sqq,QQ\u597D\u53CB,sqq","thx,\u548C\u8BAF\u5FAE\u535A,thx","qq,QQ\u6536\u85CF,qqsc","taobao,\u6211\u7684\u6DD8\u5B9D,tjh","hi,\u767E\u5EA6\u7A7A\u95F4,bdkj","msn,MSN,msn","sohu,\u641C\u72D0\u767D\u793E\u4F1A,shbsh","t163,\u7F51\u6613\u5FAE\u535A,wywb","qy,\u5947\u827A\u5947\u8C08,qyqt","meilishuo,\u7F8E\u4E3D\u8BF4,mls","mogujie,\u8611\u83C7\u8857,mgj","diandian,\u70B9\u70B9\u7F51,diandian","huaban,\u82B1\u74E3,huaban","leho,\u7231\u4E50\u6D3B,leho","share189,\u624B\u673A\u5FEB\u4F20,share189","duitang,\u5806\u7CD6,duitang","hx,\u548C\u8BAF,hexun","tfh,\u51E4\u51F0\u5FAE\u535A,fhwb","fx,\u98DE\u4FE1,feixin","youdao,\u6709\u9053\u4E91\u7B14\u8BB0,youdao","sdo,\u9EA6\u5E93\u8BB0\u4E8B,sdo","qingbiji,\u8F7B\u7B14\u8BB0,qingbiji","ifeng,\u51E4\u51F0\u5FEB\u535A,ifeng","people,\u4EBA\u6C11\u5FAE\u535A,people","xinhua,\u65B0\u534E\u5FAE\u535A,xinhua","ff,\u996D\u5426,fanfou","mail,\u90AE\u4EF6\u5206\u4EAB,mail","kanshou,\u641C\u72D0\u968F\u8EAB\u770B,kanshou","yaolan,\u6447\u7BEE\u7A7A\u95F4,yaolan","wealink,\u82E5\u90BB\u7F51,wealink","tuita,\u63A8\u4ED6,tuita","xg,\u9C9C\u679C,xianguo","ty,\u5929\u6DAF\u793E\u533A,tianya","fbook,Facebook,facebook","twi,Twitter,twitter","ms,Myspace,myspace","deli,delicious,delicious","s51,51\u6E38\u620F\u793E\u533A,51shequ","s139,139\u8BF4\u5BA2,shuoke","linkedin,linkedin,LinkedIn","copy,\u590D\u5236\u7F51\u5740,kaobei","print,\u6253\u5370,print"]}||{},_={_parseJson:function(e){e=e.replace(/^\s*{|}\s*$/g,"");for(var t=e.split(","),n={},o=0,i=t.length;i>o;o++){var s=t[o],a=s.indexOf(":");a>0&&(key=s.substring(0,a).replace(/^\s*[\'\"]?|[\"\']?\s*$/g,""),val=s.substring(a+1).replace(/^\s*[\'\"]?|[\"\']?\s*$/g,""),n[key]=val)}return n},_createScriptTag:function(e,t,n){e.setAttribute("type","text/javascript"),n&&e.setAttribute("charset",n),e.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(e)},_removeScriptTag:function(e){if(e.clearAttributes)e.clearAttributes();else for(var t in e)e.hasOwnProperty(t)&&"parentNode"!=t&&delete e[t];e&&e.parentNode&&e.parentNode.removeChild(e),e=null},callByBrowser:function(e,t,n){var o,i=document.createElement("SCRIPT"),s=0,a=n||{},r=a.charset,d=t||function(){},l=a.timeOut||0;i.onload=i.onreadystatechange=function(){if(!s){var e=i.readyState;if("undefined"==typeof e||"loaded"==e||"complete"==e){s=1;try{d(),clearTimeout(o)}finally{i.onload=i.onreadystatechange=null,_._removeScriptTag(i)}}}},l&&(o=setTimeout(function(){i.onload=i.onreadystatechange=null,_._removeScriptTag(i),a.onfailure&&a.onfailure()},l)),_._createScriptTag(i,e,r)},on:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},unon:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},html:function(e,t){var n=i.createElement(t||"div");for(var o in e)"style"==o?n[o].cssText=e[o]:n[o]=e[o];return"link"!=t?s.insertBefore(n,"iframe"==t?s.firstChild:p.nextSibling):void i.getElementsByTagName("head")[0].appendChild(n)},list:function(e){var t=w.bdPref,n=e.split(","),o=n[1],i="#",s=t+n[0]+" "+n[2];return{name:o,url:i,cls:s}},list_s:function(e){var t=[],n=inner="",o=w,i=o.bdList,s=o.bdBtns.length;if(more=o.bdNums<i.length?'<li><a href="#" class="bds_more">'+o.bdMore+"</a></li>":"",o.bdBtns.length<=0)for(s=o.bdNums;s--;)n=_.list(i[s]),t.push('<a href="'+n.url+'" class="'+n.cls+'">'+n.name+"</a>");else for(;s--;)o.bdBtns[s]<i.length&&(n=_.list(i[o.bdBtns[s]]),t.push('<a href="'+n.url+'" class="'+n.cls+'">'+n.name+"</a>"));if(inner='<iframe id="bdsTbIfr" style="position:absolute;display:none;z-index:9999;" frameborder="0"></iframe>',inner+='<div id="'+o.bdIdsl+'"><div id="'+o.bdIdsl+'_c"><h6>'+o.bdTitle+"</h6>",inner+="<ul><li>"+t.reverse().join("</li><li>")+"</li>"+more+'</ul><p><a href="#" class="goWebsite">\u767E\u5EA6\u5206\u4EAB</a></p></div></div>',!e)return inner;var a=_.html({id:"bdshare_tb_s",innerHTML:inner}),r=_.children(a);a=r[r.length-1],_.on(a,"mouseover",function(e){var e=e||window.event,t=e.target||e.srcElement,n=_.getPosition(t),o=e.relatedTarget||e.fromElement,i=_.getMousePos(e),s=i.x-n.l,r=i.y-n.t;t.buttontype=1,t.x=s,t.y=r,_.contains(a,o)||(a.time=+new Date)})},scroll:function(e,t){_.on(o,"scroll",function(){var n=_.getSize(),o=w,s=o.bdTop;"slide"==o.bdType&&(u||m?(_.setAttr(i.getElementById(o.bdIdsl),"display:block"),_bdS.style.top=n.t+(0==s?n.h/2-(i.getElementById(o.bdIdsl).offsetHeight-11)/2:parseInt(s,10))+"px"):0!=o.bdTop&&(_bdS.style.top=parseInt(o.bdTop,10)+"px")),"pop"==t&&(u||m)&&(e.style.top=n.t+n.h/2-e.offsetHeight/2+"px",_.setAttr(p,"top:"+e.style.top))})},getSize:function(){return{t:s.scrollTop||a.scrollTop,l:s.scrollLeft||a.scrollLeft,w:a.clientWidth||s.clientWidth,h:o.innerHeight||a.clientHeight||s.clientHeight}},getPosition:function(e){var t=_.getSize(),n=e,o={t:0,l:0},a=/gecko/.test(navigator.userAgent),r=function(e,t){o.t+=e,o.l+=t};if(n&&n!=s)if(n.getBoundingClientRect){var d=n.getBoundingClientRect(),l=e.ownerDocument,c=l.body,p=l.documentElement,f=p.clientTop||c.clientTop||0,h=p.clientLeft||c.clientLeft||0;if(d.top==d.bottom){var u=n.style.display;n.style.display="block",n.style.display=u}r(d.top+t.t-f,d.left+t.l-h)}else{for(var m=i.defaultView;n;){r(n.offsetTop,n.offsetLeft);var b=m.getComputedStyle(n,null);if(a){var g=parseInt(b.getPropertyValue("border-left-width"),10)||0,v=parseInt(b.getPropertyValue("border-top-width"),10)||0;r(v,g),n!=e&&"visible"!=b.getPropertyValue("overflow")&&r(v,g)}n=n.offsetParent}for(n=e.parentNode;n&&n!=s;)r(-n.scrollTop,-n.scrollLeft),n=n.parentNode}return o},setAttr:function(e,t){for(var n=t.split(";"),o=n.length;o--;)if(n[o]){var i=n[o].split(":");i&&(e.style[i[0]]=i[1])}},children:function(e){for(var t=[],n=e.firstChild;n;n=n.nextSibling)1==n.nodeType&&t.push(n);return t},generateRandom:function(e,t){for(var n=e.length,o="",i=1;t>=i;i++){var s=Math.floor(n*Math.random());o+=e.charAt(s)}return o},generateLinkid:function(){var e=(+new Date).toString(36),t=_.generateRandom("0123456789abcdefghijklmnopqrstuvwxyz",3);return e+t},contains:function(e,t){if(!t||!e)return!1;if(e==t)return!0;for(var n=t.parentNode;null!=n&&"undefind"!=typeof n.tagName;){if(n==e)return!0;n=n.parentNode}return!1},getMousePos:function(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:document.documentElement&&document.documentElement.scrollTop?{x:e.clientX+document.documentElement.scrollLeft-document.documentElement.clientLeft,y:e.clientY+document.documentElement.scrollTop-document.documentElement.clientTop}:document.body?{x:e.clientX+document.body.scrollLeft-document.body.clientLeft,y:e.clientY+document.body.scrollTop-document.body.clientTop}:void 0},_isCookieValidKey:function(e){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)},getCookieRaw:function(e){if(_._isCookieValidKey(e)){var t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),n=t.exec(document.cookie);if(n)return n[2]||null}return null},setCookieRaw:function(e,t,n){if(_._isCookieValidKey(e)){n=n||{};var o=n.expires;"number"==typeof n.expires&&(o=new Date,o.setTime(o.getTime()+n.expires)),document.cookie=e+"="+t+(n.path?"; path="+n.path:"")+(o?"; expires="+o.toGMTString():"")+(n.domain?"; domain="+n.domain:"")+(n.secure?"; secure":"")}},getCookie:function(e){var t=_.getCookieRaw(e);return"string"==typeof t?t=decodeURIComponent(t):null},setCookie:function(e,t,n){_.setCookieRaw(e,encodeURIComponent(t),n)}},T=function(e){_.html({href:w.bdHost+"css/bdsstyle.css?cdnversion=20121228",rel:"stylesheet",type:"text/css"},"link"),p=p||_.html({style:"display:none;"+(e||""),frameBorder:0},"iframe")},x=function(e){var t=/(#\d+\-[a-zA-Z\d]+\-\d+\-\d+\-[a-f\d]{32}$)/g,n=(r.search+r.hash).replace(/&/g,"#"),o=n.match(t)||"",s=new RegExp(w.bdWList,"ig"),a=r.protocol+"//"+r.hostname+r.pathname+r.search;if(!s.test(r.href)||""!=o||"undefined"!=typeof e){var d=[];bdShareTb.fn.b.length>0&&d.push("button"),bdShareTb.fn.t.length>0&&d.push("tools"),bdShareTb.fn.conf.bdType&&d.push(bdShareTb.fn.conf.bdType);var c=function(){for(var e=0,t=d.length,n={},o=[];t>e;e++)!(d[e]in n)&&o.push(d[e])&&(n[d[e]]="");return o.join(",")}();if("on"==w.tongji||""!=o||"undefined"!=typeof e){""!=o&&"3072"!=e&&(o=o.toString().replace("#",""),(new Image).src=w.bdCommit+"back?url="+encodeURIComponent(a)+"&sign="+encodeURIComponent(o)+"&title="+encodeURIComponent(l.substr(0,300)));var p=bdShareTb.loadTime?+new Date-bdShareTb.loadTime:"";if("undefined"!=typeof e)(new Image).src=w.bdCout+"&type="+e+"&sign="+o+"&uid="+w.bdUid+"&desturl="+encodeURIComponent(i.referrer)+"&linkid="+k+"&button="+c+"&loadTime="+p;else{for(var f=[0,0,0,0],h=0,u=d.length;u>h;h++)f[{tools:0,button:1,slide:2}[d[h]]]=1;bdShareTb._LogPool=bdShareTb._LogPool||[],bdShareTb._LogPool.push({key:"cite",api:{uid:w.bdUid||"",linkid:k,type:parseInt(f.reverse().join(""),2),mini:w.bdMini?1:0,loadTime:p}})}}}},S={create:function(){if(w.is_post_visible){var e='\u64CD\u4F5C\u5931\u8D25,\u8BE6\u89C1<a href="/helpcenter/index#/index">\u4E2A\u4EBA\u4E2D\u5FC3</a>~';return $.dialog.alert(e,{title:"\u64CD\u4F5C\u5931\u8D25"}),!1}var t=w,n=t.bdList,s=n.length,a=[],r="",d=_.getSize(),l=i.getElementById(t.bdIds+"_pop"),c=u||m?"absolute":"fixed",h=u||m?d.t:0;if(!l){for(;s--;)r=_.list(n[s]),a.push('<a href="'+r.url+'" class="'+r.cls+'">'+r.name+"</a>");var b=_.html({id:t.bdIds+"_pop",style:"position:"+c,innerHTML:"<div><h5></h5><ul><li>"+a.reverse().join("</li><li>")+'</li></ul><p><a href="#" class="goWebsite">\u767E\u5EA6\u5206\u4EAB</a></p></div>'});E.bind(b,"mouseover","a"),E.bind(b,"click","b",function(){b.style.display="none",p.style.display="none"}),_.on(b,"mouseover",function(e){var e=e||window.event,t=e.target||e.srcElement,n=_.getPosition(t),o=_.getMousePos(e),i=o.x-n.l,s=o.y-n.t;t.buttontype=2,t.x=i,t.y=s;var a=e.relatedTarget||e.fromElement;_.contains(b,a)||(b.time=+new Date)})}var g=b||l;g.getElementsByTagName("h5")[0].innerHTML=(f.title||t.bdPopTitle)+"<b>&nbsp;</b>",_.setAttr(g,"display:block;"),_.setAttr(g,"left:"+(d.w/2-g.offsetWidth/2)+"px;top:"+(h+d.h/2-g.offsetHeight/2)+"px"),_.setAttr(p,"position:"+c+";display:block;z-index:10000;width:"+g.offsetWidth+"px;height:"+g.offsetHeight+"px;left:"+g.style.left+";top:"+g.style.top),_.scroll(g,"pop"),_.on(o,"resize",function(){var e=_.getSize(),t="left:"+(e.w/2-g.offsetWidth/2)+"px;top:"+(h+e.h/2-g.offsetHeight/2)+"px";_.setAttr(g,t),_.setAttr(p,t)}),"slide"!=t.bdType&&(i.getElementById(w.bdIdsl).style.display="none",i.getElementById("bdsTbIfr").style.display="none"),window.bdShareActivity&&bdShareActivity.check()}},E={bind:function(e,t,n,i){var s=this;e.addEventListener?e.addEventListener(t,function(t){return s._action(t,t.target,n,e,i)},!1):e.attachEvent("on"+t,function(t){return t=o.event,s._action(t,t.srcElement,n,e,i)})},_action:function(e,t,n,o,i){var s=w.bdEntranceLog;if(t.nodeName==n.toUpperCase()){if("a"==n||"span"==n){var a=t.className,r="goWebsite"==a?a:a.split(" ")[0].split("_")[1],d=this;return r&&("more"==r&&"span"==n?d._tools(s):t.onclick=function(e,n){return function(o){var o=o||window.event,i=o.target||o.srcElement,a=_.getPosition(i),r=_.getMousePos(o),l=r.x-a.l,c=r.y-a.t;return"more"==e?d._tools(s):"copy"==e?d._copy(d):"print"==e?d._print():d._jump(e,n,t,l,c),!1}}(r,o)),!1}"function"==typeof i&&i()}"function"==typeof e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0)},_tools:function(e){x(3072),S.create(),$.stats.sendRequest("bdshare=tb&page=logcount&entrance="+e)},_copy:function(e){_this=e;var t=new _this._browsers;"IE"==t.name?(window.clipboardData.setData("text",document.title+" "+r.href),alert("\u6807\u9898\u548C\u94FE\u63A5\u590D\u5236\u6210\u529F\uFF0C\u60A8\u53EF\u4EE5\u63A8\u8350\u7ED9QQ/MSN\u4E0A\u7684\u597D\u53CB\u4E86\uFF01")):window.prompt("\u60A8\u4F7F\u7528\u7684\u662F\u975EIE\u6838\u5FC3\u6D4F\u89C8\u5668\uFF0C\u8BF7\u6309\u4E0B Ctrl+C \u590D\u5236\u4EE3\u7801\u5230\u526A\u8D34\u677F",document.title+" "+r.href)},_mail:function(){},_print:function(){var e=document.getElementById("bdshare_pop");e&&(e.style.display="none"),window.print(),e&&(e.style.display="block")},_jump:function(i,s,a,r,l){var c=w,p=w.bdEntranceLog,h=w.bdIds,u=c.bdPic,m=c.bdText,b=c.weiboText,g=c.wbUid,v=d,y=c.bdDesc,T=c.bdComment,x=c.bdMiniWindow||0;f=s.getAttribute("data")&&""!=s.getAttribute("data")?_._parseJson(s.getAttribute("data")):f,""!=f?(u=encodeURIComponent(f.pic||"")||u,v=encodeURIComponent(f.url||"")||v,T=encodeURIComponent(f.comment||"")||T,y=encodeURIComponent(f.desc||"")||y,g=f.wbuid||g,m="tsina"==i?encodeURIComponent(f.text&&f.weibotext?(f.text+f.weibotext).substr(0,300):f.weibotext?(m+f.weibotext).substr(0,300):f.text?(f.text+b).substr(0,300):(m+b).substr(0,300)):encodeURIComponent((f.text||"").substr(0,300))||encodeURIComponent(m.substr(0,300))):m=encodeURIComponent("tsina"==i?(m+b).substr(0,300):m.substr(0,300)),m=encodeURIComponent(m),n=(new Date).getTime()+3e3;var S=e.toString(32)+t.toString(32)+n.toString(32),E=a.buttontype,I=Math.floor(bdShareTb.XY.loadedX),C=Math.floor(bdShareTb.XY.loadedY),A=E>0?1:0,M=Math.floor(a.x),P=Math.floor(a.y),L=Math.floor(r),R=Math.floor(l),N=Math.floor(a.offsetWidth),W=Math.floor(a.offsetHeight),D=E,j=+new Date;j-=s.time;var B,U=[I,C,A,M,P,L,R,N,W,D,j].join(".");switch(w.bdType){case"button":B=1;break;case"slide":B=2;break;default:B=0}var q="mail"==i?"_mail":i,H="?click=1&url="+v+"&uid="+c.bdUid+"&to="+q+"&type=text&relateUid="+g+"&pic="+u+"&title="+m+"&key="+(c.snsKey[i]||"")+"&sign="+c.review+"&desc="+y+"&comment="+T+"&searchPic="+c.searchPic+"&l="+S+"&linkid="+k+"&sloc="+U+"&apiType=0&buttonType="+B+"&firstime="+_.getCookie("bdshare_firstime");if("mshare"==i)var z=c.bdMshare+H;else var z=c.bdCommit+H;var X=c.bdCommit+"commit"+H+"&t="+Math.random();if("goWebsite"!=i){bdShareTb.fn._getSc("share");var J=function(){var e=[];return function(t){var n=e.push(new Image)-1;e[n].onload=function(){e[n]=e[n].onload=null},e[n].src=t,"block"!=$("#"+h+"_pop").css("display")&&$.stats.sendRequest("bdshare=tb&page=logcount&entrance="+p)}}();if(setTimeout(function(){J(X)},1500),"bdxc"==i){var Y,O=window,z=document,V="_bdXC";O[V]?window._bdXC_loaded&&O[V].reInit():(Y=z.createElement("script"),Y.setAttribute("charset","utf-8"),Y.src="http://xiangce.baidu.com/zt/collect/mark.js?"+(new Date).getTime(),z.getElementsByTagName("head")[0].appendChild(Y))}else if("mail"==i){var Q=w.bdCommit+"sendmail";$.getJSON("/fex/check/isRealName",function(e){if(e.data===!1&&1===PageData.user.is_login)if("undefined"==typeof passport||"undefined"==typeof passport.pop.init){var t="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime(),n="https://passport";$.JsLoadManager.use([n+".baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(t/6e4),n+".baidu.com/passApi/js/wrapper.js?cdnversion="+Math.floor(t/6e4)],function(){window.realname=passport.pop.init({type:"accRealName",apiOpt:{product:"tb",staticPage:"//tieba.baidu.com/tb/static-common/html/pass/v3Jump.html"},tangram:!0,color:"green"}),window.realname.show()},!0,"utf-8")}else window.realname.show();else window.open(Q+H,"_blank")})}else 1==x?$.getJSON("/fex/check/isRealName",function(e){if(e.data===!1&&1===PageData.user.is_login)if("undefined"==typeof passport||"undefined"==typeof passport.pop.init){var t="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime(),n="https://passport";$.JsLoadManager.use([n+".baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(t/6e4),n+".baidu.com/passApi/js/wrapper.js?cdnversion="+Math.floor(t/6e4)],function(){window.realname=passport.pop.init({type:"accRealName",apiOpt:{product:"tb",staticPage:"//tieba.baidu.com/tb/static-common/html/pass/v3Jump.html"},tangram:!0,color:"green"}),window.realname.show()},!0,"utf-8")}else window.realname.show();else o.open(z,"bdShare","height=400, width=600")}):$.getJSON("/fex/check/isRealName",function(e){if(e.data===!1&&1===PageData.user.is_login)if("undefined"==typeof passport||"undefined"==typeof passport.pop.init){var t="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime(),n="https://passport";$.JsLoadManager.use([n+".baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(t/6e4),n+".baidu.com/passApi/js/wrapper.js?cdnversion="+Math.floor(t/6e4)],function(){window.realname=passport.pop.init({type:"accRealName",apiOpt:{product:"tb",staticPage:"//tieba.baidu.com/tb/static-common/html/pass/v3Jump.html"},tangram:!0,color:"green"}),window.realname.show()},!0,"utf-8")}else window.realname.show();else o.open(z)})}else $.getJSON("/fex/check/isRealName",function(e){if(e.data===!1&&1===PageData.user.is_login)if("undefined"==typeof passport||"undefined"==typeof passport.pop.init){var t="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime(),n="https://passport";$.JsLoadManager.use([n+".baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(t/6e4),n+".baidu.com/passApi/js/wrapper.js?cdnversion="+Math.floor(t/6e4)],function(){window.realname=passport.pop.init({type:"accRealName",apiOpt:{product:"tb",staticPage:"//tieba.baidu.com/tb/static-common/html/pass/v3Jump.html"},tangram:!0,color:"green"}),window.realname.show()},!0,"utf-8")}else window.realname.show();else o.open(c.bdJump)})},_browsers:function(){var e,t={},n=navigator.userAgent.toLowerCase();return n.match(/msie ([\d.]+)/)?(e=n.match(/msie ([\d.]+)/),t.name="IE",t.version=e[1]):n.match(/firefox\/([\d.]+)/)?(e=n.match(/firefox\/([\d.]+)/),t.name="firefox",t.version=e[1]):n.match(/chrome\/([\d.]+)/)?(e=n.match(/chrome\/([\d.]+)/),t.name="chrome",t.version=e[1]):n.match(/opera.([\d.]+)/)?(e=n.match(/opera.([\d.]+)/),t.name="opera",t.version=e[1]):n.match(/safari.([\d.]+)/)?(e=n.match(/safari.([\d.]+)/),t.name="safari",t.version=e[1]):(t.name="\u672A\u77E5\u7684\u6D4F\u89C8\u5668",t.version="\u672A\u77E5\u7684\u7248\u672C\u53F7"),t}},k=_.generateLinkid();bdShareTb.fn=function(){return{init:function(){function e(t){var t=t||window.event,n=_.getMousePos(t);bdShareTb.XY.loadedX=n.x,bdShareTb.XY.loadedY=n.y,bdShareTb.XY.loadedX>0&&bdShareTb.XY.loadedY>0&&_.unon(document,"mousemove",e)}t=(new Date).getTime()+1e3,this.b=[],this.t=[],this.s=[],this.type="load",this._getShare();var n=this;if("undefined"!=typeof bds_config)for(var o in bds_config)("bdPopTitle"==o||"bdText"==o||"weiboText"==o||"bdPic"==o||"wbUid"==o||"tongji"==o||"render"==o||"snsKey"==o||"review"==o||"bdComment"==o||"bdDesc"==o||"bdTop"==o||"searchPic"==o||"bdUrl"==o||"bdMiniWindow"==o)&&(w[o]="render"==o||"snsKey"==o||"bdPopTitle"==o||"bdText"==o||"weiboText"==o?bds_config[o]:encodeURIComponent(bds_config[o]));this.conf=w,this.imgW=w.bdImgW,this.conf.render&&((this.b.length>0||this.t.length>0)&&this._share(),"slide"==this.conf.bdType&&this._slide()),this._getSc(this.type);for(var i=this.t,s=0;s<i.length;s++)for(var a=i[s].getElementsByTagName("a"),r=0;r<a.length;r++)!a[r].getAttribute("href")&&a[r].setAttribute("href","#");bdShareTb.XY=bdShareTb.XY||{},_.on(document,"mousemove",e);for(var s=0,d=this.t.length;d>s;s++)!function(e){var t=e;_.on(n.t[e],"mouseover",function(e){var e=e||window.event,o=e.target||e.srcElement,i=_.getPosition(o),s=_.getMousePos(e),a=s.x-i.l,r=s.y-i.t;o.buttontype=0,o.x=a,o.y=r;var d=e.relatedTarget||e.fromElement;_.contains(n.t[t],d)||(n.t[t].time=+new Date)})}(s);x(),null==_.getCookie("bdshare_firstime")&&_.setCookie("bdshare_firstime",1*new Date,{path:"/",expires:(new Date).setFullYear(2022)-new Date})},_getSc:function(e){this.type=e;for(var t=i.querySelectorAll?i.querySelectorAll(".shareCount"):i.getElementsByTagName("*"),n=t.length;n--;)/\sshareCount|shareCount\s|shareCount$/.test(t[n].className)&&this.s.push(t[n]);this.s.length>0&&_.callByBrowser(this.conf.bdApi+"getnum?url="+d+"&callback=bdShareTb.fn._getShare&type="+e+"&t="+(new Date).getTime())},_getShare:function(e){var t=e?!0:!1,n=[];if(i.querySelectorAll)this.b=i.querySelectorAll(".bdshare_b"),this.t=i.querySelectorAll(".bdshare_t");else for(var o=i.getElementsByTagName("*"),s=o.length;s--;){var a=o[s];/\sbdshare_t|bdshare_t\s/.test(a.className)&&this.t.push(a),/\sbdshare_b|bdshare_b\s|bdshare_b$/.test(a.className)&&this.b.push(a)}if(t){for(var r,n=this.s,d=n.length;d--;)/\sshareCount|shareCount\s|shareCount$/.test(n[d].className)&&(r="share"==this.type?e.num[0]<1e4?parseInt(n[d].innerHTML,10)+1:e.num[1]:1*e.errno==0?e.num[1]:0,n[d].innerHTML=decodeURI(r),n[d].setAttribute("title","\u7D2F\u8BA1\u5206\u4EAB"+e.num[0]+"\u6B21"),n[d].onclick=function(e){w.is_post_visible?e.preventDefault():S.create()});this.s=[]}},_share:function(){_.list_s(!0);var e=this.b,t=this.t,n=e.length,o=t.length,s=i.getElementById(this.conf.bdIdsl),a=i.getElementById("bdsTbIfr"),r=this.conf.bdList,d=r.length;if(_.setAttr(s,"display:none;"),E.bind(s,"mouseover","a"),n>0)for(;n--;)"bdshare_tb"==e[n].id&&(E.bind(e[n],"click","img",function(){S.create()}),E.bind(e[n],"mouseover","a",function(){S.create()}),this._s(e[n],s,a,e[n],"b"));if(o>0)for(;o--;)if("bdshare_tb"==t[o].id){E.bind(t[o],"click","span",function(){S.create()}),E.bind(t[o],"mouseover","a");for(var l=_.children(t[o]),c=l.length,p="";c--;){var f=l[c];if(/bds_more/.test(f.className))p=l[c],m&&(p.style.height=(/bds_tools_32/.test(t[o].className)?38:17)+"px"),this._s(""==p?t[o]:p,s,a,t[o],p);else for(var h=0;d>h;h++)if(r[h]){var u=r[h].split(","),b=new RegExp(this.conf.bdPref+u[0]+"$","ig");if(r[h]){var u=r[h].split(","),b=new RegExp(this.conf.bdPref+u[0]+"$","ig");b.test(f.className)&&("\u62F7\u8D1D"==u[1]?f.title="\u590D\u5236\u7F51\u5740":f.title||(f.title="\u5206\u4EAB\u5230"+u[1]))}}}}},_s:function(e,t,n,o,i){var s,a=this,r=[],d=""==i?"none":"block";this._popShow(e,{over:function(i){r=_.getPosition(e),f=o.getAttribute("data")&&""!=o.getAttribute("data")?_._parseJson(o.getAttribute("data")):"",_.setAttr(t,"display:"+d),_.setAttr(t,"left:"+(_.getSize().w-i.clientX<t.offsetWidth?r.l-t.offsetWidth+e.offsetWidth:r.l)+"px"),_.setAttr(t,"top:"+(_.getSize().h-i.clientY<t.offsetHeight?r.t-t.offsetHeight:r.t+e.offsetHeight)+"px"),_.setAttr(n,"display:"+d+";width:"+t.offsetWidth+"px;height:"+t.offsetHeight+"px;left:"+t.style.left+";top:"+t.style.top)},out:function(){s=setTimeout(function(){t.style.display="none",n.style.display="none"},100),a._popShow(t,{over:function(){clearTimeout(s),t.style.display="block",n.style.display="block"},out:function(){t.style.display="none",n.style.display="none"}})}})},_slide:function(){function e(){_.setAttr(c,"display:block;"),c.offsetWidth+r.imgW!=d.offsetWidth&&(tm=setTimeout(function(){c.offsetWidth+r.imgW!=d.offsetWidth&&r._move(d,0,r.imgW,c.offsetWidth,p)},100),r._popShow(c,{over:function(){_.setAttr(p,"height:"+c.offsetHeight+"px;"+r.conf.bdLeft+":0;top:0;display:block")},out:function(){}}),r._popShow(d,{over:function(){},out:function(){d.offsetWidth==c.offsetWidth+r.imgW&&(clearTimeout(tm),r._move(d,0,c.offsetWidth+r.imgW,-c.offsetWidth,p)),p.style.display="none"}}))}if(!o._bdS){var t="right"==this.conf.bdLeft?"left":"right",n=this.conf.bdHost+"images/"+this.conf.bdLeft.substring(0,1)+this.conf.bdImg+".gif";o._bdS=_.html({id:this.conf.bdIds,innerHTML:'<img src="'+n+'" alt="" style="float:'+t+';margin-top:58px;"/>'+_.list_s(!1)});var s=_.children(_bdS),a=s[s.length-1];_.on(a,"mouseover",function(e){var e=e||window.event,t=e.target||e.srcElement,n=_.getPosition(t),o=e.relatedTarget||e.fromElement,i=_.getMousePos(e),s=i.x-n.l,r=i.y-n.t;t.buttontype=1,t.x=s,t.y=r,_.contains(a,o)||(a.time=+new Date)})}var r=this,d=_bdS,l=_.getSize(),c=i.getElementById(this.conf.bdIdsl),p=i.getElementById("bdsTbIfr"),f=u||m?"absolute":"fixed",h=(u?l.t:0)+(0==this.conf.bdTop?l.h<c.offsetHeight?-40:l.h/2-c.offsetHeight/2:parseInt(this.conf.bdTop,10));_.setAttr(d,"overflow:hidden;height:330px;position:"+f+";top:"+h+"px;"+this.conf.bdLeft+":0;"+("right"==t?t+":"+(l.w-this.imgW)+"px":"")),_.setAttr(c,t+":"+this.imgW+"px;display:none"),E.bind(d,"click","img",function(){x(3072),S.create()}),E.bind(d,"mouseover","img",e),E.bind(c,"mouseover","a"),_.scroll(d,"slide"),_.on(o,"resize",function(){_.setAttr(d,"right"==t?t+":"+(_.getSize().w-r.imgW)+"px":"")})},_move:function(e,t,n,o,i){var s=e.style,a=i.style,r=this,d=6;setInterval(function(){d>t&&(t++,s.width=Math.ceil(o*t/d+n)+"px",a.width=Math.ceil(o*t/d+n)-r.imgW+"px")},10)},_popShow:function(e,t){function n(e){t.over(e)}function s(e){t.out(e)}w.is_post_visible||(i.all?(e.onmouseenter=function(){n(o.event)},e.onmouseleave=s):(e.onmouseover=function(e){null==e.relatedTarget?n(e):!(this===e.relatedTarget||20==this.compareDocumentPosition(e.relatedTarget))&&n(e)},e.onmouseout=function(e){null==e.relatedTarget?s(e):!(this===e.relatedTarget||20==this.compareDocumentPosition(e.relatedTarget))&&s(e)}))}}}(),T(),bdShareTb.fn.init()}}();
;_.Module.define({path:"pcommon/widget/bd_share"});window.__discarding&&__discarding("pcommon/component/login_dialog"),_.Module.define({path:"pcommon/component/LoginDialog",sub:{_config:{apiOpt:{staticPage:"http://tieba.baidu.com/tb/static-common/html/pass/v3Jump.html",product:"tb",charset:"GBK",u:"",memberPass:!0,safeFlag:0},cache:!1,img:"",onLoginSuccess:function(t){t.returnValue=!1,$.stats.sendRequest("st_type=login_succeed&fr=tb0&st_pos="),$.tb.location.reload()},onSubmitStart:function(){$.stats.sendRequest("st_type=login_click&fr=tb0&st_pos=")},registerLink:"https://passport.baidu.com/v2/?reg&tpl=tb&u=http://tieba.baidu.com",tangram:!0},initial:function(t,i,s){var o=this,a=1;if(o._config.apiOpt.u="string"==typeof t&&""!=t?t:$.tb.location.getHref(),"string"==typeof i){switch(i){case"userBar":a=1;break;case"editor1":case"lzl":a=2;break;case"editor":a=3;break;case"lzonly":a=4;break;case"ilike":a=5;break;default:a=1}o._config.img="http://tb2.bdstatic.com/tb/static-common/img/passport/logindlg_pic"+a+".png"}else o._config.img="http://tb2.bdstatic.com/tb/static-common/img/passport/logindlg_pic"+a+".png";PageData&&(o._config.apiOpt.isQuickUser=PageData.is_quick_user||0),s&&(o._config.onLoginSuccess=s),arguments.length>3&&(o._config.apiOpt.product=arguments[3]),function(t){var i="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime();t.JsLoadManager.use(["http://passport.bdimg.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(i/6e4),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+Math.floor(i/6e4)],function(){t.passPopInstance||(t.passPopInstance=passport.pop.init(o._config)),t("#passport-login-pop").find(".pass-login-pop-img img").tbattr("src",o._config.img),t.passPopInstance.show(),setTimeout(function(){t("#passport-login-pop").find("input.pass-button-submit").tbattr("alog-alias","login")},1e3)},!0,"utf-8")}(window.jQuery)}}});_.Module.define({requires:["pcommon/component/LoginDialog"],path:"ppb/widget/Posts",sub:{initial:function(e){var t=this;t.maskDays=e.maskDays,t._bindEvents()},_bindEvents:function(){if(!Page.checkLoadedModules("pbPost")){var e=this;$("#j_p_postlist").delegate(".p_post_del_my","click",function(){var t=$(this),a=t.getData()||{},n=a.delete_mine,o=a.user_name,i=a.index;if(n&&1==n){var s=i&&1==i?"\u4E3B\u9898":"\u56DE\u590D",r=r=$.dialog.confirm('<div style="margin:15px auto 0;text-align:center;">\u786E\u8BA4\u5220\u9664\u8FD9\u6761'+s+"?<div>",{showTitle:!1});i&&1==i?r.bind("onaccept",function(){e._delete_thread(o)}):r.bind("onaccept",function(){var a=e._get_delete_paras(t,!1);a.user_name=o,e._delete_post(a)})}return!1}).delegate(".lzl_jb_in","click",function(){{var t=$(this),a=t.getData()||{},n=a.user_name;a.delete_mine}if(1==a.delete_mine){var o=$.dialog.confirm('<div style="margin:15px auto 0;text-align:center;">\u786E\u8BA4\u5220\u9664\u8FD9\u6761\u56DE\u590D?<div>',{showTitle:!1});o.bind("onaccept",function(){var a=e._get_delete_paras(t,!0);a.user_name=n,e._delete_post(a,!0)})}return!1}).delegate(".p_forbidden_post_content_fold","click",function(e){var t=e.srcElement||e.target;return $(t).parents(".p_content").find(".j_d_post_content").show(),$(t).parents(".p_content").find(".p_forbidden_post_content_unfold").show(),$(t).hide(),$.stats.track("showlist","pbfold","pb_list","CLICK"),!1}).delegate(".p_forbidden_post_content_unfold","click",function(e){var t=e.srcElement||e.target;return $(t).parents(".p_content").find(".j_d_post_content").hide(),$(t).parents(".p_content").find(".p_forbidden_post_content_fold").show(),$(t).hide(),$.stats.track("hidelist","pbfold","pb_list","CLICK"),!1}).delegate(".j_jb_ele","click",function(){var e=$(this).parents(".l_post").getData().content.post_id,t=window.open("","newwindow","height=900, width=800, toolbar =no, menubar=no, scrollbars=yes, resizable=yes, location=no, status=no");$.ajax({url:"/complaint/checkjubao?",data:{category:1,pid:e},dataType:"json",success:function(e){if(0==e.errno)null!=e.data.url&&(t.location.href=$.tb.unescapeHTML(e.data.url));else{if(2140006==e.errno)return t.close(),void TbCom.process("User","buildLoginFrame",null,null,null,null);t.close(),$.dialog.alert(e.errmsg,{title:"\u4E3E\u62A5\u5931\u8D25"})}},error:function(){t.close(),$.dialog.alert("\u4E3E\u62A5\u5931\u8D25",{title:"\u4E3E\u62A5\u5931\u8D25"})}})}).delegate(".user-jubao-button","click",function(){var e=$(this).parents(".j_lzl_s_p"),t=e.getData(),a=t.spid,n=window.open("","newwindow","height=900, width=800, toolbar =no, menubar=no, scrollbars=yes, resizable=yes, location=no, status=no");$.ajax({url:"/complaint/checkjubao?",data:{category:1,pid:a},dataType:"json",success:function(e){if(0==e.errno)null!=e.data.url&&(n.location.href=$.tb.unescapeHTML(e.data.url));else{if(2140006==e.errno)return n.close(),void TbCom.process("User","buildLoginFrame",null,null,null,null);n.close(),$.dialog.alert(e.errmsg,{title:"\u4E3E\u62A5\u5931\u8D25"})}},error:function(){n.close(),$.dialog.alert("\u4E3E\u62A5\u5931\u8D25",{title:"\u4E3E\u62A5\u5931\u8D25"})}})}).delegate(".apc_src_wrapper a","mousedown",function(e){var t=e.currentTarget.href,a=t.replace(/\w*(:\/\/)?([^\/]+).*/g,"$2");$.stats.sendRequest("fr=tb0_forum&st_type=shenqi_pb_link&st_value="+encodeURIComponent(a))}).delegate(".j_user_card","click",function(){if(!PageData.user.is_login){var e="";e=$(this).hasClass("lzl_p_p")?"pb_user_lzl":"pb_user_lc";var t="http://tieba.baidu.com"+$.tb.unescapeHTML($(this).tbattr("href"));return window.open("/f/user/passport?jumpUrl="+t+"&statsInfo="+e+"#login_anchor"),!1}}).on("click",".j-pb-tpoint",function(){var t=PageData.user;if(!t.is_login)return e.requireInstance("pcommon/component/LoginDialog"),!1;var a=$(this),n=a.getData();e.tbpointTrack(n.template_id,"BTN_FB");var o=e.maskDays&&+e.maskDays<=10?"\u786E\u5B9A"+e.maskDays+"\u5929\u5185\u4E0D\u518D\u770B\u5230\u8BE5\u6761\u5E7F\u544A?":"\u786E\u5B9A\u4E0D\u518D\u770B\u5230\u8BE5\u6761\u5E7F\u544A?",i=$.dialog.confirm('<div style="margin:15px auto 0;text-align:center;">'+o+"</div>",{title:"\u63D0\u793A"});i.bind("onaccept",function(){e.tbpointTrack(n.template_id,"BTN_FBOK"),$.post("/tpoint/submit/mask",{tbs:PageData.tbs,user_id:t.user_id,template_id:n.template_id},function(t){0===t.no?a.closest(".j_l_post").remove():e._showTip("\u62B1\u6B49\uFF0C\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u9690\u85CF\u5931\u8D25\u3002")},"json")}).bind("oncancel",function(){e.tbpointTrack(n.template_id,"BTN_FBCANCEL")})})}},tbpointTrack:function(e,t){var a=PageData;$.stats.track("p0248","tpoint","PB","CLICK_FEEDBACK",{action_type:"CLICK_FEEDBACK",line:"PT",loc_param:t,obj_id:e,obj_name:e,obj_cpid:0,obj_good_id:0,obj_throw_type:"BY_POST",client_type:"PC_WEB",uid:a.user.user_id,uname:a.user.user_name,fid:a.forum.forum_id,fname:a.forum.forum_name,err_no:0,tid:a.thread.thread_id,timestamp:(new Date).getTime()})},_delete_thread:function(e,t){var a=this,n=PageData,o={ie:"utf-8",tbs:n.tbs,kw:n.forum.forum_name,fid:n.forum.forum_id,tid:n.thread.thread_id,user_name:e,delete_my_post:0,delete_my_thread:1};t&&(o=$.extend(o,a._captcha)),PostHandler.execute("threadDelete",o,function(t){var n="";switch(t.no){case 0:$.tb.location.setHref("/f?kw="+PageData.forum.name_url);break;case 308:n=PageData.user.forbidden?"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u88AB\u672C\u5427\u5C01\u7981\u6216\u8005\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u4E0D\u80FD\u5220\u8D34":"";break;case 871:n="\u62B1\u6B49\uFF0C\u4ECA\u5929\u5DF2\u8FBE\u60A8\u5220\u8D34\u7684\u6700\u5927\u9650\u989D\uFF0C\u660E\u5929\u518D\u6765\u8BD5\u8BD5\u5427~";break;case 4011:a._getCaptcha.call(a,t,e);break;case 4009:n="\u8BE5\u8D34\u5B50\u5DF2\u7ECF\u88AB\u4FDD\u62A4\uFF0C\u65E0\u6CD5\u76F4\u63A5\u5220\u9664\uFF0C\u5982\u53D1\u73B0\u8D34\u5B50\u6709\u95EE\u9898\u8BF7\u76F4\u63A5\u4E3E\u62A5\u3002";break;case 1057:n='\u64CD\u4F5C\u5931\u8D25,\u8BE6\u89C1<a href="/helpcenter/index#/index">\u4E2A\u4EBA\u4E2D\u5FC3</a>~';break;default:n="\u62B1\u6B49\uFF0C\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u8D34\u5B50\u5220\u9664\u5931\u8D25\u3002"}""!=n&&(a.message?a.message.showMessage(n,"",!1):_.Moudle.getInstance("ppb/widget/Message",function(e){a.message=e,e.showMessage(n,"",!1)}))})},_delete_post:function(e,t,a){var n=this,o=PageData,i={ie:"utf-8",tbs:o.tbs,kw:o.forum.forum_name,fid:o.forum.forum_id,tid:o.thread.thread_id,user_name:e.user_name,delete_my_post:1,delete_my_thread:0,is_vipdel:o.power.lz_del?1:0};a&&(i=$.extend(i,n._captcha)),t?(i.pid=e.spid,i.is_finf=1):(i.pid=e.content_id,i.is_finf=!1),PostHandler.execute("postDelete",i,function(a){var o="";switch(a.no){case 0:$.tb.location.reload();break;case 308:o="\u62B1\u6B49\uFF0C\u60A8\u5DF2\u88AB\u672C\u5427\u5C01\u7981\u6216\u8005\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u4E0D\u80FD\u5220\u8D34";break;case 871:o="\u62B1\u6B49\uFF0C\u4ECA\u5929\u5DF2\u8FBE\u60A8\u5220\u8D34\u7684\u6700\u5927\u9650\u989D\uFF0C\u660E\u5929\u518D\u6765\u8BD5\u8BD5\u5427~";break;case 4011:n._getCaptcha.call(n,a,e,t);break;case 4001:o="\u60A8\u597D\uFF0C\u8BE5\u5E16\u5DF2\u5728\u5F53\u524D\u5206\u7C7B\u4E0B\u7F6E\u9876\uFF0C\u6682\u65F6\u65E0\u6CD5\u5220\u9664";break;case 4009:o="\u8BE5\u8D34\u5B50\u5DF2\u7ECF\u88AB\u4FDD\u62A4\uFF0C\u65E0\u6CD5\u76F4\u63A5\u5220\u9664\uFF0C\u5982\u53D1\u73B0\u8D34\u5B50\u6709\u95EE\u9898\u8BF7\u76F4\u63A5\u4E3E\u62A5\u3002";break;default:o="\u62B1\u6B49\uFF0C\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u8D34\u5B50\u5220\u9664\u5931\u8D25\u3002"}""!=o&&(n.message?n.message.showMessage(o,"",!1):n.requireInstanceAsync("ppb/widget/Message",[],function(e){n.message=e,e.showMessage(o,"",!1)}))})},_captcha:{},_getCaptcha:function(e,t,a){var n=this,o=1;"string"==typeof t&&(o=0),_.Module.use("pcommon/component/CaptchaDialog",{title:"\u5220\u9664\u8D34\u5B50",message:"\u5220\u4E86\u90A3\u4E48\u591A\u8D34\u5B50\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.forum_name,forumId:PageData.forum.forum_id,postType:"thread",paramsCallback:function(){return{}}},function(e){n.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){n._captcha.vcode=e.getInputValue(),n._captcha.vcode_md5=e.getVCode(),o?n._delete_post.call(n,t,a,1):n._delete_thread.call(n,t,1)}),e.show()})},_get_delete_paras:function(e,t){var a,n,o={};return t?(a=e.parents("li.j_lzl_s_p"),o=a.getData()):(a=e.parents("div.l_post"),n=a.getData(),o={author_name:n.author.user_name,content_id:n.content.post_id}),o},_showTip:function(e){var t='<p style="text-align: center">'+e+"</p>";$.dialog.assert(t,function(){},{time:2e3,title:"\u63D0\u793A"})}}});_.Module.define({path:"album/component/initApiConfig",sub:{appid:"314406",xiangceUrl:"http://favo.xiangce.baidu.com/",uploadUrl:"http://up.xiangce.baidu.com/",tags:null,descript:null,cache:{},imgUrl:null,sourceURL:null,offset:{x:-72,y:6},likeButton:null,timer:null,currentQueryImgUrl:null,currentUpImgUrl:null,currentIndex:0,hasLogin:!1,hasNoUn:!1,area:[],descript:"",no_pic_pb:!1,sourceURL:"",tags:"",initial:function(t){var i=this;i.hasLogin=t.isLogin,i.hasNoUn=t.hasNoUn,i.area=t.conf.area,i.descript=t.conf.descript,i.no_pic_pb=t.conf.no_pic_pb,i.sourceURL=t.conf.sourceURL,i.tags=t.conf.tags},isImgMarked:function(t){return t in this.cache&&1==this.cache[t]},checkImgSize:function(t,i){return i.width>=$(t).width()||i.height>=$(t).height()?!1:!0},loginEvent:function(){TbCom.process("User","buildLoginFrame",null,null,null,"fav_img")},showLikeButton:function(){this.likeButton&&this.likeButton.show()},hideLikeButton:function(){this.likeButton&&this.likeButton.hide()},setLikeButtonPosition:function(t,i){{var n,e,o=this,r=$(t),s=r.offset(),u=s.left,a=s.top,c=r.outerHeight(),l=r.outerWidth(),h=o.likeButton;o.area[i]}h.find(".download").show();var d=h.outerHeight(),g=h.outerWidth();return(d+20>c||g+20>l)&&(h.find(".download").hide(),d=h.outerHeight(),g=h.outerWidth(),d+20>c||g+20>l)?!1:(n=a-parseInt(h.css("padding-top")),e=u+l-g+h.width(),h.css({top:n,left:e}),!0)},setImgConf:function(t){var i=this;if("IMG"!=t.tagName){var n=($(t).find("img")[0],$.parseJSON($(t).tbattr("favData")));if(!n.src)return!1;i.imgUrl=n.src,i.sourceURL=n.sourceURL,i.tags=n.tags,i.descript=n.descript}else i.imgUrl=t.src||"";var e=i.imgUrl.lastIndexOf(".webp");return-1!=e&&(i.imgUrl=i.imgUrl.slice(0,e)+".jpg"),!0},resetAndshowLikeButton:function(t,i){var n=this;return n.currentIndex=i,n.setImgConf(t)?n.setLikeButtonPosition(t,i)?(n.imgUrl in n.cache?(n.likeButton[n.isImgMarked(n.imgUrl)?"addClass":"removeClass"]("done"),n.showLikeButton()):n.queryAndshowLikeButton(),void 0):!1:!1},queryAndshowLikeButton:function(){{var t=this;t.cache,t.imgUrl,t.likeButton}return t.hasLogin?void 0:(this.showLikeButton(),void 0)},setAreaConf:function(t,i,n){var e=this,o=e.area,r=null;for(var s in o)o[s].tag===t&&(r=o[s]);r[i]=n}}});_.Module.define({path:"common/widget/tbcopy/ZeroClipboard",sub:{get:function(){return this.ZeroClipboard},getClient:function(e){return new this.ZeroClipboard(e)},initial:function(){var e=this;!function(t,n){"use strict";var r,a=t,i=a.document,o=a.navigator,l=a.setTimeout,s=a.Number.parseInt||a.parseInt,u=a.Number.parseFloat||a.parseFloat,c=a.Number.isNaN||a.isNaN,f=a.encodeURIComponent,p=a.Math,d=a.Date,h=a.ActiveXObject,y=a.Array.prototype.slice,v=a.Object.keys,g=a.Object.prototype.hasOwnProperty,m=function(){return"function"==typeof a.Object.defineProperty&&function(){try{var e={};return a.Object.defineProperty(e,"y",{value:"z"}),"z"===e.y}catch(t){return!1}}()?a.Object.defineProperty:void 0}(),b=function(e){return y.call(e,0)},w=function(e,t,n){if("function"==typeof t.indexOf)return t.indexOf(e,n);var r,a=t.length;for("undefined"==typeof n?n=0:0>n&&(n=a+n),r=n;a>r;r++)if(g.call(t,r)&&t[r]===e)return r;return-1},C=function(){var e,t,r,a,i,o,l=b(arguments),s=l[0]||{};for(e=1,t=l.length;t>e;e++)if(null!=(r=l[e]))for(a in r)if(g.call(r,a)){if(i=s[a],o=r[a],s===o)continue;o!==n&&(s[a]=o)}return s},x=function(e){var t,n,r,a;if("object"!=typeof e||null==e)t=e;else if("number"==typeof e.length)for(t=[],n=0,r=e.length;r>n;n++)g.call(e,n)&&(t[n]=x(e[n]));else{t={};for(a in e)g.call(e,a)&&(t[a]=x(e[a]))}return t},E=function(e,t){for(var n={},r=0,a=t.length;a>r;r++)t[r]in e&&(n[t[r]]=e[t[r]]);return n},T=function(e,t){var n={};for(var r in e)-1===w(r,t)&&(n[r]=e[r]);return n},j=function(e){if(null==e)return[];if(v)return v(e);var t=[];for(var n in e)g.call(e,n)&&t.push(n);return t},D=function(e){if(e)for(var t in e)g.call(e,t)&&delete e[t];return e},I=function(e,t){t in e&&"function"==typeof m&&m(e,t,{value:e[t],writable:!1,configurable:!0,enumerable:!0})},k=function(e){return function(){var t;return t=e.now?e.now():(new e).getTime()}}(d),O={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,unavailable:null,deactivated:null,overdue:null,ready:null},N="11.0.0",L={},z={},_=null,S={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate","flash-overdue":"Flash communication was established but NOT within the acceptable time limit"}},F=(function(){var e,t,n,r,a="ZeroClipboard.swf";if(!i.currentScript||!(r=i.currentScript.src)){var o=i.getElementsByTagName("script");if("readyState"in o[0])for(e=o.length;e--&&("interactive"!==o[e].readyState||!(r=o[e].src)););else if("loading"===i.readyState)r=o[o.length-1].src;else{for(e=o.length;e--;){if(n=o[e].src,!n){t=null;break}if(n=n.split("#")[0].split("?")[0],n=n.slice(0,n.lastIndexOf("/")+1),null==t)t=n;else if(t!==n){t=null;break}}null!==t&&(r=t)}}return r&&(r=r.split("#")[0].split("?")[0],a=r.slice(0,r.lastIndexOf("/")+1)+a),a}(),{swfPath:"//tb2.bdstatic.com/tb/static-common/widget/tbcopy/ZCB_8fd7d9f.swf",trustedDomains:t.location.host?[t.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999}),X=function(e){if("object"==typeof e&&null!==e)for(var t in e)if(g.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))F[t]=e[t];else if(null==O.bridge)if("containerId"===t||"swfObjectId"===t){if(!G(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");F[t]=e[t]}else F[t]=e[t];{if("string"!=typeof e||!e)return x(F);if(g.call(F,e))return F[e]}},A=function(){return{browser:E(o,["userAgent","platform","appName"]),flash:T(O,["bridge"]),zeroclipboard:{version:jt.version,config:jt.config()}}},Y=function(){return!!(O.disabled||O.outdated||O.unavailable||O.deactivated)},$=function(e,t){var n,r,a,i={};if("string"==typeof e&&e)a=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&jt.on(n,e[n]);if(a&&a.length){for(n=0,r=a.length;r>n;n++)e=a[n].replace(/^on/,""),i[e]=!0,L[e]||(L[e]=[]),L[e].push(t);if(i.ready&&O.ready&&jt.emit({type:"ready"}),i.error){var o=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,r=o.length;r>n;n++)if(O[o[n]]===!0){jt.emit({type:"error",name:"flash-"+o[n]});break}}}return jt},B=function(e,t){var n,r,a,i,o;if(0===arguments.length)i=j(L);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&jt.off(n,e[n]);if(i&&i.length)for(n=0,r=i.length;r>n;n++)if(e=i[n].toLowerCase().replace(/^on/,""),o=L[e],o&&o.length)if(t)for(a=w(t,o);-1!==a;)o.splice(a,1),a=w(t,o,a);else o.length=0;return jt},M=function(e){var t;return t="string"==typeof e&&e?x(L[e])||null:x(L)},H=function(e){var t,n,r;return e=J(e),e&&!nt(e)?"ready"===e.type&&O.overdue===!0?jt.emit({type:"error",name:"flash-overdue"}):(t=C({},e),tt.call(this,t),"copy"===e.type&&(r=st(z),n=r.data,_=r.formatMap),n):void 0},P=function(){if("boolean"!=typeof O.ready&&(O.ready=!1),!jt.isFlashUnusable()&&null===O.bridge){var e=F.flashLoadTimeout;"number"==typeof e&&e>=0&&l(function(){"boolean"!=typeof O.deactivated&&(O.deactivated=!0),O.deactivated===!0&&jt.emit({type:"error",name:"flash-deactivated"})},e),O.overdue=!1,ot()}},Z=function(){jt.clearData(),jt.deactivate(),jt.emit("destroy"),lt(),jt.off()},R=function(e,t){var n;if("object"==typeof e&&e&&"undefined"==typeof t)n=e,jt.clearData();else{if("string"!=typeof e||!e)return;n={},n[e]=t}for(var r in n)"string"==typeof r&&r&&g.call(n,r)&&"string"==typeof n[r]&&n[r]&&(z[r]=n[r])},V=function(e){"undefined"==typeof e?(D(z),_=null):"string"==typeof e&&g.call(z,e)&&delete z[e]},K=function(e){if(e&&1===e.nodeType){r&&(vt(r,F.activeClass),r!==e&&vt(r,F.hoverClass)),r=e,yt(e,F.hoverClass);var t=e.getAttribute("title")||F.title;if("string"==typeof t&&t){var n=it(O.bridge);n&&n.setAttribute("title",t)}var a=F.forceHandCursor===!0||"pointer"===mt(e,"cursor");xt(a),Ct()}},U=function(){var e=it(O.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.top="1px"),r&&(vt(r,F.hoverClass),vt(r,F.activeClass),r=null)},G=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},J=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){C(e,{type:t.toLowerCase(),target:e.target||r||null,relatedTarget:e.relatedTarget||null,currentTarget:O&&O.bridge||null,timeStamp:e.timeStamp||k()||null});var n=S[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&C(e,{target:null,version:O.version}),"error"===e.type&&(/^flash-(disabled|outdated|unavailable|deactivated|overdue)$/.test(e.name)&&C(e,{target:null,minimumVersion:N}),/^flash-(outdated|unavailable|deactivated|overdue)$/.test(e.name)&&C(e,{version:O.version})),"copy"===e.type&&(e.clipboardData={setData:jt.setData,clearData:jt.clearData}),"aftercopy"===e.type&&(e=ut(e,_)),e.target&&!e.relatedTarget&&(e.relatedTarget=W(e.target)),e=q(e)}},W=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?i.getElementById(t):null},q=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target,r="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:n,o="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:n,l=wt(t),s=a.screenLeft||a.screenX||0,u=a.screenTop||a.screenY||0,c=i.body.scrollLeft+i.documentElement.scrollLeft,f=i.body.scrollTop+i.documentElement.scrollTop,p=l.left+("number"==typeof e._stageX?e._stageX:0),d=l.top+("number"==typeof e._stageY?e._stageY:0),h=p-c,y=d-f,v=s+h,g=u+y,m="number"==typeof e.movementX?e.movementX:0,b="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,C(e,{srcElement:t,fromElement:r,toElement:o,screenX:v,screenY:g,pageX:p,pageY:d,clientX:h,clientY:y,x:h,y:y,movementX:m,movementY:b,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},Q=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},et=function(e,t,n,r){r?l(function(){e.apply(t,n)},0):e.apply(t,n)},tt=function(e){if("object"==typeof e&&e&&e.type){var t=Q(e),n=L["*"]||[],r=L[e.type]||[],i=n.concat(r);if(i&&i.length){var o,l,s,u,c,f=this;for(o=0,l=i.length;l>o;o++)s=i[o],u=f,"string"==typeof s&&"function"==typeof a[s]&&(s=a[s]),"object"==typeof s&&s&&"function"==typeof s.handleEvent&&(u=s,s=s.handleEvent),"function"==typeof s&&(c=C({},e),et(s,u,[c],t))}return this}},nt=function(e){var t=e.target||r||null,n="swf"===e._source;switch(delete e._source,e.type){case"error":w(e.name,["flash-disabled","flash-outdated","flash-deactivated","flash-overdue"])&&C(O,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,unavailable:"flash-unavailable"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1});break;case"ready":var a=O.deactivated===!0;C(O,{disabled:!1,outdated:!1,unavailable:!1,deactivated:!1,overdue:a,ready:!a});break;case"copy":var i,o,l=e.relatedTarget;!z["text/html"]&&!z["text/plain"]&&l&&(o=l.value||l.outerHTML||l.innerHTML)&&(i=l.value||l.textContent||l.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",i),o!==i&&e.clipboardData.setData("text/html",o)):!z["text/plain"]&&e.target&&(i=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",i));break;case"aftercopy":jt.clearData(),t&&t!==ht()&&t.focus&&t.focus();break;case"_mouseover":jt.activate(t),F.bubbleEvents===!0&&n&&(rt(C({},e,{type:"mouseover"})),rt(C({},e,{type:"mouseenter",bubbles:!1})));break;case"_mouseout":jt.deactivate(),F.bubbleEvents===!0&&n&&(rt(C({},e,{type:"mouseout"})),rt(C({},e,{type:"mouseleave",bubbles:!1})));break;case"_mousedown":yt(t,F.activeClass),F.bubbleEvents===!0&&n&&rt(C({},e,{type:e.type.slice(1)}));break;case"_mouseup":vt(t,F.activeClass),F.bubbleEvents===!0&&n&&rt(C({},e,{type:e.type.slice(1)}));break;case"_click":case"_mousemove":F.bubbleEvents===!0&&n&&rt(C({},e,{type:e.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)?!0:void 0},rt=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||e.srcElement||null,r=n&&n.ownerDocument||i,o={view:r.defaultView||a,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:r.createEvent?0:1},l=C(o,e);n&&(r.createEvent&&n.dispatchEvent?(l=[l.type,l.canBubble,l.cancelable,l.view,l.detail,l.screenX,l.screenY,l.clientX,l.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget],t=r.createEvent("MouseEvents"),t.initMouseEvent&&(t.initMouseEvent.apply(t,l),n.dispatchEvent(t))):r.createEventObject&&n.fireEvent&&(t=r.createEventObject(l),n.fireEvent("on"+l.type,t)))}},at=function(){var e=i.createElement("div");return e.id=F.containerId,e.className=F.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+Et(F.zIndex),e},it=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},ot=function(){var e,t=O.bridge,n=it(t);if(!t){var r=dt(a.location.host,F),o="never"===r?"none":"all",l=ft(F),s=F.swfPath+ct(F.swfPath,F);n=at();var u=i.createElement("div");n.appendChild(u),i.body.appendChild(n);var c=i.createElement("div"),f="activex"===O.pluginType;c.innerHTML='<object id="'+F.swfObjectId+'" name="'+F.swfObjectId+'" width="100%" height="100%" '+(f?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+s+'"')+">"+(f?'<param name="movie" value="'+s+'"/>':"")+'<param name="allowScriptAccess" value="'+r+'"/><param name="allowNetworking" value="'+o+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+l+'"/></object>',t=c.firstChild,c=null,t.ZeroClipboard=jt,n.replaceChild(t,u)}return t||(t=i[F.swfObjectId],t&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),O.bridge=t||null,t},lt=function(){var e=O.bridge;if(e){var t=it(e);t&&("activex"===O.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var r in e)"function"==typeof e[r]&&(e[r]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else l(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),O.ready=null,O.bridge=null,O.deactivated=null}},st=function(e){var t={},n={};if("object"==typeof e&&e){for(var r in e)if(r&&g.call(e,r)&&"string"==typeof e[r]&&e[r])switch(r.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[r],n.text=r;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[r],n.html=r;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[r],n.rtf=r}return{data:t,formatMap:n}}},ut=function(e,t){if("object"!=typeof e||!e||"object"!=typeof t||!t)return e;var n={};for(var r in e)if(g.call(e,r)){if("success"!==r&&"data"!==r){n[r]=e[r];continue}n[r]={};var a=e[r];for(var i in a)i&&g.call(a,i)&&g.call(t,i)&&(n[r][t[i]]=a[i])}return n},ct=function(e,t){var n=null==t||t&&t.cacheBust===!0;return n?(-1===e.indexOf("?")?"?":"&")+"noCache="+k():""},ft=function(e){var t,n,r,i,o="",l=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?i=[e.trustedDomains]:"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(i=e.trustedDomains)),i&&i.length)for(t=0,n=i.length;n>t;t++)if(g.call(i,t)&&i[t]&&"string"==typeof i[t]){if(r=pt(i[t]),!r)continue;if("*"===r){l=[r];break}l.push.apply(l,[r,"//"+r,a.location.protocol+"//"+r])}return l.length&&(o+="trustedOrigins="+f(l.join(","))),e.forceEnhancedClipboard===!0&&(o+=(o?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(o+=(o?"&":"")+"swfObjectId="+f(e.swfObjectId)),o},pt=function(e){if(null==e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=-1===t?e:e.slice(t+2);var n=e.indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},dt=function(){var e=function(e,t){var n,r,a;if(null!=e&&"*"!==t[0]&&("string"==typeof e&&(e=[e]),"object"==typeof e&&"number"==typeof e.length))for(n=0,r=e.length;r>n;n++)if(g.call(e,n)&&(a=pt(e[n]))){if("*"===a){t.length=0,t.push("*");break}-1===w(a,t)&&t.push(a)}};return function(t,n){var r=pt(n.swfPath);null===r&&(r=t);var a=[];e(n.trustedOrigins,a),e(n.trustedDomains,a);var i=a.length;if(i>0){if(1===i&&"*"===a[0])return"always";if(-1!==w(t,a))return 1===i&&t===r?"sameDomain":"always"}return"never"}}(),ht=function(){try{return i.activeElement}catch(e){return null}},yt=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&"string"==typeof t){var n=(t||"").split(/\s+/);if(1===e.nodeType)if(e.className){for(var r=" "+e.className+" ",a=e.className,i=0,o=n.length;o>i;i++)r.indexOf(" "+n[i]+" ")<0&&(a+=" "+n[i]);e.className=a.replace(/^\s+|\s+$/g,"")}else e.className=t}return e},vt=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if("string"==typeof t&&t){var n=t.split(/\s+/);if(1===e.nodeType&&e.className){for(var r=(" "+e.className+" ").replace(/[\n\t]/g," "),a=0,i=n.length;i>a;a++)r=r.replace(" "+n[a]+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}}return e},gt=function(){var e=/\-([a-z])/g,t=function(e,t){return t.toUpperCase()};return function(n){return n.replace(e,t)}}(),mt=function(e,t){var n,r,i;return a.getComputedStyle?n=a.getComputedStyle(e,null).getPropertyValue(t):(r=gt(t),n=e.currentStyle?e.currentStyle[r]:e.style[r]),"cursor"!==t||n&&"auto"!==n||(i=e.tagName.toLowerCase(),"a"!==i)?n:"pointer"},bt=function(){var e,t,n,r=1;return"function"==typeof i.body.getBoundingClientRect&&(e=i.body.getBoundingClientRect(),t=e.right-e.left,n=i.body.offsetWidth,r=p.round(t/n*100)/100),r},wt=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n,r,o,l=e.getBoundingClientRect();"pageXOffset"in a&&"pageYOffset"in a?(n=a.pageXOffset,r=a.pageYOffset):(o=bt(),n=p.round(i.documentElement.scrollLeft/o),r=p.round(i.documentElement.scrollTop/o));var s=i.documentElement.clientLeft||0,u=i.documentElement.clientTop||0;t.left=l.left+n-s,t.top=l.top+r-u,t.width="width"in l?l.width:l.right-l.left,t.height="height"in l?l.height:l.bottom-l.top}return t},Ct=function(){var e;if(r&&(e=it(O.bridge))){var t=wt(r);C(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+Et(F.zIndex)})}},xt=function(e){O.ready===!0&&(O.bridge&&"function"==typeof O.bridge.setHandCursor?O.bridge.setHandCursor(e):O.ready=!1)},Et=function(e){if(/^(?:auto|inherit)$/.test(e))return e;var t;return"number"!=typeof e||c(e)?"string"==typeof e&&(t=Et(s(e,10))):t=e,"number"==typeof t?t:"auto"},Tt=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function r(e){e&&(s=!0,e.version&&(p=t(e.version)),!p&&e.description&&(p=t(e.description)),e.filename&&(f=n(e.filename)))}var a,i,l,s=!1,c=!1,f=!1,p="";if(o.plugins&&o.plugins.length)a=o.plugins["Shockwave Flash"],r(a),o.plugins["Shockwave Flash 2.0"]&&(s=!0,p="2.0.0.11");else if(o.mimeTypes&&o.mimeTypes.length)l=o.mimeTypes["application/x-shockwave-flash"],a=l&&l.enabledPlugin,r(a);else if("undefined"!=typeof e){c=!0;try{i=new e("ShockwaveFlash.ShockwaveFlash.7"),s=!0,p=t(i.GetVariable("$version"))}catch(d){try{i=new e("ShockwaveFlash.ShockwaveFlash.6"),s=!0,p="6.0.21"}catch(h){try{i=new e("ShockwaveFlash.ShockwaveFlash"),s=!0,p=t(i.GetVariable("$version"))}catch(y){c=!1}}}}O.disabled=s!==!0,O.outdated=p&&u(p)<u(N),O.version=p||"0.0.0",O.pluginType=f?"pepper":c?"activex":s?"netscape":"unknown"};Tt(h);var jt=function(){return this instanceof jt?void("function"==typeof jt._createClient&&jt._createClient.apply(this,b(arguments))):new jt};jt.version="2.0.0",I(jt,"version"),jt.config=function(){return X.apply(this,b(arguments))},jt.state=function(){return A.apply(this,b(arguments))},jt.isFlashUnusable=function(){return Y.apply(this,b(arguments))},jt.on=function(){return $.apply(this,b(arguments))},jt.off=function(){return B.apply(this,b(arguments))},jt.handlers=function(){return M.apply(this,b(arguments))},jt.emit=function(){return H.apply(this,b(arguments))},jt.create=function(){return P.apply(this,b(arguments))},jt.destroy=function(){return Z.apply(this,b(arguments))},jt.setData=function(){return R.apply(this,b(arguments))},jt.clearData=function(){return V.apply(this,b(arguments))},jt.activate=function(){return K.apply(this,b(arguments))},jt.deactivate=function(){return U.apply(this,b(arguments))};var Dt=0,It={},kt=0,Ot={},Nt={};C(F,{autoActivate:!0});var Lt=function(e){var t=this;t.id=""+Dt++,It[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),jt.on("*",function(e){return t.emit(e)}),jt.on("destroy",function(){t.destroy()}),jt.create()},zt=function(e,t){var n,r,a,i={},o=It[this.id]&&It[this.id].handlers;if("string"==typeof e&&e)a=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(a&&a.length){for(n=0,r=a.length;r>n;n++)e=a[n].replace(/^on/,""),i[e]=!0,o[e]||(o[e]=[]),o[e].push(t);if(i.ready&&O.ready&&this.emit({type:"ready",client:this}),i.error){var l=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,r=l.length;r>n;n++)if(O[l[n]]){this.emit({type:"error",name:"flash-"+l[n],client:this});break}}}return this},_t=function(e,t){var n,r,a,i,o,l=It[this.id]&&It[this.id].handlers;if(0===arguments.length)i=j(l);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(i&&i.length)for(n=0,r=i.length;r>n;n++)if(e=i[n].toLowerCase().replace(/^on/,""),o=l[e],o&&o.length)if(t)for(a=w(t,o);-1!==a;)o.splice(a,1),a=w(t,o,a);else o.length=0;return this},St=function(e){var t=null,n=It[this.id]&&It[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:x(n)),t},Ft=function(e){if(Bt.call(this,e)){"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(e=C({},e));var t=C({},J(e),{client:this});Mt.call(this,t)}return this},Xt=function(e){e=Ht(e);for(var t=0;t<e.length;t++)if(g.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===w(this.id,Ot[e[t].zcClippingId])&&Ot[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+kt++,Ot[e[t].zcClippingId]=[this.id],F.autoActivate===!0&&Rt(e[t]));var n=It[this.id]&&It[this.id].elements;-1===w(e[t],n)&&n.push(e[t])}return this},At=function(e){var t=It[this.id];if(!t)return this;var n,r=t.elements;e="undefined"==typeof e?r.slice(0):Ht(e);for(var a=e.length;a--;)if(g.call(e,a)&&e[a]&&1===e[a].nodeType){for(n=0;-1!==(n=w(e[a],r,n));)r.splice(n,1);var i=Ot[e[a].zcClippingId];if(i){for(n=0;-1!==(n=w(this.id,i,n));)i.splice(n,1);0===i.length&&(F.autoActivate===!0&&Vt(e[a]),delete e[a].zcClippingId)}}return this},Yt=function(){var e=It[this.id];return e&&e.elements?e.elements.slice(0):[]},$t=function(){this.unclip(),this.off(),delete It[this.id]},Bt=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=It[this.id]&&It[this.id].elements,n=!!t&&t.length>0,r=!e.target||n&&-1!==w(e.target,t),a=e.relatedTarget&&n&&-1!==w(e.relatedTarget,t),i=e.client&&e.client===this;return r||a||i?!0:!1},Mt=function(e){if("object"==typeof e&&e&&e.type){var t=Q(e),n=It[this.id]&&It[this.id].handlers["*"]||[],r=It[this.id]&&It[this.id].handlers[e.type]||[],i=n.concat(r);if(i&&i.length){var o,l,s,u,c,f=this;for(o=0,l=i.length;l>o;o++)s=i[o],u=f,"string"==typeof s&&"function"==typeof a[s]&&(s=a[s]),"object"==typeof s&&s&&"function"==typeof s.handleEvent&&(u=s,s=s.handleEvent),"function"==typeof s&&(c=C({},e),et(s,u,[c],t))}return this}},Ht=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},Pt=function(e,t,n){return e&&1===e.nodeType?(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),e):e},Zt=function(e,t,n){return e&&1===e.nodeType?(e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n),e):e},Rt=function(e){if(e&&1===e.nodeType){var t=function(t){(t||a.event)&&jt.activate(e)};Pt(e,"mouseover",t),Nt[e.zcClippingId]={mouseover:t}}},Vt=function(e){if(e&&1===e.nodeType){var t=Nt[e.zcClippingId];"object"==typeof t&&t&&("function"==typeof t.mouseover&&Zt(e,"mouseover",t.mouseover),delete Nt[e.zcClippingId])}};jt._createClient=function(){Lt.apply(this,b(arguments))},jt.prototype.on=function(){return zt.apply(this,b(arguments))},jt.prototype.off=function(){return _t.apply(this,b(arguments))},jt.prototype.handlers=function(){return St.apply(this,b(arguments))},jt.prototype.emit=function(){return Ft.apply(this,b(arguments))},jt.prototype.clip=function(){return Xt.apply(this,b(arguments))},jt.prototype.unclip=function(){return At.apply(this,b(arguments))},jt.prototype.elements=function(){return Yt.apply(this,b(arguments))},jt.prototype.destroy=function(){return $t.apply(this,b(arguments))},jt.prototype.setText=function(e){return jt.setData("text/plain",e),this},jt.prototype.setHtml=function(e){return jt.setData("text/html",e),this},jt.prototype.setRichText=function(e){return jt.setData("application/rtf",e),this},jt.prototype.setData=function(){return jt.setData.apply(this,b(arguments)),this},jt.prototype.clearData=function(){return jt.clearData.apply(this,b(arguments)),this},jt.prototype.getFlashState=function(){return O},"function"==typeof define&&define.amd?define(function(){return jt}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=jt:e.ZeroClipboard=jt}(function(){return this}())}}});
;_.Module.define({path:"common/widget/tbcopy",requires:["common/widget/tbcopy/ZeroClipboard"],sub:{text:"",initial:function(t){var e=$(t.ele),i=t.text,n=this.requireInstance("common/widget/tbcopy/ZeroClipboard"),c=n.get();this.clip=new c(e),this.setText(i)},add:function(t){var e=$(t);return e.length?(this.clip.clip(e),this):!1},remove:function(t){var e=$(t);return"undefined"==typeof t||e.length?(this.clip.unclip(t),this):!1},elements:function(){return $(this.clip.elements())},setText:function(t){var e=this;return this.clip.off("copy"),this.clip.on("copy",function(i){if("function"==typeof t)e.text=t(i);else{if("string"!=typeof t)return!1;e.text=t}i.clipboardData.setData("text/plain",e.text),e.successCallback?e.successCallback():$.dialog.alert("\u590D\u5236\u6210\u529F\uFF01")}),!0},getText:function(){return this.text},getFlashElement:function(){var t=this.clip.getFlashState();return t.bridge},setSuccessCallback:function(t){return this.successCallback=t,!0}}});_.Module.define({path:"common/widget/tbshare",requires:["common/widget/tbshare/tbshare_share","common/widget/tbshare/tbshare_more","common/widget/tbshare/tbshare_all"],sub:{initial:function(e,n){this._addShareComponent(e,n)},_addShareComponent:function(e,n){this.shareInstance=this.requireInstance("common/widget/tbshare/tbshare_share",[n]),this._initMoreInstance(n.moreConfig,n.shareContent);var t=n.moreConfig&&n.moreConfig.position;this._addAllInstanceToContainer(e,t)},_initMoreInstance:function(e,n){e&&(this.moreInstance=this.requireInstance("common/widget/tbshare/tbshare_more",[e]),this.moreInstance.setShareContent(n))},_addMoreInstanceToShareInstance:function(e){if(!this.moreInstance)return!1;if(e){var n=["before","after"],t=$.inArray(e,n);if(0==t)this.shareInstance.$dom.before(this.moreInstance.$dom);else{if(1!=t)throw new Error("moreInstance position error,should be in ["+n.join(",")+"]");this.shareInstance.$dom.after(this.moreInstance.$dom)}}else this.shareInstance.$dom.after(this.moreInstance.$dom)},_addAllInstanceToContainer:function(e,n){var t=$('<div class="tbshare clearfix"></div>');this.shareInstance.$dom.appendTo(t),this._addMoreInstanceToShareInstance(n),t.appendTo(e)},setShareContent:function(e){return this.shareInstance&&this.shareInstance.setShareContent(e),this.moreInstance&&this.moreInstance.setShareContent(e),this},share:function(e){return this.shareInstance?this.shareInstance.share(e):this.moreInstance&&this.moreInstance.shareInstance.share(e),this},showMore:function(){return this.moreInstance?this.moreInstance.showMore():!1},showAll:function(){return this.moreInstance?this.moreInstance.showAll():!1}}});
;var QRCode;!function(){function t(t){this.mode=u.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;r>e;e++){var o=[],n=this.data.charCodeAt(e);n>65536?(o[0]=240|(1835008&n)>>>18,o[1]=128|(258048&n)>>>12,o[2]=128|(4032&n)>>>6,o[3]=128|63&n):n>2048?(o[0]=224|(61440&n)>>>12,o[1]=128|(4032&n)>>>6,o[2]=128|63&n):n>128?(o[0]=192|(1984&n)>>>6,o[1]=128|63&n):o[0]=n,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function r(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function o(t,e){this.totalCount=t,this.dataCount=e}function n(){this.buffer=[],this.length=0}function i(){return"undefined"!=typeof CanvasRenderingContext2D}function a(){var t=!1,e=navigator.userAgent;return/android/i.test(e)&&(t=!0,aMat=e.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(t=parseFloat(aMat[1]))),t}function s(t,e){for(var r=1,o=h(t),n=0,i=p.length;i>=n;n++){var a=0;switch(e){case l.L:a=p[n][0];break;case l.M:a=p[n][1];break;case l.Q:a=p[n][2];break;case l.H:a=p[n][3]}if(a>=o)break;r++}if(r>p.length)throw new Error("Too long data");return r}function h(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}t.prototype={getLength:function(){return this.parsedData.length},write:function(t){for(var e=0,r=this.parsedData.length;r>e;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var r=new t(e);this.dataList.push(r),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,r){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[o][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,r),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,r)},setupPositionProbePattern:function(t,e){for(var r=-1;7>=r;r++)if(!(-1>=t+r||this.moduleCount<=t+r))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(this.modules[t+r][e+o]=r>=0&&6>=r&&(0==o||6==o)||o>=0&&6>=o&&(0==r||6==r)||r>=2&&4>=r&&o>=2&&4>=o?!0:!1)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;8>r;r++){this.makeImpl(!0,r);var o=f.getLostPoint(this);(0==r||t>o)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){var o=t.createEmptyMovieClip(e,r),n=1;this.make();for(var i=0;i<this.modules.length;i++)for(var a=i*n,s=0;s<this.modules[i].length;s++){var h=s*n,u=this.modules[i][s];u&&(o.beginFill(0,100),o.moveTo(h,a),o.lineTo(h+n,a),o.lineTo(h+n,a+n),o.lineTo(h,a+n),o.endFill())}return o},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=f.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],n=t[r];if(null==this.modules[o][n])for(var i=-2;2>=i;i++)for(var a=-2;2>=a;a++)this.modules[o+i][n+a]=-2==i||2==i||-2==a||2==a||0==i&&0==a?!0:!1}},setupTypeNumber:function(t){for(var e=f.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(var r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var r=this.errorCorrectLevel<<3|e,o=f.getBCHTypeInfo(r),n=0;15>n;n++){var i=!t&&1==(o>>n&1);6>n?this.modules[n][8]=i:8>n?this.modules[n+1][8]=i:this.modules[this.moduleCount-15+n][8]=i}for(var n=0;15>n;n++){var i=!t&&1==(o>>n&1);8>n?this.modules[8][this.moduleCount-n-1]=i:9>n?this.modules[8][15-n-1+1]=i:this.modules[8][15-n-1]=i}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,n=7,i=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;2>s;s++)if(null==this.modules[o][a-s]){var h=!1;i<t.length&&(h=1==(t[i]>>>n&1));var u=f.getMask(e,o,a-s);u&&(h=!h),this.modules[o][a-s]=h,n--,-1==n&&(i++,n=7)}if(o+=r,0>o||this.moduleCount<=o){o-=r,r=-r;break}}}},e.PAD0=236,e.PAD1=17,e.createData=function(t,r,i){for(var a=o.getRSBlocks(t,r),s=new n,h=0;h<i.length;h++){var u=i[h];s.put(u.mode,4),s.put(u.getLength(),f.getLengthInBits(u.mode,t)),u.write(s)}for(var l=0,h=0;h<a.length;h++)l+=a[h].dataCount;if(s.getLengthInBits()>8*l)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*l+")");for(s.getLengthInBits()+4<=8*l&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*l)break;if(s.put(e.PAD0,8),s.getLengthInBits()>=8*l)break;s.put(e.PAD1,8)}return e.createBytes(s,a)},e.createBytes=function(t,e){for(var o=0,n=0,i=0,a=new Array(e.length),s=new Array(e.length),h=0;h<e.length;h++){var u=e[h].dataCount,l=e[h].totalCount-u;n=Math.max(n,u),i=Math.max(i,l),a[h]=new Array(u);for(var g=0;g<a[h].length;g++)a[h][g]=255&t.buffer[g+o];o+=u;var d=f.getErrorCorrectPolynomial(l),c=new r(a[h],d.getLength()-1),p=c.mod(d);s[h]=new Array(d.getLength()-1);for(var g=0;g<s[h].length;g++){var m=g+p.getLength()-s[h].length;s[h][g]=m>=0?p.get(m):0}}for(var v=0,g=0;g<e.length;g++)v+=e[g].totalCount;for(var _=new Array(v),C=0,g=0;n>g;g++)for(var h=0;h<e.length;h++)g<a[h].length&&(_[C++]=a[h][g]);for(var g=0;i>g;g++)for(var h=0;h<e.length;h++)g<s[h].length&&(_[C++]=s[h][g]);return _};for(var u={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},l={L:1,M:0,Q:3,H:2},g={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},f={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;f.getBCHDigit(e)-f.getBCHDigit(f.G15)>=0;)e^=f.G15<<f.getBCHDigit(e)-f.getBCHDigit(f.G15);return(t<<10|e)^f.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;f.getBCHDigit(e)-f.getBCHDigit(f.G18)>=0;)e^=f.G18<<f.getBCHDigit(e)-f.getBCHDigit(f.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return f.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case g.PATTERN000:return(e+r)%2==0;case g.PATTERN001:return e%2==0;case g.PATTERN010:return r%3==0;case g.PATTERN011:return(e+r)%3==0;case g.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case g.PATTERN101:return e*r%2+e*r%3==0;case g.PATTERN110:return(e*r%2+e*r%3)%2==0;case g.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new r([1],0),o=0;t>o;o++)e=e.multiply(new r([1,d.gexp(o)],0));return e},getLengthInBits:function(t,e){if(e>=1&&10>e)switch(t){case u.MODE_NUMBER:return 10;case u.MODE_ALPHA_NUM:return 9;case u.MODE_8BIT_BYTE:return 8;case u.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>e)switch(t){case u.MODE_NUMBER:return 12;case u.MODE_ALPHA_NUM:return 11;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>e))throw new Error("type:"+e);switch(t){case u.MODE_NUMBER:return 14;case u.MODE_ALPHA_NUM:return 13;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;e>o;o++)for(var n=0;e>n;n++){for(var i=0,a=t.isDark(o,n),s=-1;1>=s;s++)if(!(0>o+s||o+s>=e))for(var h=-1;1>=h;h++)0>n+h||n+h>=e||(0!=s||0!=h)&&a==t.isDark(o+s,n+h)&&i++;i>5&&(r+=3+i-5)}for(var o=0;e-1>o;o++)for(var n=0;e-1>n;n++){var u=0;t.isDark(o,n)&&u++,t.isDark(o+1,n)&&u++,t.isDark(o,n+1)&&u++,t.isDark(o+1,n+1)&&u++,(0==u||4==u)&&(r+=3)}for(var o=0;e>o;o++)for(var n=0;e-6>n;n++)t.isDark(o,n)&&!t.isDark(o,n+1)&&t.isDark(o,n+2)&&t.isDark(o,n+3)&&t.isDark(o,n+4)&&!t.isDark(o,n+5)&&t.isDark(o,n+6)&&(r+=40);for(var n=0;e>n;n++)for(var o=0;e-6>o;o++)t.isDark(o,n)&&!t.isDark(o+1,n)&&t.isDark(o+2,n)&&t.isDark(o+3,n)&&t.isDark(o+4,n)&&!t.isDark(o+5,n)&&t.isDark(o+6,n)&&(r+=40);for(var l=0,n=0;e>n;n++)for(var o=0;e>o;o++)t.isDark(o,n)&&l++;var g=Math.abs(100*l/e/e-50)/5;return r+=10*g}},d={glog:function(t){if(1>t)throw new Error("glog("+t+")");return d.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return d.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},c=0;8>c;c++)d.EXP_TABLE[c]=1<<c;for(var c=8;256>c;c++)d.EXP_TABLE[c]=d.EXP_TABLE[c-4]^d.EXP_TABLE[c-5]^d.EXP_TABLE[c-6]^d.EXP_TABLE[c-8];for(var c=0;255>c;c++)d.LOG_TABLE[d.EXP_TABLE[c]]=c;r.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),o=0;o<this.getLength();o++)for(var n=0;n<t.getLength();n++)e[o+n]^=d.gexp(d.glog(this.get(o))+d.glog(t.get(n)));return new r(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=d.glog(this.get(0))-d.glog(t.get(0)),o=new Array(this.getLength()),n=0;n<this.getLength();n++)o[n]=this.get(n);for(var n=0;n<t.getLength();n++)o[n]^=d.gexp(d.glog(t.get(n))+e);return new r(o,0).mod(t)}},o.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],o.getRSBlocks=function(t,e){var r=o.getRsBlockTable(t,e);if(void 0==r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var n=r.length/3,i=[],a=0;n>a;a++)for(var s=r[3*a+0],h=r[3*a+1],u=r[3*a+2],l=0;s>l;l++)i.push(new o(h,u));return i},o.getRsBlockTable=function(t,e){switch(e){case l.L:return o.RS_BLOCK_TABLE[4*(t-1)+0];case l.M:return o.RS_BLOCK_TABLE[4*(t-1)+1];case l.Q:return o.RS_BLOCK_TABLE[4*(t-1)+2];case l.H:return o.RS_BLOCK_TABLE[4*(t-1)+3];default:return void 0}},n.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;e>r;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],m=function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){function e(t,e){var r=document.createElementNS("http://www.w3.org/2000/svg",t);for(var o in e)e.hasOwnProperty(o)&&r.setAttribute(o,e[o]);return r}{var r=this._htOption,o=this._el,n=t.getModuleCount();Math.floor(r.width/n),Math.floor(r.height/n)}this.clear();var i=e("svg",{viewBox:"0 0 "+String(n)+" "+String(n),width:"100%",height:"100%",fill:r.colorLight});i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),o.appendChild(i),i.appendChild(e("rect",{fill:r.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;n>a;a++)for(var s=0;n>s;s++)if(t.isDark(a,s)){var h=e("use",{x:String(a),y:String(s)});h.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),i.appendChild(h)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),v="svg"===document.documentElement.tagName.toLowerCase(),_=v?m:i()?function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function e(t,e){var r=this;if(r._fFail=e,r._fSuccess=t,null===r._bSupportDataURI){var o=document.createElement("img"),n=function(){r._bSupportDataURI=!1,r._fFail&&_fFail.call(r)},i=function(){r._bSupportDataURI=!0,r._fSuccess&&r._fSuccess.call(r)};return o.onabort=n,o.onerror=n,o.onload=i,void(o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}r._bSupportDataURI===!0&&r._fSuccess?r._fSuccess.call(r):r._bSupportDataURI===!1&&r._fFail&&r._fFail.call(r)}if(this._android&&this._android<=2.1){var r=1/window.devicePixelRatio,o=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,e,n,i,a,s,h,u){if("nodeName"in t&&/img/i.test(t.nodeName))for(var l=arguments.length-1;l>=1;l--)arguments[l]=arguments[l]*r;else"undefined"==typeof u&&(arguments[1]*=r,arguments[2]*=r,arguments[3]*=r,arguments[4]*=r);o.apply(this,arguments)}}var n=function(t,e){this._bIsPainted=!1,this._android=a(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return n.prototype.draw=function(t){var e=this._elImage,r=this._oContext,o=this._htOption,n=t.getModuleCount(),i=o.width/n,a=o.height/n,s=Math.round(i),h=Math.round(a);e.style.display="none",this.clear();for(var u=0;n>u;u++)for(var l=0;n>l;l++){var g=t.isDark(u,l),f=l*i,d=u*a;r.strokeStyle=g?o.colorDark:o.colorLight,r.lineWidth=1,r.fillStyle=g?o.colorDark:o.colorLight,r.fillRect(f,d,i,a),r.strokeRect(Math.floor(f)+.5,Math.floor(d)+.5,s,h),r.strokeRect(Math.ceil(f)-.5,Math.ceil(d)-.5,s,h)}this._bIsPainted=!0},n.prototype.makeImage=function(){this._bIsPainted&&e.call(this,t)},n.prototype.isPainted=function(){return this._bIsPainted},n.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},n.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},n}():function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){for(var e=this._htOption,r=this._el,o=t.getModuleCount(),n=Math.floor(e.width/o),i=Math.floor(e.height/o),a=['<table style="border:0;border-collapse:collapse;">'],s=0;o>s;s++){a.push("<tr>");for(var h=0;o>h;h++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+n+"px;height:"+i+"px;background-color:"+(t.isDark(s,h)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),r.innerHTML=a.join("");var u=r.childNodes[0],l=(e.width-u.offsetWidth)/2,g=(e.height-u.offsetHeight)/2;l>0&&g>0&&(u.style.margin=g+"px "+l+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}();QRCode=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.H},"string"==typeof e&&(e={text:e}),e)for(var r in e)this._htOption[r]=e[r];"string"==typeof t&&(t=document.getElementById(t)),this._android=a(),this._el=t,this._oQRCode=null,this._oDrawing=new _(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(t){this._oQRCode=new e(s(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=l}();
;_.Module.define({path:"common/widget/tbshare/tbshare_share",requires:["common/widget/tbcopy"],sub:{_baseConfig:{Parnter:{qqzone:{title:"QQ\u7A7A\u95F4",urlTmp:["http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?","url=#{url}&title=#{text}&desc=#{desc}","&summary=#{summary}&site=#{site}&pics=#{pics}"].join("")},tsina:{title:"\u65B0\u6D6A\u5FAE\u535A",urlTmp:["http://service.weibo.com/share/share.php?","url=#{url}&title=#{text}","&pic=#{pics}"].join("")},renren:{title:"\u4EBA\u4EBA\u7F51",urlTmp:["http://widget.renren.com/dialog/share?","resourceUrl=#{url}&srcUrl=#{url}&title=#{text}&description=","&pic=#{pics}"].join("")},tieba:{title:"\u767E\u5EA6\u8D34\u5427",urlTmp:["//tieba.baidu.com/f/commit/share/openShareApi?","url=#{url}&title=#{text}&desc=#{desc}","&comment=#{summary}&pic=#{pics}"].join("")},weixin:{title:"\u5FAE\u4FE1",urlTmp:[].join("")},copy:{title:"\u590D\u5236\u94FE\u63A5",urlTmp:[].join(""),attr:'onclick="return false;"'},douban:{title:"\u8C46\u74E3",urlTmp:["http://www.douban.com/share/service?","href=#{url}&name=#{text}&text=#{desc}","&image=#{pics}"].join("")},tsohu:{title:"\u641C\u72D0\u5FAE\u535A",urlTmp:["http://t.sohu.com/third/post.jsp?","url=#{url}&title=#{text}","&pic=#{pics}"].join("")}},tmp:{base:['<ul class="">#{share_btns}</ul>'].join(""),btn:['<div class="tbshare_#{short_name} tbshare_icon" #{attr} title="#{title}" data-share="#{short_name}">',"#{text}",'<div class="tbshare_title_box">#{title}</div>',"</div>"].join(""),qrcode:['<div class="tbshare_qrcode_mask">','<div class="tbshare_qrcode_outer">','<div class="tbshare_qrcode_wrapper">',"<h6>\u626B\u4E00\u626B\u5206\u4EAB\u5230\u5FAE\u4FE1</h6>",'<div class="tbshare_qrcode_content"></div>','<div class="tbshare_qrcode_instruction">',"<p>\u6253\u5F00\u5FAE\u4FE1\uFF0C\u70B9\u51FB\u5E95\u90E8\u7684\u201C\u53D1\u73B0\u201D\uFF0C<br/>\u4F7F\u7528\u201C\u626B\u4E00\u626B\u201D\u5373\u53EF\u5C06\u7F51\u9875\u5206\u4EAB\u81F3\u670B\u53CB\u5708\u3002</p>","</div>",'<div class="tbshare_qrcode_close">&#215;</div>',"</div>","</div>",'<div class="tbshare_qrcode_triangle"></div>',"</div>"].join("")},common:{text:document.title,desc:document.title,url:$.tb.location.getHref(),pics:""}},qrcodeSize:90,classList:{normal:"tbshare_wrapper",coco:"tbshare_wrapper_theme_coco"},typeClassList:{normal:"",vertical:"vertical"},initial:function(t){if(t=$.extend({theme:"normal",type:"normal",initialQrcode:!0},t),this.className=this.classList[t.theme],this.typeClass=this.typeClassList[t.type],!t)throw new Error("no tbShare args provided");this.shareContent=$.extend({},this._baseConfig.common,t.shareContent),this.$dom=this._createShareComponent(t.targets),t.initialQrcode&&(this.$qrcode=this._createQrcodeWrapper(),this.$qrcode.appendTo(this.$dom)),this._bindEvents()},getQrcode:function(){return this.$qrcode||(this.$qrcode=this._createQrcodeWrapper(),this.$qrcode.appendTo(this.$dom)),this.$qrcode},share:function(t){var e=this.shareContent||this._baseConfig.common;if("weixin"==t)return this.getQrcode().show(),!1;if("copy"==t)return prompt("\u8BF7\u6309\u4E0B Ctrl+C \u590D\u5236\u94FE\u63A5\u5230\u9ECF\u8D34\u677F",e.url),!1;var i=this._baseConfig.Parnter[t];e=$.extend({},e),e.url+=-1!==e.url.indexOf("?")?"&sharefrom="+t:"?sharefrom="+t,e=this._dataEncodeURI(e),e=$.extend({},e);var r=$.tb.format(i.urlTmp,e);return window.open(r),!1},_createShareComponent:function(t){for(var e="",i="",r="",o=0,s=t.length;s>o;o++)"[object Array]"==Object.prototype.toString.call(t[o])?(i=t[o][0],r=t[o][1]):(i=t[o],r=""),this._baseConfig.Parnter[i]&&(e+=["<li>",$.tb.format(this._baseConfig.tmp.btn,{short_name:i,text:r,title:this._baseConfig.Parnter[i].title,attr:this._baseConfig.Parnter[i].attr||""}),"</li>"].join(""));var n=$.tb.format(this._baseConfig.tmp.base,{share_btns:e}),a=$("<div></div>").addClass(this.className).addClass(this.typeClass).append(n);return a},_createQrcodeWrapper:function(){var t=$(this._baseConfig.tmp.qrcode),e=this.shareContent.url,i=this.qrcodeSize;return $.JsLoadManager.use("//tb1.bdstatic.com/tb/_/qrcode_fdc9a64.js",function(){new window.QRCode(t.find(".tbshare_qrcode_content")[0],{text:e||"//tieba.baidu.com",width:i,height:i})}),t.on("click",".tbshare_qrcode_mask",function(){t.hide()}),t.on("click",".tbshare_qrcode_close",function(){t.hide()}),t},setQrcodeContent:function(t){var e=this.getQrcode().find(".tbshare_qrcode_content"),i=this.qrcodeSize,r=e.find("img"),o=this;r.length?(r.remove(),e.find("canvas").remove(),new window.QRCode(e[0],{text:t,width:i,height:i})):setTimeout(function(t){o.setQrcodeContent(t)},500,t)},_dataEncodeURI:function(t){var e={};for(var i in t)e[i]=encodeURIComponent(t[i]);return e},_bindEvents:function(){var t=this;this.$dom.on("click",".tbshare_icon",function(){var e=$(this).data("share");$.getJSON("/fex/check/isRealName",function(i){if(i.data!==!1||1!==PageData.user.is_login)return e=e||"tieba",t.share(e);if("undefined"==typeof passport||"undefined"==typeof passport.pop.init){var r="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime(),o="https://passport";$.JsLoadManager.use([o+".baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(r/6e4),o+".baidu.com/passApi/js/wrapper.js?cdnversion="+Math.floor(r/6e4)],function(){window.realname=passport.pop.init({type:"accRealName",apiOpt:{product:"tb",staticPage:"//tieba.baidu.com/tb/static-common/html/pass/v3Jump.html"},tangram:!0,color:"green"}),window.realname.show()},!0,"utf-8")}else window.realname.show()})})},_lazyAddTbcopyOnce:function(t){this.tbcopy=this.requireInstance("common/widget/tbcopy",{ele:t,text:$.tb.location.getHref()})},_AddTbcopyOnce:function(){var t=this.$dom.find(".tbshare_copy");this.tbcopy=this.requireInstance("common/widget/tbcopy",{ele:t,text:$.tb.location.getHref()}),this.copyElement=this.tbcopy.getFlashElement()},_getPageImgSrc:function(t){var e=[];return $("img").each(function(i){t>i&&e.push($(this).tbattr("src"))}),e},setShareContent:function(t){return"[object Object]"==Object.prototype.toString.call(t)&&$.extend(this.shareContent,t),t&&t.url!=this.shareContent.url&&this.setQrcodeContent(this.shareContent.url),this.shareContent},hideQrcode:function(){this.getQrcode().hide()}}});
;_.Module.define({path:"common/widget/tbshare/tbshare_more",requires:["common/widget/tbshare/tbshare_share","common/widget/tbshare/tbshare_all"],sub:{_tmp:['<div class="tbshare_more_wrapper">','<a class="tbshare_more_enter" href="#" title="\u66F4\u591A">#{text}</a>','<div class="tbshare_float_wrapper tbshare_more_right"></div>','<div class="tbshare_slide_main">','<div class="tbshare_more_main">','<div class="tbshare_header">',"<h6>\u5206\u4EAB\u5230</h6>","</div>",'<div class="tbshare_main clearfix">',"</div>",'<div class="tbshare_footer"></div>',"</div>","</div>",'<div class="tbshare_float_wrapper tbshare_more_left"></div>',"</div>"].join(""),moreColumnWidth:[120,218],_args:{targets:[["qqzone","QQ\u7A7A\u95F4"],["tieba","\u767E\u5EA6\u8D34\u5427"],["renren","\u4EBA\u4EBA\u7F51"],["tsina","\u65B0\u6D6A\u5FAE\u535A"],["weixin","\u5FAE\u4FE1"],["douban","\u8C46\u74E3"],["tsohu","\u641C\u72D0\u5FAE\u535A"],["copy","\u590D\u5236"]]},initial:function(t){if(!t)throw new Error("no tbMore args provided");this.args=$.extend({text:"",columnNum:2,$container:null,show:!0,noAll:!1},t),this.$dom=this._createBaseDom(this.args.text),this.$moreWrapper=this._createBaseMoreWrapper(this.args.shareContent,this.args.targets),this.columnNum=this.args.columnNum,this.initMoreWrapperWidth(this.args.columnNum),this.args.slide&&-1!=$.inArray(this.args.slide.type,["left","right"])?(this.slide=this.args.slide,this._initSlide()):(this.args.noAll||(this.allInstance=this.requireInstance("common/widget/tbshare/tbshare_all",[]),this.allInstance.setShareContent(this.args.shareContent)),this._bindNormalEvents()),this._addToContainer()},_createBaseDom:function(t){t=t||"";var e=$.tb.format(this._tmp,{text:t});return $(e)},_createBaseMoreWrapper:function(t,e){return this._args.shareContent=t||{},"undefined"!=typeof e&&(this._args.targets=e),this.shareInstance=this.requireInstance("common/widget/tbshare/tbshare_share",[this._args]),this.shareInstance.$dom.appendTo(this.$dom.find(".tbshare_main")),this.$dom.find(".tbshare_more_main")},_bindNormalEvents:function(){var t=this;this.$dom.on("mouseenter",".tbshare_more_enter",function(){t.showMoreInNicePosition()}).on("click",".tbshare_more_enter",function(){return t.showAll()}).mouseleave(function(e){return $(e.relatedTarget)[0]?void t.hideMore():!1})},_initSlide:function(){this.slideStatus="hide",this.$slideMain=this.$dom.find(".tbshare_slide_main"),this._setSlideStyle(),this._bindSlideEvents()},_setSlideStyle:function(){var t=this.slide.type,e=this.slide.position||"fixed";if(this.$slideBtn=this.$dom.find(".tbshare_more_"+t),this.$slideBtn.show(),this.showMore(),this.$slideMain.css({width:0}),this.$moreWrapper.css({position:"static"}),this.$dom.addClass("tbshare_slide_wrapper"),this.$dom.find(".tbshare_more_enter").hide(),this.$dom.css("right"==t?{right:0}:{left:0}),!$.inArray(e,["absolute","fixed"]))throw new Error("The position setting not be supported");this.$dom.css({position:e})},_bindSlideEvents:function(){var t=this;this.$slideBtn.mouseenter(function(){"show"!=t.slideStatus&&(t.slideStatus="show",t.slideShowMore(t.slide.type))}),this.$dom.mouseleave(function(e){return $(e.relatedTarget)[0]?(t.slideStatus="hide",void t.slideHideMore(t.slide.type)):!1})},_addToContainer:function(){this.args.$container&&this.$dom.appendTo(this.args.$container),this.args.show&&this.show()},show:function(){this.$dom.show()},hide:function(){this.$dom.hide()},showMore:function(t,e){return"undefined"!=typeof t&&"undefined"!=typeof e&&this.$moreWrapper.css({left:t,top:e}),this.$moreWrapper.show(),this.$moreWrapper},showMoreInNicePosition:function(){var t=$(document).scrollTop()+$(window).height(),e=$(document).scrollLeft()+$(window).width(),i={top:this.$dom.offset().top,left:this.$dom.offset().left,width:this.$moreWrapper.width(),height:this.$moreWrapper.height()},s=0,r=0;i.top+i.height>t?r=-i.height:s+=16,i.left+i.width>e&&(s=-i.width,r+=20),this.showMore(s,r)},initMoreWrapperWidth:function(t){if(t&&t>0&&t<=this.moreColumnWidth.length+1){this.columnNum=t;var e=this.moreColumnWidth[this.columnNum-1];this.$moreWrapper.css({width:e})}},slideShowMore:function(t,e){var i=parseInt(this.$moreWrapper.css("width"));if("left"==t);else if("right"!=t)return!1;e&&this.$moreWrapper.css({top:e}),this.columnNum&&(i=this.moreColumnWidth[this.columnNum-1]+2,this.$slideMain.animate({width:i},100,"linear"))},slideHideMore:function(){this.$slideMain.animate({width:0},100,"linear")},hideMore:function(){this.$moreWrapper.hide()},showAll:function(){return this.allInstance&&this.allInstance.showAll(),!1},setShareContent:function(t){return this.shareInstance.setShareContent(t),this.allInstance&&this.allInstance.setShareContent(t),this}}});
;_.Module.define({path:"common/widget/tbshare/tbshare_popup",requires:["common/widget/tbshare/tbshare_share"],sub:{_tmp:['<div class="tbshare_popup_wrapper">','<div class="tbshare_popup_enter"></div>','<div class="tbshare_popup_main clearfix"></div>',"</div>"].join(""),_sharebase_args:{theme:"coco",targets:["tieba","weixin","tsina","qqzone","copy"],initialQrcode:!1},_popup_args:{$container:null,type:"cross",itemIconPosition:"origin"},initial:function(e){if(!e)throw new Error("no tbMore args provided");this.isPostVisible=e.isPostVisible,this._popup_args=$.extend(this._popup_args,{$container:e.$container,type:e.type,itemIconPosition:e.itemIconPosition}),this._sharebase_args=$.extend(this._sharebase_args,{shareContent:e.shareContent||{},targets:e.targets,type:e.type}),this.$dom=this._createBaseDom(),this.$popupWrapper=this._createBaseMoreWrapper(),this._bindEvents(),this._popup_args.$container.append(this.$dom)},_createBaseDom:function(e){e=e||"";var t=this._tmp,s=$(t);return"vertical"==this._popup_args.type&&s.addClass("popup_vertical"),"left"==this._popup_args.itemIconPosition&&s.addClass("popup_icon_left"),s},_createBaseMoreWrapper:function(){return this.shareInstance=this.requireInstance("common/widget/tbshare/tbshare_share",[this._sharebase_args]),this.shareInstance.$dom.appendTo(this.$dom.find(".tbshare_popup_main")),this.$dom.find(".tbshare_popup_main")},_qrcodeShow:function(){this.shareInstance.getQrcode().show(),this.shareInstance.$dom.find(".tbshare_weixin").addClass("hover_on_qrcode")},_qrcodeHide:function(){this.shareInstance.getQrcode().hide(),this.shareInstance.$dom.find(".tbshare_weixin").removeClass("hover_on_qrcode")},_bindEvents:function(){var e=this;this.$dom.on("mouseenter",".tbshare_popup_main li",function(){$(this).find(".tbshare_weixin").length?e._qrcodeShow():e._qrcodeHide()}),this.isPostVisible?this.$dom.on("click",function(){var e='\u64CD\u4F5C\u5931\u8D25,\u8BE6\u89C1<a href="/helpcenter/index#/index">\u4E2A\u4EBA\u4E2D\u5FC3</a>~';$.dialog.alert(e,{title:"\u64CD\u4F5C\u5931\u8D25"})}):(this.$dom.on("mouseenter",function(t){$(this).find($(t.relatedTarget)).length||!$(t.relatedTarget).parent().length,e._qrcodeHide(),e.$popupWrapper.show()}),this.mouseenterInFlash=!1,this.$dom.on("mouseleave",function(t){var s=t.relatedTarget;if(s){if(s==e.shareInstance.copyElement)return void(e.mouseenterInFlash=!0)}else if(e.mouseenterInFlash)return;e.$popupWrapper.hide(),e._reinitialCopy()}));var t=$(this.shareInstance.copyElement);t.parent().on("mouseleave",function(t){var s=t.relatedTarget;e.args.$container.removeClass("copy_mouse_hover"),e.$dom.find($(s))||(e.mouseenterInFlash=!1)}),t.parent().on("mouseenter",function(){e.args.$container.addClass("copy_mouse_hover")})},_reinitialCopy:function(){this.$dom.find(".tbshare_copy .tbshare_title_box").removeClass("copy_done"),this.$dom.find(".tbshare_copy .tbshare_title_box").html("\u590D\u5236\u94FE\u63A5")},_setCopyCallback:function(){var e=this;e.shareInstance.tbcopy.setSuccessCallback(function(){e.$dom.find(".tbshare_copy .tbshare_title_box").addClass("copy_done"),e.$dom.find(".tbshare_copy .tbshare_title_box").html("\u5DF2\u590D\u5236\u94FE\u63A5")})},show:function(){this.$dom.show()},hide:function(){this.$dom.hide()},showMore:function(e,t){return"undefined"!=typeof e&&"undefined"!=typeof t&&this.$moreWrapper.css({left:e,top:t}),this.$moreWrapper.show(),this.$moreWrapper},hideMore:function(){this.$moreWrapper.hide()},setShareContent:function(e){return this.shareInstance.setShareContent(e),this}}});
;_.Module.define({path:"common/widget/tbshare/tbshare_all",requires:["common/widget/tbshare/tbshare_share"],sub:{_tmp:['<div class="tbshare_all_wrapper">',"<h5>\u5206\u4EAB\u5230",'<p class="j_tbshare_all_close"></p>',"</h5>",'<div class="tbshare_all_main"></div>','<div class="tbshare_all_footer"></div>',"</div>"].join(""),_args:{targets:[["qqzone","QQ\u7A7A\u95F4"],["tieba","\u767E\u5EA6\u8D34\u5427"],["renren","\u4EBA\u4EBA\u7F51"],["tsina","\u65B0\u6D6A\u5FAE\u535A"],["weixin","\u5FAE\u4FE1"],["douban","\u8C46\u74E3"],["tsohu","\u641C\u72D0\u5FAE\u535A"],["copy","\u590D\u5236"]]},initial:function(t){t=t||{},this.args=$.extend({show:!1,$container:$("body")},t),this.$container=this.args.$container,this._createElement(),this._bindEvents(),this._addToContainer()},_createElement:function(){this.$dom=$(this._tmp),this.$share_all_main=this.$dom.find(".tbshare_all_main"),this.share=this.requireInstance("common/widget/tbshare/tbshare_share",[this._args]),this.share.$dom.appendTo(this.$share_all_main)},_bindEvents:function(){var t=this;this.$dom.on("click",".j_tbshare_all_close",function(){t.hideAll()})},_addToContainer:function(){this.$container&&this.$container.append(this.$dom),this.args.show&&this.showAll()},setShareContent:function(t){return this.share.setShareContent(t),this},showAll:function(){return this.$dom.show(),this},hideAll:function(){return this.$dom.hide(),this}}});_.Module.define({path:"album/widget/imgLikeAction",requires:["album/component/initApiConfig","common/widget/tbshare"],sub:{_defaultConfig:{sourceURL:"//tieba.baidu.com/p/"+PageData.thread.thread_id,tags:"\u767E\u5EA6\u8D34\u5427,"+PageData.forum.forum_name+"\u5427",descript:$.tb.subByte(PageData.thread.title,40,""),no_pic_pb:PageData.isPicBa?!1:!0,area:[{container:"#j_p_postlist",tag:".BDE_Image",offset:{x:-4,y:5},minSize:{width:170,height:80}},{container:"#j_p_postlist",tag:".j_user_sign",offset:{x:-4,y:5},minSize:{width:170,height:80}}]},initial:function(){var t=this;t.isLogin=PageData.user.is_login,t.hasNoUn=PageData.user.no_un,t.conf=t._defaultConfig,t.isEnabled=!0,t.initApiConf(),t.createLikeButton(),t.initEvent()},initApiConf:function(){var t=this;t.favConfig=t.use("album/component/initApiConfig",{isLogin:t.isLogin,hasNoUn:t.hasNoUn,conf:t.conf})},initEvent:function(){var t=this;t.bindImgEvent(),t.bindPostEvent(),t.addShareButton(),t.mobileDownloadClick(),t.initCustomEmotion()},initCustomEmotion:function(){var t=this,e=$.cookie("tb_lab"),a={};e&&(a=$.json.decode(e)),a.custom_emotion&&(t.favConfig.likeButton.find(".emotion").show(),t.favConfig.likeButton.on("click",".emotion",function(){this.requireInstanceAsync("common/component/CustomEmotion",{},function(e){e.openDialog({forumId:PageData.forum.forum_id,url:t.favConfig.imgUrl})})}))},bindImgEvent:function(){var t=this;$.each(t.favConfig.area,function(e,a){var i=a.container||document.body,n=a.tag;$(i).on("mouseover",n,{index:e},function(e){t.containerMouseover(e)}),$(i).on("mouseleave",n,function(e){t.containerMouseout(e)})})},bindPostEvent:function(){var t=this,e=t.favConfig,a=e.likeButton;a.delegate(".mark","click",function(){if(!e.hasLogin)return e.loginEvent(),void 0;if(e.currentUpImgUrl==e.imgUrl)return!1;var i=e.uploadUrl+"opencom/picture/fav/upload?app_id="+e.appid+"&descript="+encodeURIComponent(e.descript)+"&uid="+PageData.user.user_id+"&source_url="+encodeURIComponent(e.sourceURL)+"&tags="+encodeURIComponent(e.tags)+"&url="+encodeURIComponent(e.imgUrl)+"&callback=?",n={top:parseInt(a.css("top"),10)-e.area[e.currentIndex].offset.y,left:a.offset().left+40};setTimeout(function(){a.addClass("done")},200),$.stats.sendRequest("st_mod=fav_img&fr=tb0_forum&st_type=fav_btn_click"),e.currentUpImgUrl=e.imgUrl,$.getJSON(i,function(a){switch(a.errno){case 0:t.markSuccess(n);break;case 20026:return e.loginEvent(),void 0;case 20028:return t.markFail(n,".n20028"),void 0;default:return t.markFail(n,".ndefault"),void 0}})}).mouseover(function(){if("undefined"==typeof bdRes2Exe){var t=document.getElementsByTagName("body").item(0),a=document.createElement("script");a.type="text/javascript",a.id="bdres2exejs",a["data-proxy"]="//tieba.baidu.com/tb/static-album/proxy.html",a.src="//m.baidu.com/static/as/res2exe/js/res2exe_1.0.4.min.js",a.setAttribute("data-proxy","//tieba.baidu.com/tb/static-album/proxy.html"),t.appendChild(a)}e.showLikeButton()}).mouseout(function(){e.hideLikeButton()}),$("body").delegate(".sr-bdimgshare-layer","mouseover",function(){e.showLikeButton()}).delegate(".sr-bdimgshare-layer","mouseout",function(){e.hideLikeButton()})},markSuccess:function(t){var e=this;e.favConfig.cache[e.favConfig.imgUrl]=1,"1"!=$.cookie("ablum_hls")&&e.favConfig.likeButton.parent().find(".fav-success").fadeIn("fast",function(){var t=$(this);$.cookie("ablum_hls","1",{expires:30}),setTimeout(function(){t.fadeOut()},3e3)}).css(t)},markFail:function(t,e){var a=this,i=a.favConfig.likeButton.parent().find(".fav-fail");i.find(".text").hide(),i.find(e).show(),i.fadeIn("fast",function(){var t=$(this);setTimeout(function(){t.fadeOut()},2e3)}).css(t)},addShareButton:function(){if(PageData&&("v3"==PageData.page||"pb_bright"==PageData.page)){var t=this,e=t.favConfig,a=this.requireInstance("common/widget/tbshare/tbshare_popup",[{$container:e.likeButton.find(".share"),type:"vertical"}]);e.likeButton.find(".share").mouseover(function(){a.setShareContent({pics:e.imgUrl})})}},containerMouseover:function(t){var e=this;if(e.isEnabled){var a=t.currentTarget,i=t.data.index;e.favConfig.resetAndshowLikeButton(a,i)}},containerMouseout:function(){var t=this;t.favConfig.timer&&clearTimeout(t.favConfig.timer),t.favConfig.hideLikeButton()},mobileDownloadClick:function(){var t=this;$(".fav-toolbar .download").click(function(){$(this).tbattr({data_name:(new Date).getTime(),data_url:t.favConfig.imgUrl,data_size:1024,data_icon:t.favConfig.imgUrl});var e=[];$(".mobile_res").each(function(t,a){var i=bdRes2Exe.getPackageByDom(a);i&&e.push(i)}),bd_app_dl(e),$.stats.sendRequest("fr=tb0_forum&st_mod=picMobile&st_type=imgLikeAction")})},createLikeButton:function(){var t=this,e=['<div class="fav-wrapper" style="">','<div class="fav-toolbar" style="display:none">','<a href="#" class="share j_shareImg" onclick="return false"></a>','<a class="download mobile_res"  title="\u4E0B\u8F7D\u56FE\u7247\u5230\u624B\u673A"  href="javascript:;" hidefocus="true" data_type="picture" data_url="" data_name="" data_icon="" data_size="1048576" data_from="1001714x" ></a>','<a class="mobile_res" data_type="apk" data_url="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/client/operate/android/tieba_pc_picdownload.apk" data_name="\u767E\u5EA6\u8D34\u5427" data_icon="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/static-album/img/tieba_client.png" data_size="12488145"  data_from="1001714x"  data_versionname="4.4.1"  data_versioncode="4" data_package="com.baidu.tieba" data_detail_type="soft" style="display:none" ></a>','<a href="javascript:void(0)" style="display: none;" class="emotion" title="\u6DFB\u52A0\u5230\u81EA\u5B9A\u4E49\u8868\u60C5"></a>',"</div>",'<div class="fav-success" style="display:none;">','<span class="ico"></span>','<span class="text">\u4F7F\u7528\u4E91\u76F8\u518C\u6536\u85CF\u5DE5\u5177\uFF0C\u6279\u91CF\u6536\u85CF\u7CBE\u7F8E\u56FE\u7247\uFF01<a target="_blank" href="http://xiangce.baidu.com/tool/shoucang/">\u7ACB\u5373\u5B89\u88C5</a></span>',"</div>",'<div class="fav-fail" style="display:none;">','<span class="ico"></span>','<span class="text ndefault">\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01</span>','<span class="text n20028">\u62B1\u6B49\uFF0C\u60A8\u6CA1\u6709\u6743\u9650\u8FDB\u884C\u8BE5\u9879\u64CD\u4F5C</span>',"</div>",'<div id="album_hl_container" style="display:none;"></div>',"</div>"].join("");t.favConfig.likeButton=$(e).appendTo(document.body).find(".fav-toolbar")},getMouseHoverDirection:function(t){var e=t.target,a=e.offsetWidth,i=e.offsetHeight,n=$(e).offset(),o=(t.pageX-n.left-a/2)*(a>i?i/a:1),s=(t.pageY-n.top-i/2)*(i>a?a/i:1),r=Math.round((Math.atan2(s,o)*(180/Math.PI)+180)/90+3)%4,c=new Array("up","right","bottom","left");return c[r]||"bottom"},enableSelf:function(t){var e=this;e.isEnabled=t,t||e.favConfig.hideLikeButton()}}});_.Module.define({path:"ppb/widget/pic_act_vote",requires:["pcommon/component/force_login"],sub:{initial:function(t){this.option=t,this.voteData={tbs:PageData.tbs,word:PageData.forum.forum_name,forum_id:PageData.forum.forum_id},this.bindEvent()},bindEvent:function(){var t=this;$("body").delegate(".j_pic_act_vote_btn","click",function(a){var e=$(this),o=e.closest(".j_pic_act_vote_area"),n=o.find(".j_pic_act_vote_num"),i=Number(n.text());if(a.preventDefault(),t.repostData=o.getData(),!PageData.user.is_login){var c=$.tb.unescapeHTML($.tb.location.getHref());return _.Module.use("pcommon/component/force_login",[c,"userbar","dialog","pic_act_vote"]),!1}if(PageData.user.is_like)t._postVoteData().done(function(a){"0"==a.no?(e.text("\u5DF2\u6295\u7968"),e.addClass("act_voted_btn"),n.animate({"margin-top":"-10px"},300).animate({"margin-top":"0"},300).text(i+1)):"40"==a.no?t._showCaptchaDialog(a,e,n,i):"2130008"==a.no?t._showCanvaDialog():t._showErrorTip(a.no)});else{var s=new $.dialog({html:'<p>\u53C2\u4E0E\u6295\u7968\u9700\u8981\u5148\u5173\u6CE8\u672C\u5427\u54E6~</p><br><a href="#" class="ui_btn ui_btn_m j_like"><span><em>\u5173\u6CE8\u672C\u5427</em></span></a>',width:420,holderClassName:"dialog_tip_holder"});s.element.on("click",".j_like",function(a){a.preventDefault(),_.Module.use("puser/widget/myTieba",[{}],function(t){t.dolike()}),$.stats.track("vote","plat_like","pb","click",{obj_id:t.repostData.activity_id}),s.close()})}})},_postVoteData:function(){var t=this;t.voteData.activity_id=t.repostData.activity_id,t.voteData.post_id=t.repostData.post_id,t.voteData.user_id_ed=t.repostData.user_id,t.voteData.user_name_ed=t.repostData.user_name,t.voteData.thread_id=t.repostData.thread_id,t.voteData.component_input={},t.voteData.component_input[t.repostData.component_id]={component_id:t.repostData.component_id,component_type:t.repostData.component_type},t.voteData.ie="utf-8";var a=$.post("/genesis/submit/commit?",t.voteData,function(){},"json");return a},_showCaptchaDialog:function(t,a,e,o){var n=this;_.Module.use("pcommon/component/CaptchaDialog",{title:"\u6295\u7968",message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\u5B8C\u6210\u6295\u7968~\u652F\u6301\u4F60\u559C\u6B22\u7684\u7F8E\u56FE\uFF01",vCode:t.data.vcode.captcha_vcode_str,vCodeType:t.data.vcode.captcha_code_type,paramsCallback:function(){return n.voteData}},function(t){t.bind("onclose",function(){return t.hide(),!1}),t.bind("onaccept",function(){n.voteData.vcode=t.getInputValue(),n.voteData.vcode_md5=t.getVCode(),n._postVoteData().done(function(t){"0"==t.no?(a.text("\u5DF2\u6295\u7968"),a.addClass("act_voted_btn"),e.animate({"margin-top":"-10px"},300).animate({"margin-top":"0"},300).text(o+1)):"40"==t.no?n._showCaptchaDialog(t):"2130008"==t.no?n._showCanvaDialog():n._showErrorTip(t.no)})}),t.show()})},_showCanvaDialog:function(){var t=this,a=['<div id="poster_canva_dialog" class="canva_dlg_wrap">','<h3 class="canva_msg_title">\u4F60\u4ECA\u5929\u5DF2\u7ECF\u6295\u8FC7\u7968\u4E86</h3>','<p class="canva_msg_cnt">\u5982\u679C\u60F3\u652F\u6301TA\uFF0C\u53EF\u4EE5\u8F6C\u8D34\u5230\u5176\u4ED6\u5427\u5E2E\u5FD9\u62C9\u7968\u54E6\uFF01</p>','<div class="canva_btn_group">','<a href="#" id="canva_repost_btn" '+$.tb.dataField(t.repostData)+' class="ui_btn ui_btn_m j_pic_act_repost"><span><em>\u8F6C\u53D1\u62C9\u7968</em></span></a>','<a href="#" id="canva_cancel_btn" class="ui_btn ui_btn_sub_m"><span><em>\u4E0B\u6B21\u518D\u8BF4</em></span></a>',"</div>","</div>"].join(""),e=new $.dialog({html:a,width:380,draggable:!0,closeable:!0,noTitle:!0});e.element.on("click","#canva_repost_btn",function(t){t.preventDefault(),e.hide()}).on("click","#canva_cancel_btn",function(t){t.preventDefault(),e.close()})},_showErrorTip:function(t){var a="";switch(Number(t)){case 8:case 9:case 220012:a="\u4F60\u5728\u672C\u5427\u88AB\u5C01\u7981\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C";break;case 220:a="\u4F60\u88AB\u5427\u4E3B\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C";break;case 2344:case 3110003:a="\u540C\u65F6\u6709\u592A\u591A\u4EBA\u5728\u6295\u7968\uFF0C\u8BF7\u7A0D\u540E\u518D\u6765~";break;default:a="\u670D\u52A1\u5668\u51FA\u9519\u5566~\u8BF7\u518D\u8BD5\u4E00\u6B21\u5427"}var e=new Array;e.push('<div style="text-align:center;color:#333333;font-size:14px;padding:10px 10px 0;">'+a+"</div>");new $.dialog({html:e.join(""),showTitle:!0,draggable:!1,width:300,height:40})}}});_.Module.define({path:"ppb/widget/pic_act_repost",requires:["pcommon/component/force_login","pcommon/widget/PostService"],sub:{ORIGINAL_PIC_URL_PREFIX:"http://imgsrc.baidu.com/forum/pic/item/",THUMBNAIL_PIC_URL_PREFIX:"http://imgsrc.baidu.com/forum/abpic/item/",MAX_REPOST_SHOW_FORUMS:20,initial:function(){this.postService=this.use("pcommon/widget/PostService"),this.bindEvent()},bindEvent:function(){var e=this;$("body").delegate(".j_pic_act_repost","click",function(t){var i=$(this);return e.repostData=i.getData(),t.preventDefault(),e.repostCheck(),!1})},repostCheck:function(){var e=this;if(!PageData.user.is_login){var t=$.tb.unescapeHTML($.tb.location.getHref());return e.use("pcommon/component/force_login",t,"userbar","dialog","pic_act_repost"),!1}var i;PageData.user_forumlist&&PageData.user_forumlist.info&&(e.userFormList=PageData.user_forumlist.info),PageData.user.user_forum_list&&PageData.user.user_forum_list.info&&(e.userFormList=PageData.user.user_forum_list.info),void 0!==e.userFormList?(e.MAX_REPOST_SHOW_FORUMS=e.userFormList.length>20?20:e.userFormList.length,0===e.userFormList.length?(i="\u4EB2\uFF0C\u76EE\u524D\u53EA\u80FD\u8F6C\u53D1\u5230\u4F60\u5173\u6CE8\u7684\u5427\u54E6\uFF0C\u8BF7\u5148\u53BB\u201C\u5173\u6CE8\u201D\u4F60\u8981\u8F6C\u53D1\u5230\u7684\u5427\u3002",e.showWarningTip(i)):1==e.userFormList.length&&e.userFormList[0].forum_name==PageData.forum.forum_name?(i="\u4EB2\uFF0C\u53EA\u80FD\u8F6C\u53D1\u5230\u672C\u5427\u4E4B\u5916\u4F60\u5173\u6CE8\u8FC7\u7684\u5427\u54E6\uFF0C\u8BF7\u5148\u53BB\u201C\u5173\u6CE8\u201D\u4F60\u8981\u8F6C\u53D1\u5230\u7684\u5427\u3002",e.showWarningTip(i)):e.showRepostDialog()):(i="\u4EB2\uFF0C\u76EE\u524D\u53EA\u80FD\u8F6C\u53D1\u5230\u4F60\u5173\u6CE8\u7684\u5427\u54E6\uFF0C\u8BF7\u5148\u53BB\u201C\u5173\u6CE8\u201D\u4F60\u8981\u8F6C\u53D1\u5230\u7684\u5427\u3002",e.showWarningTip(i))},showRepostDialog:function(){var e=this;e.dialog?(e.dialog.show(),e.dialog.setContent(e.renderDialogHTML())):e.dialog=new $.dialog({html:e.renderDialogHTML(),title:"\u8F6C\u53D1",width:460,draggable:!0,closeable:!0,hideOnclose:!0}),e.getElement(),$.browser.msie&&_.Module.use("pcommon/component/Placeholder",[e.$pic_repost_desc,"\u5C0F\u4F19\u4F34\u4EEC\u5FEB\u70B9\u513F\u6765\u7ED9"+e.curRole+"\u6295\u7968\u5427"]),e.bindDialogEvent()},renderDialogHTML:function(){var e=this,t=[],i={},a={},o=PageData.forum.forum_name,r=PageData.user.user_name==e.repostData.user_name?"\u6211":"TA",s=r+"\u6B63\u5728"+o+"\u5427\u53C2\u52A0\u3010"+e.repostData.thread_title+"\u3011\u6D3B\u52A8\u54E6\uFF0C\u6765\u5E2E"+r+"\u6295\u7968\u5427~",p="\u5C0F\u4F19\u4F34\u4EEC\u5FEB\u70B9\u513F\u6765\u7ED9"+r+"\u6295\u7968\u5427",_="",n="";e.curRole=r;for(var c=0;c<e.MAX_REPOST_SHOW_FORUMS;c++)i=e.userFormList[c],a={forum_id:i.id,forum_name:i.forum_name},i.forum_name!=o&&t.push('<a href="#" title="'+i.forum_name+'" '+$.tb.dataField(a)+' class="pic_like_forums_link j_pic_like_forum_link" ><span>'+i.forum_name+"\u5427</span></a>");return _=t.join(""),n=['<div class="pic_repost_dialog" id="pic_repost_dialog">','<div class="pic_repost_item clearfix">','<label for="pic_repost_title" class="pic_repost_label">\u8F6C\u8D34\uFF1A</label>','<input type="text" id="pic_repost_title" class="ui_textfield pic_repost_title_ipt" placeholder="'+s+'" value="'+s+'" />',"</div>",'<div class="pic_repost_item pic_fname_wrap j_pic_fname_wrap ui-front clearfix">','<label for="pic_repost_fname" class="pic_repost_label">\u8F6C\u53D1\u5230\uFF1A</label>','<input type="text" class="ui_textfield pic_repost_fname_ipt" id="pic_repost_fname" />',"</div>",'<div class="pic_like_forums j_pic_like_forums clearfix">'+_+"</div>",'<div class="pic_repost_item">','<label for="pic_repost_desc" class="pic_repost_label">\u7406\u7531\uFF1A</label>','<div class="pic_repost_img_wraper"></div>','<textarea cols="30" rows="10" id="pic_repost_desc" class="ui_textfield pic_repost_desc" maxlength="99" placeholder="'+p+'"></textarea>',"</div>",'<div class="post_btn_group">','<a href="#" id="pic_act_repost_btn" class="ui_btn ui_btn_m"><span><em>\u786E\u8BA4</em></span></a>','<a href="#" id="pic_act_recancel_btn" class="ui_btn ui_btn_sub_m"><span><em>\u53D6\u6D88</em></span></a>',"</div>",'<p class="pic_repost_tip_wrap"><span id="pic_repost_tip" class="pic_repost_tip ele_hidden">\u8F6C\u53D1\u6210\u529F\uFF01</span></p>',"</div>"].join("")},getElement:function(){var e=this,t=e.$dlgRoot=$("#pic_repost_dialog");e.$pic_repost_title=t.find("#pic_repost_title"),e.$pic_repost_fname=t.find("#pic_repost_fname"),e.$pic_repost_desc=t.find("#pic_repost_desc"),e.$j_pic_fname_wrap=t.find(".j_pic_fname_wrap"),e.$j_pic_like_forums=t.find(".j_pic_like_forums"),e.$pic_act_repost_btn=t.find("#pic_act_repost_btn"),e.$pic_act_recancel_btn=t.find("#pic_act_recancel_btn"),e.$pic_repost_tip=t.find("#pic_repost_tip")},bindDialogEvent:function(){var e=this,t={},i=e.THUMBNAIL_PIC_URL_PREFIX+e.repostData.pic_encode+".jpg";e.dialog.element.find(".pic_repost_img_wraper").css({"background-image":"url("+i+")"}),$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-pcommon/js/jquery-ui-autocomplete.min.js",function(){e.$pic_repost_fname.autocomplete({source:e.getLikedForumName(),minLength:0}),e.$pic_repost_fname.bind("click",function(){$(this).autocomplete("search","")})}),e.$pic_act_repost_btn.bind("click",function(t){$(this);return t.preventDefault(),""==e.$pic_repost_title.val()?(e.showErrorTip("\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A"),!1):""==e.$pic_repost_fname.val()?(e.showErrorTip("\u8BF7\u9009\u62E9\u8981\u8F6C\u53D1\u7684\u5427"),!1):$.browser.msie&&e.$pic_repost_desc.val().length>99?(e.showErrorTip("\u8F6C\u8D34\u7406\u7531\u6700\u591A\u53EA\u80FD\u8F93\u516599\u4E2A\u6C49\u5B57\u54E6~"),!1):void e.sendRepost()}),e.$pic_act_recancel_btn.bind("click",function(t){t.preventDefault(),"pb"==PageData.product&&"poster"==e.repostData.canva_from?setTimeout(function(){var t=$.tb.location.getHash(),i=$.tb.location.getPathname();i=="/p/"+e.repostData.thread_id?"#pic_sort_new"!=t?($.tb.location.setHref("/p/"+e.repostData.thread_id+"#pic_sort_new"),$.tb.location.reload()):$.tb.location.reload():$.tb.location.setHref("/p/"+e.repostData.thread_id+"#pic_sort_new"),e.dialog.hide()},1e3):e.dialog.hide()}),e.$j_pic_like_forums.delegate(".j_pic_like_forum_link","click",function(i){var a=$(this);return i.preventDefault(),t=a.getData(),e.$pic_repost_fname.val(t.forum_name.replace(/\s/g," ")).trigger("change"),e.$j_pic_fname_wrap.find("a").remove(),e.$j_pic_fname_wrap.append(a.clone()),e.$pic_repost_fname.css("color","#fff").tbprop("readonly","readonly").autocomplete({disabled:!0}),a.siblings().removeClass("seleted_forum_link"),a.addClass("seleted_forum_link"),!1}),e.$j_pic_fname_wrap.delegate(".j_pic_like_forum_link","click",function(t){var i=$(this),a=$.tb.unescapeHTML(i.tbattr("title"));return t.preventDefault(),e.$pic_repost_fname.val("").trigger("change"),e.$j_pic_like_forums.find('a[title="'+a+'"]').removeClass("seleted_forum_link"),e.$pic_repost_fname.css("color","#000").tbprop("readonly",!1).autocomplete({disabled:!1}),i.remove(),!1})},sendRepost:function(){var e=this,t=e.$pic_repost_fname.val(),i=PosterContext.getContext(),a=""==e.$pic_repost_desc.val()?e.$pic_repost_desc.tbattr("placeholder"):e.$pic_repost_desc.val(),o={65535:"\u4F60\u4ECA\u5929\u7684\u8F6C\u8D34\u5DF2\u8FBE\u4E0A\u9650",65534:"\u8FD9\u4E2A\u5427\u4F60\u5DF2\u7ECF\u8F6C\u8FC7\u5566",65533:"\u4ECA\u5929\u8F6C\u8D34\u7684\u4EBA\u592A\u591A\u4E86\uFF0C\u660E\u5929\u518D\u6765\u5427",65532:"\u540C\u65F6\u8F6C\u8D34\u7684\u4EBA\u592A\u591A\u4E86\uFF0C\u8BF7\u7A0D\u7B49\u4E00\u4F1A\u513F\u54C8",3011:"\u53EA\u80FD\u8F6C\u5230\u4F60\u5173\u6CE8\u8FC7\u7684\u5427",308:"\u7528\u6237\u6743\u9650\u4E0D\u8DB3",2523011:"\u53EA\u80FD\u8F6C\u5230\u4F60\u5173\u6CE8\u8FC7\u7684\u5427"};for(var r in o)!function(t){e.postService.resultHandlerManager.registerHandler(t,function(){e.showErrorTip(o[t])})}(r);e.postService.success(function(t,i){e.$pic_repost_tip.text("\u8F6C\u53D1\u6210\u529F\uFF01").removeClass("ele_hidden"),e.$pic_repost_tip.prepend('<img src="/tb/static-ppb/img/success.gif" alt="ok"/>'),e.$pic_repost_tip.append('<a href="/p/'+i.new_thread_id+'" target="_blank">\u67E5\u770B\u8F6C\u8D34</a>'),"pb"==PageData.product&&void 0!==e.repostData.canva_from&&"poster"==e.repostData.canva_from?setTimeout(function(){var t=$.tb.location.getHash();"#pic_sort_new"!=t?$.tb.location.setHref("/p/"+e.repostData.thread_id+"#pic_sort_new"):$.tb.location.reload()},1e3):setTimeout(function(){$.tb.location.reload()},1e3)}),e.postService.post("repost",{ptid:e.repostData.thread_id,ftid:e.forumIdMap[t],title:e.$pic_repost_title.val(),content:e.repostData.pic_encode+"#"+a,ie:"utf-8",tbs:PageData.tbs,new_vcode:1,tag:11,ppid:e.repostData.post_id,activity_id:e.repostData.activity_id,act_type:"photo"},i)},getLikedForumName:function(){for(var e=this,t=e.userFormList.length,i=[],a={},o={},r="",s=0;t>s;s++)o=e.userFormList[s],r=$.tb.unescapeHTML(o.forum_name.replace(/\s/g," ")),o.forum_name!=PageData.forum.forum_name&&i.push(r),a[r]=o.id;return e.forumIdMap=a,i},showWarningTip:function(e){var t=new Array;t.push('<div style="text-align:center;color:#333333;font-size:14px;padding:11px">'+e+"</div>");new $.dialog({html:t.join(""),title:"\u6E29\u99A8\u63D0\u793A",showTitle:!0,draggable:!1,width:300,holderClassName:"pat-noTitle"})},showErrorTip:function(e){var t=this;t.$dlgRoot.addClass("msg_dialog_holder"),t.$pic_repost_tip.text(e).removeClass("ele_hidden"),setTimeout(function(){t.$pic_repost_tip.addClass("ele_hidden"),t.$dlgRoot.removeClass("msg_dialog_holder")},1500)}}});